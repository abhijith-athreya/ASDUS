var PRUM_EPISODES=PRUM_EPISODES||{};PRUM_EPISODES.q=PRUM_EPISODES.q||[];PRUM_EPISODES.version="0.2";PRUM_EPISODES.targetOrigin=document.location.protocol+"//"+document.location.hostname;PRUM_EPISODES.bPostMessage=false;PRUM_EPISODES.beaconUrl=PRUM_EPISODES.beaconUrl||"/images/beacon.gif";PRUM_EPISODES.autorun=false;PRUM_EPISODES.useCookie=false;PRUM_EPISODES.init=function(){PRUM_EPISODES.initStorage();PRUM_EPISODES.bDone=false;PRUM_EPISODES.bUnloaded=false;PRUM_EPISODES.marks={};PRUM_EPISODES.measures={};PRUM_EPISODES.starts={};PRUM_EPISODES.findStartTime();PRUM_EPISODES.addEventListener("beforeunload",PRUM_EPISODES.beforeUnload,false);PRUM_EPISODES.addEventListener("pagehide",PRUM_EPISODES.beforeUnload,false);PRUM_EPISODES.addEventListener("unload",PRUM_EPISODES.beforeUnload,false);PRUM_EPISODES.addOnLoadListener(PRUM_EPISODES.onload);PRUM_EPISODES.processQ()};PRUM_EPISODES.processQ=function(){var a=PRUM_EPISODES.q.length;for(var b=0;b<a;b++){var d=PRUM_EPISODES.q[b];var c=d[0];if("mark"===c){PRUM_EPISODES.mark(d[1],d[2])}else{if("measure"===c){PRUM_EPISODES.measure(d[1],d[2],d[3])}else{if("done"===c){PRUM_EPISODES.done(d[1])}}}}};PRUM_EPISODES.mark=function(a,b){PRUM_EPISODES.dprint("PRUM_EPISODES.mark: "+a+", "+b);if(!a){PRUM_EPISODES.dprint("Error: markName is undefined in PRUM_EPISODES.mark.");return}PRUM_EPISODES.marks[a]=parseInt(b||new Date().getTime());if(PRUM_EPISODES.bPostMessage){window.postMessage("PRUM_EPISODES:mark:"+a+":"+b,PRUM_EPISODES.targetOrigin)}if("firstbyte"===a){PRUM_EPISODES.measure("backend","starttime","firstbyte")}else{if("onload"===a){PRUM_EPISODES.measure("page load time","starttime","onload")}else{if("done"===a){PRUM_EPISODES.measure("total load time","starttime","done")}}}};PRUM_EPISODES.measure=function(c,b,e){PRUM_EPISODES.dprint("PRUM_EPISODES.measure: "+c+", "+b+", "+e);if(!c){PRUM_EPISODES.dprint("Error: episodeName is undefined in PRUM_EPISODES.measure.");return}var a;if("undefined"===typeof(b)){if("number"===typeof(PRUM_EPISODES.marks[c])){a=PRUM_EPISODES.marks[c]}else{a=new Date().getTime()}}else{if("number"===typeof(PRUM_EPISODES.marks[b])){a=PRUM_EPISODES.marks[b]}else{if("number"===typeof(b)){a=b}else{PRUM_EPISODES.dprint("Error: unexpected startNameOrTime in PRUM_EPISODES.measure: "+b);return}}}var d;if("undefined"===typeof(e)){d=new Date().getTime()}else{if("number"===typeof(PRUM_EPISODES.marks[e])){d=PRUM_EPISODES.marks[e]}else{if("number"===typeof(e)){d=e}else{PRUM_EPISODES.dprint("Error: unexpected endNameOrTime in PRUM_EPISODES.measure: "+e);return}}}PRUM_EPISODES.starts[c]=parseInt(a);PRUM_EPISODES.measures[c]=parseInt(d-a);if(PRUM_EPISODES.bPostMessage){window.postMessage("PRUM_EPISODES:measure:"+c+":"+a+":"+d,PRUM_EPISODES.targetOrigin)}};PRUM_EPISODES.done=function(a){PRUM_EPISODES.bDone=true;PRUM_EPISODES.mark("done");if(PRUM_EPISODES.autorun){PRUM_EPISODES.sendBeacon()}if(PRUM_EPISODES.bPostMessage){window.postMessage("PRUM_EPISODES:done",PRUM_EPISODES.targetOrigin)}if("function"===typeof(a)){a()}};PRUM_EPISODES.getMarks=function(){return PRUM_EPISODES.marks};PRUM_EPISODES.getMeasures=function(){return PRUM_EPISODES.measures};PRUM_EPISODES.getStarts=function(){return PRUM_EPISODES.starts};PRUM_EPISODES.findStartTime=function(){var a=PRUM_EPISODES.findStartWebTiming()||PRUM_EPISODES.findStartGToolbar()||PRUM_EPISODES.findStartValue();if(a){PRUM_EPISODES.mark("starttime",a)}};PRUM_EPISODES.findStartWebTiming=function(){var a=undefined;var b=window.performance||window.mozPerformance||window.msPerformance||window.webkitPerformance;if("undefined"!=typeof(b)&&"undefined"!=typeof(b.timing)&&"undefined"!=typeof(b.timing.navigationStart)){a=b.timing.navigationStart;PRUM_EPISODES.dprint("PRUM_EPISODES.findStartWebTiming: startTime = "+a)}return a};PRUM_EPISODES.findStartGToolbar=function(){var a=undefined;if(window.external&&window.external.pageT){a=(new Date().getTime())-window.external.pageT}else{if(window.gtbExternal&&window.gtbExternal.pageT){a=(new Date().getTime())-window.gtbExternal.pageT()}else{if(window.chrome&&window.chrome.csi){a=(new Date().getTime())-window.chrome.csi().pageT}}}if(a){PRUM_EPISODES.dprint("PRUM_EPISODES.findStartGToolbar: startTime = "+a)}return a};PRUM_EPISODES.findStartValue=function(){if(!PRUM_EPISODES.useCookie){return PRUM_EPISODES.findStartStorage()}return PRUM_EPISODES.findStartCookie()};PRUM_EPISODES.findStartCookie=function(){var g=document.cookie.split("; ");for(var d=0;d<g.length;d++){if(0===g[d].indexOf("PRUM_EPISODES=")){var a=g[d].substring("PRUM_EPISODES=".length).split("&");var e,f;for(var b=0;b<a.length;b++){if(0===a[b].indexOf("s=")){e=a[b].substring(2)}else{if(0===a[b].indexOf("r=")){var c=a[b].substring(2);f=(escape(document.referrer)==c)}}}if(f&&e){PRUM_EPISODES.dprint("PRUM_EPISODES.findStartCookie: startTime = "+e);return e}}}return undefined};PRUM_EPISODES.findStartStorage=function(){try{var a=JSON.parse(window.sessionStorage.getItem("prum"));if(escape(document.referrer)===a.location){return a.startTime}}catch(b){}return null};PRUM_EPISODES.initStorage=function(){if(window.sessionStorage&&!PRUM_EPISODES.useCookie){try{var b="prum_test_"+Date.now();window.sessionStorage.setItem(b,"123");if(window.sessionStorage.getItem(b)==="123"){window.sessionStorage.removeItem(b);PRUM_EPISODES.useCookie=false;return}}catch(a){}}PRUM_EPISODES.useCookie=true};PRUM_EPISODES.setStartValue=function(a){if(!PRUM_EPISODES.useCookie){return PRUM_EPISODES.setStartStorage(a)}return PRUM_EPISODES.setStartCookie(a)};PRUM_EPISODES.setStartStorage=function(a){try{window.sessionStorage.setItem("prum",JSON.stringify(a));return true}catch(b){}return false};PRUM_EPISODES.setStartCookie=function(a){document.cookie="PRUM_EPISODES=s="+a.startTime+"&r="+a.location+"; path=/";return true};PRUM_EPISODES.beforeUnload=function(a){if(PRUM_EPISODES.bUnloaded){return}var b={startTime:Number(new Date()),location:escape(document.location)};PRUM_EPISODES.bUnloaded=PRUM_EPISODES.setStartValue(b)};PRUM_EPISODES.onload=function(a){PRUM_EPISODES.mark("onload");PRUM_EPISODES.done()};PRUM_EPISODES.addEventListener=function(c,b,a){if("undefined"!=typeof(window.attachEvent)){return window.attachEvent("on"+c,b)}else{if(window.addEventListener){return window.addEventListener(c,b,a)}}};PRUM_EPISODES.addOnLoadListener=function(d){var a=document.readyState;if(a==="complete"){setTimeout(d,0)}else{if(typeof a==="undefined"){var c=function(){var e=document.getElementsByTagName("*");return e[e.length-1]};var b=c();setTimeout(function(){if(c()===b&&typeof document.readyState==="undefined"){d()}},500)}else{PRUM_EPISODES.addEventListener("load",d,false)}}};PRUM_EPISODES.dprint=function(a){};PRUM_EPISODES.init();_prum||(_prum=[]);(function(){var q="//rum-collector.pingdom.net/img/beacon.gif",h=null,j="",f=[];var i={navigationStart:"nS",unloadEventStart:"uES",unloadEventEnd:"uEE",redirectStart:"rS",redirectEnd:"rE",fetchStart:"fS",domainLookupStart:"dLS",domainLookupEnd:"dLE",connectStart:"cS",connectEnd:"cE",handshakeStart:"hS",requestStart:"reS",responseStart:"resS",responseEnd:"resE",domLoading:"dL",domInteractive:"dI",domContentLoadedEventStart:"dCLES",domContentLoadedEventEnd:"dCLEE",domComplete:"dC",loadEventStart:"lES",loadEventEnd:"lEE"};var n={id:function(s){j=s},tag:function(s){f.push(s)},tags:function(s){f=f.concat(s)},mark:function(s,t){if(t instanceof Date){t=t.getTime()}if(PRUM_EPISODES&&PRUM_EPISODES.mark){PRUM_EPISODES.mark(s,t)}}};function p(s){return Object.prototype.toString.call(s)==="[object Array]"}function b(v){if(typeof v==="string"){return v}var u="";for(var s in v){var t=p(v[s])?v[s].join(" "):v[s];u+=u.length?"&":"?";u+=encodeURIComponent(s);u+="=";u+=encodeURIComponent(t)}return u}function a(s,u){var t=new Image();if(f.length){u.tags=f}t.src=s+b(u)}function d(){var v=window.performance.timing;var w=window.performance.navigation;if(!(v&&w)){if(h){clearInterval(h);h=false}return false}if(v.loadEventEnd===0){return false}clearInterval(h);h=null;var s={path:window.location.protocol+"//"+window.location.host+window.location.pathname,title:document.title,id:j,s:"nt",rC:w.redirectCount,sid:k(),sis:e(),ref:document.referrer};for(var u in i){s[i[u]]=-1;if(!(u in v)){continue}if(v[u]<=0){continue}s[i[u]]=(v[u]-v.navigationStart)}a(q,s)}function g(s){var t=Math.random().toString(32).substr(2,s+2);while(t.length<s){t+=g(s-t.length)}return t.length===s?t:t.substr(0,s)}function c(s){try{if(window.sessionStorage){return window.sessionStorage.getItem("prum_"+s)}}catch(t){return""}return""}function o(s,t){try{if(window.sessionStorage){window.sessionStorage.setItem("prum_"+s,t)}}catch(u){}}function k(){var s=c("sid");if(s){return s}s=g(8);o("sid",s);return s}function e(){var s=c("step");if(typeof s==="string"&&s.length){return parseInt(s,10)}}function r(){var s=e();if(isFinite(s)){var t=window.performance;if(t&&t.navigation&&t.navigation.type===1){return}s+=1}else{s=1}o("step",s)}function l(){if(!PRUM_EPISODES||!PRUM_EPISODES.bDone){return false}clearInterval(h);h=false;var u=PRUM_EPISODES.getMeasures();if(u!=null&&u.backend!=null&&u.frontend!=null&&u["page load time"]!=null&&u["total load time"]!=null){var s=u.backend;var v=u.backend+u.frontend;var t={path:window.location.href,id:j,s:"ep",uES:-1,uEE:-1,rS:-1,rE:-1,rC:0,fS:0,dLS:0,dLE:0,cS:0,cE:0,hS:0,reS:0,resS:s,resE:s,dL:s,dI:s,dCLES:s,dCLEE:v,dC:v,lES:u["page load time"],lEE:u["total load time"],sid:k(),sis:e(),ref:document.referrer};a(q,t)}}function m(){if(!p(_prum)){var s=[["id",_prum.id]];if(_prum.tags){s.push(["tags",_prum.tags])}_prum=s}_prum.push=function(t){var u=t.shift();if(n[u]){n[u].apply(this,t)}};while(_prum.length){_prum.push(_prum.shift())}}r();if(window.performance!=null&&window.performance.timing!=null&&window.performance.navigation!=null){h=setInterval(d,100)}else{h=setInterval(l,100)}m()})();