define(["jquery","underscore","backbone","pubsub","managers/trafficcop","libs/css-transition-lib/css-transition-lib","easing","transformSupport"],function(i,t,s,e,n,o){"use strict";var a=s.View.extend({useCSSTransitions:!!i.support.css.transition,transitionCssName:i.support.css.transition&&i.support.css.transition.cssName,isSafari6:navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/6"),isApple:navigator.userAgent.indexOf("iPhone")>-1||navigator.userAgent.indexOf("iPad")>-1,pubSub:null,options:{animations:{fadeIn:{duration:200,easing:"easeInQuad"},fadeOut:{duration:200,easing:"easeOutSine"},useCSSTransitions:!0}},initialize:function(t){this.options=i.extend(!0,{},a.prototype.options,t),this.useCSSTransitions=this.options.animations.useCSSTransitions&&this.useCSSTransitions,this.seenModules={},this.subviews=this.subviews||{},this.clear$$(),this.pubSub&&e.attach(this.pubSub,this)},$$:function(i){var t=this.cachedSelectors[i];return t||(t=this.$(i),this.cachedSelectors[i]=t),t},clear$$:function(i){i?delete this.cachedSelectors[i]:this.cachedSelectors={}},setElement:function(){this.clear$$(),s.View.prototype.setElement.apply(this,arguments)},destroy:function(i,t){this.destroyed=!0,this.destroyModules(i,t),this.clear$$(),this.pubSub&&e.unattach(this.pubSub,this),i&&this.$el.remove()},destroyModules:function(i,t){this._callCollection(this.subviews,"destroy",[i,t]),this.undelegateEvents(),this.subviews={}},triggerEvent:function(i,t){t=Array.prototype.slice.call(arguments,1),this._callCollection(this.subviews,i,t)},_callCollection:function(s,e,n){t.each(s,function(s){try{i.isArray(s)?t.each(s,function(t){i.isFunction(t[e])&&t[e].apply(t,n)}):s&&i.isFunction(s[e])&&s[e].apply(s,n)}catch(o){console.error("subview threw exception on destruction: ",o.stack||o.stacktrace||o.message)}})},registerAnimation:function(i,t,s,e,o){return n.addAnimation(i,t,s,e,o)},animate:function(s,e,a,r,u,c){return s&&0!==s.length?(this.isSafari6&&"opacity"===e&&(r=0),i.when.apply(i,t.map(s,t.bind(function(t){var s;return s=this.useCSSTransitions?o.cssTransition(i(t),e,a,r,u,c):o.jQuery(i(t),e,a,r,u,c),n.addAnimation(s,t,a,r),s},this)))):(console.error("tried animating null or empty jquery object"),i.Deferred().reject())},stopAnimate:function(s,e){t.each(s,function(t){o.stop(i(t),e)})},show:function(s,e){var n,o=this.options.animations.fadeIn;return s&&!this.isSafari6?(n=this.$el.fadeTo(o.duration,1,o.easing).promise(),this.registerAnimation(n,this.$el,"opacity",1)):(n=i.Deferred(),t.defer(function(){n.resolve()}),this.$el.css({display:"block",opacity:1})),n.done(function(){e&&e()}),n},hide:function(s,e){var n,o=this.options.animations.fadeOut;return s&&!this.isSafari6?(n=this.$el.fadeTo(o.duration,0,o.easing).promise(),n.done(t.bind(function(){this.$el.css({display:"none"})},this)),this.registerAnimation(n,this.$el,"opacity",0,o.duration)):(n=i.Deferred().resolve(),this.$el.css({display:"none",opacity:0})),n.done(function(){e&&e()}),n},setupSub:function(i,t,s,e){e=e||{};var n=this.subviews[i];n||(this.subviews[i]=n=[]),this.$(t).each(function(i,t){e.el=t,n.push(new s(e))})}});return a});
//# sourceMappingURL=base-view.js.map