define(["jquery","underscore","directAdPosition","utils","managers/cachemanager","admanager","adLogger"],function(e,t,r,i,n,s,o){"use strict";var a=r.extend({initialize:function(t){t=e.extend({slotType:"out",rateMeterId:null},t),r.prototype.initialize.call(this,t)},getDefaultThreshold:function(e){var t=e||this.options.meterThreshold||this.options.adPlacement,r=t.indexOf("/");-1!==r&&(t=t.substring(0,r));var n=i.getNested(window.site_vars,"ADS","THRESHOLDS",t.toUpperCase());return n||o.logError("Could not find default threshold for metered ad: "+t),n},tickMeter:function(e,t){var r=!1,i=this.getCurrentMeter(t);return i.length?(i[0]=Math.max(0,i[0]-1),i[0]<1&&(r=!0,e||(i[0]=i[1])),n.setValue(this.getRateMeterId(t),i),r):r},resetMeter:function(e){var t=this.getCurrentMeter(e);t[0]=t[1],n.setValue(this.getRateMeterId(e),t)},getRateMeterId:function(e){return"dfpc_"+(e||this.options.rateMeterId)},getCurrentMeterCount:function(e){return this.getCurrentMeter(e)[0]||0},getCurrentMeter:function(e){var t=this.getRateMeterId(e),r=this.getDefaultThreshold(e);return r?n.getValue(t,r):[]},shouldShowAd:function(){var e=this.tickMeter();return this.prefetchAd(),e&&!this.isAdReady()&&(o.logDebug("ad skipped due to no ad being delivered in time, refreshing slot"),this.refreshPosition(),e=!1),o.logDebug("shouldShowAd: "+e,this),e}});return a});
//# sourceMappingURL=metered-ad-position.js.map