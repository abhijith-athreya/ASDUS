//tealium universal tag - utag.171 ut4.0.201803222011, Copyright 2018 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'link':1};u.initialized=false;u.map={"video_player_name":"video_info.playerName","video_id":"video_info.id","video_content_length":"video_info.length","video_stream_type":"video_info.streamType","video_ad_pod":"ad_break_info.position","video_ad_id":"ad_info.id","video_ad_duration":"ad_info.length","video_ad_slot":"ad_info.position","video_ad_type":"ad_info.adType","video_ad_title":"ad_info.name","video_content_title":"chapter_info.name,video_info.name","video_chapter_duration":"chapter_info.length","video_chapter":"chapter_info.position","video_chapter_start_time":"chapter_info.startTime","video_bitrate":"qos.bitrate","video_startup_time":"qos.startupTime","video_analytics_clip_title":"video_meta.clipTitle","video_analytics_series_name":"video_meta.seriesName","video_analytics_lf_vs_sf":"video_meta.longForm","video_isFullEpisode":"video_meta.isFullEpisode","video_fastfollow_vs_archive":"video_meta.fastFollowVsArchive","video_season":"video_meta.season","video_series_type":"video_meta.seriesType","video_episode":"video_meta.episodeNumber","video_analytics_days_since_premiere":"video_meta.daysSincePremiere","video_advertiser":"ad_meta.advertiserName","video_title":"video_info.name","video_series_name":"video_info.program","video_originalAirDate":"video_meta.originalAirDate","video_originalAirDateNielsen":"video_meta.originalAirDateNielsen","tve_provider_name":"video_meta.tveProviderName","tve_auth_status":"video_meta.isTveAuthenticated","video_PPLID":"video_meta.videoPPLID","meta.aetn:isBehindWall":"video_meta.isBehindWall","video_cdn":"video_meta.videoCDN","video_supplier_name":"video_meta.supplierName","video_playlist_name":"video_meta.playlistName","video_pub_date":"video_meta.videoPubDate","sf_friendly_publish_date":"video_meta.sf_pub_date"};u.extend=[function(a,b){try{if(1){try{b['video_analytics_clip_title']=b['brand_prefix']+":"+toAnalyticsCase(b['video_series_name'])+":"+toAnalyticsCase(b['video_content_title'])}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(b['video_isAd'].toString().toLowerCase()=='true'.toLowerCase()){b['video_ad_title']=b['video_title']}}catch(e){utag.DB(e)}},function(a,b){try{if(b['video_isAd']=='true'){b['video_ad_type']=b['video_ad_type']}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{b['video_analytics_series_name']=b['brand_prefix']+":"+toAnalyticsCase(b['video_series_name'])}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(typeof b['video_content_length']!='undefined'){try{b['video_content_length']=Math.round(b['video_content_length']/1000)}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(typeof b['video_ad_duration']!='undefined'){try{b['video_ad_duration']=Math.round(b['video_ad_duration']/1000)}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(typeof b['video_chapter_duration']!='undefined'){try{b['video_chapter_duration']=Math.round(b['video_chapter_duration']/1000)}catch(e){}}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){d=b['video_isLongform'];if(typeof d=='undefined')return;c=[{'true':'Longform'},{'false':'Shortform'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['video_analytics_lf_vs_sf']=c[e][f];m=true};};if(m)break};if(!m)b['video_analytics_lf_vs_sf']='Shortform';},function(a,b,c,d,e,f,g){d=b['video_isLongform'];if(typeof d=='undefined')return;c=[{'true':'y'},{'false':'n'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['video_isFullEpisode']=c[e][f];m=true};};if(m)break};if(!m)b['video_isFullEpisode']='n';},function(a,b){try{if((b['video_isLongform'].toString().toLowerCase()=='true'.toLowerCase()&&typeof b['video_originalAirDate']!='undefined')){try{b['video_analytics_days_since_premiere']=Math.floor(((new Date).getTime()-b['video_originalAirDate'])/1000/60/60/24)}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(b['video_isLongform'].toString().toLowerCase()!='true'.toLowerCase()){b['video_analytics_days_since_premiere']='Shortform';b['video_fastfollow_vs_archive']='Shortform'}}catch(e){utag.DB(e)}},function(a,b){try{if(parseFloat(b['video_analytics_days_since_premiere'])<=parseFloat(364)){b['video_fastfollow_vs_archive']='FastFollow'}}catch(e){utag.DB(e)}},function(a,b){try{if(parseFloat(b['video_analytics_days_since_premiere'])>=parseFloat(365)){b['video_fastfollow_vs_archive']='Archive'}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(!(u.ev[a]||u.ev.all!==undefined)){return;}
if(b['event_type']!=='video'){return;}
if(typeof window.aetn_avppd==='undefined'){return;}
var c,d,e,f,i;u.data={};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){if(typeof utag_err!='undefined'){utag_err.push({e:'extension error:'+e,s:utag.cfg.path+'utag.'+id+'.js',l:c,t:'ex'})}}};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
window.aetn_avppd.set('video_info','playerName',u.data['video_info.playerName']);window.aetn_avppd.set('video_info','id',u.data['video_info.id']);window.aetn_avppd.set('video_info','name',u.data['video_info.name']);window.aetn_avppd.set('video_info','length',u.data['video_info.length']);window.aetn_avppd.set('video_info','playhead',u.data['video_info.playhead']);window.aetn_avppd.set('video_info','streamType',u.data['video_info.streamType']);window.aetn_avppd.set('ad_break_info','playerName',u.data['video_info.playerName']);window.aetn_avppd.set('ad_break_info','position',u.data['ad_break_info.position']);window.aetn_avppd.set('ad_info','id',u.data['ad_info.id']);window.aetn_avppd.set('ad_info','length',u.data['ad_info.length']);window.aetn_avppd.set('ad_info','position',u.data['ad_info.position']);window.aetn_avppd.set('ad_info','name',u.data['ad_info.name']);window.aetn_avppd.set('chapter_info','name',u.data['chapter_info.name']);window.aetn_avppd.set('chapter_info','length',u.data['chapter_info.length']);window.aetn_avppd.set('chapter_info','position',u.data['chapter_info.position']);window.aetn_avppd.set('chapter_info','startTime',u.data['chapter_info.startTime']);window.aetn_avppd.set('qos','bitrate',u.data['qos.bitrate']);window.aetn_avppd.set('qos','startupTime',u.data['qos.startupTime']);if(window.aetn_avppd.npd){window.aetn_avppd.npd.set('video_info','assetid',u.data['video_info.id']);window.aetn_avppd.npd.set('video_info','program',u.data['video_info.program']);window.aetn_avppd.npd.set('video_info','title',u.data['video_info.name']);window.aetn_avppd.npd.set('video_info','length',u.data['video_info.length']);window.aetn_avppd.npd.set('video_info','isfullepisode',u.data['video_meta.isFullEpisode']);window.aetn_avppd.npd.set('video_info','airdate',u.data['video_meta.originalAirDateNielsen']);window.aetn_avppd.npd.set('video_info','videocdn',u.data['video_meta.videoCDN']);window.aetn_avppd.npd.set('ad_info','type',u.data['ad_info.adType']);window.aetn_avppd.npd.set('ad_info','assetid',u.data['ad_info.id']);window.aetn_avppd.npd.set('ad_info','length',u.data['ad_info.length']);window.aetn_avppd.npd.set('ad_info','name',u.data['ad_info.assetName']);}
var keys=Object.keys(u.data);var key='';var video_meta={};var chapter_meta={};var ad_meta={};for(var i=0;i<keys.length;i++){key=keys[i];if(key.search('video_meta.')!=-1){video_meta[key.replace('video_meta.','')]=u.data[key];}
if(key.search('chapter_meta.')!=-1){chapter_meta[key.replace('chapter_meta.','')]=u.data[key];}
if(key.search('ad_meta.')!=-1){ad_meta[key.replace('ad_meta.','')]=u.data[key];}}
console.log('aetn.adobe.tealium.template :',video_meta,chapter_meta,ad_meta);switch(b['event_name']){case'video_load':window.aetn_avppd.trackVideoLoad(video_meta);break;case'video_complete':window.aetn_avppd.trackComplete();break;case'video_play':window.aetn_avppd.trackPlay();break;case'video_pause':window.aetn_avppd.trackPause();break;case'video_seek':window.aetn_avppd.trackSeek();break;case'video_bitrate_change':window.aetn_avppd.trackBitrateChange();break;case'video_media_error':window.aetn_avppd.trackVideoPlayerError();break;case'video_player_error':window.aetn_avppd.trackApplicationError();break;case'video_chapter_start':window.aetn_avppd.trackChapterStart(chapter_meta);break;case'video_chapter_complete':window.aetn_avppd.trackChapterComplete();break;case'video_ad_start':window.aetn_avppd.trackAdStart(ad_meta);break;case'video_ad_complete':window.aetn_avppd.trackAdComplete();break;default:break;}
};utag.o[loader].loader.LOAD(id);})("171","aenetworks.history");}catch(error){utag.DB(error);}
