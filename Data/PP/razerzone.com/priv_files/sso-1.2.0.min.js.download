var DOMAIN="https://oauth2.razerzone.com";var rz=rz||{_client_id:"",_client_key:"",_grant_type:"",_scope:"sso",_redirect_uri:document.location.href,init:function(params){if(undefined!=params.client_id)this._client_id=params.client_id;if(undefined!=params.client_key)this._client_key=params.client_key;if(undefined!=params.grant_type)this._grant_type=params.grant_type;if(undefined!=params.scope)this._scope=params.scope;if(undefined!=params.redirect_uri)this._redirect_uri=params.redirect_uri},set:function(key,value){switch(key){case"client_id":this._client_id=value;break;case"grant_type":this._grant_type=value;break;case"scope":this._scope=value;break;case"redirect_uri":this._redirect_uri=value;break}},_verifyService:function(){var pdata={client_id:this._client_id,client_key:this._client_key,scope:this._scope};$.ajax({type:"POST",url:DOMAIN+"/services/sso",crossDomain:true,xhrFields:{withCredentials:true},cache:false,dataType:"json",data:pdata}).done(function(data,textStatus,jqXHR){window.setInfo(data)}).fail(function(xhr,status,jqXhr){var error_response=rz._handleErrors(xhr,status,jqXhr,"_verifyService");window.setInfo(error_response)})},_getSessionService:function(){$.ajax({type:"GET",crossDomain:true,xhrFields:{withCredentials:true},url:DOMAIN+"/services/session",cache:false}).done(function(data,textStatus,jqXHR){window.cbSession(data)}).fail(function(xhr,status,jqXhr){var error_response=rz._handleErrors(xhr,status,jqXhr,"_getSessionService");window.cbSession(error_response)})},_putSessionService:function(){var pdata={client_id:this._client_id};$.ajax({type:"POST",xhrFields:{withCredentials:true},url:DOMAIN+"/services/session",crossDomain:true,xhrFields:{withCredentials:true},dataType:"json",cache:false,data:pdata}).done(function(data,textStatus,jqXHR){window.cbSession(data)}).fail(function(xhr,status,jqXhr){var error_response=rz._handleErrors(xhr,status,jqXhr,"_putSessionService");window.cbSession(error_response)})},_extractLinkInfoService:function(link_info){var pdata={link_info:link_info};$.ajax({type:"POST",url:DOMAIN+"/thirdparty_linkinfo",crossDomain:true,dataType:"json",xhrFields:{withCredentials:true},cache:false,data:JSON.stringify(pdata)}).done(function(data,textStatus,jqXHR){window.cbLinkInfo(data)}).fail(function(xhr,status,jqXhr){var error_response=rz._handleErrors(xhr,status,jqXhr,"_extractLinkInfoService");window.cbLinkInfo(error_response)})},_loginService:function(params){var pdata={grant_type:this._grant_type,client_id:this._client_id,scope:this._scope,redirect_uri:this._redirect_uri};if(params.username)pdata.username=params.username;if(params.password)pdata.password=params.password;if(params.uuid)pdata.uuid=params.uuid;if(params.token)pdata.token=params.token;if(params.nonce)pdata.nonce=params.nonce;$.ajax({type:"POST",url:DOMAIN+"/services/login_sso",crossDomain:true,xhrFields:{withCredentials:true},dataType:"json",cache:false,data:pdata}).done(function(data,textStatus,jqXHR){window.cbLogin(data)}).fail(function(xhr,status,jqXhr){var error_response=rz._handleErrors(xhr,status,jqXhr,"_loginService");window.cbLogin(error_response)})},_linkService:function(params){var pdata={client_id:this._client_id};if(params.uuid!="")pdata.uuid=params.uuid;if(params.token!="")pdata.token=params.token;if(params.access_token!="")pdata.access_token=params.access_token;if(params.link_key!="")pdata.link_key=params.link_key;if(params.jwt!="")pdata.jwt=params.jwt;if(params.link!="")pdata.link=params.link;$.ajax({type:"POST",url:DOMAIN+"/thirdparty_link",crossDomain:true,dataType:"json",cache:false,data:JSON.stringify(pdata)}).done(function(data,textStatus,jqXHR){if(data.redirect_uri!=""){window.location.replace(data.redirect_uri)}else{window.cbLinkService(data)}}).fail(function(xhr,status,jqXhr){var data=xhr.responseJSON;if(data.redirect_uri!=""){window.location.replace(data.redirect_uri)}else{var error_response=rz._handleErrors(xhr,status,jqXhr,"_linkService");window.cbLinkService(error_response)}})},_logoutService:function(){$.ajax({type:"GET",crossDomain:true,xhrFields:{withCredentials:true},url:DOMAIN+"/services/logout",cache:false}).done(function(data,textStatus,jqXHR){window.cbLogout(data)}).fail(function(xhr,status,jqXhr){var error_response=rz._handleErrors(xhr,status,jqXhr,"_logoutService");window.cbLogout(error_response)})},_handleErrors:function(xhr,status,jqXhr,service){var response;if(status=="error"){if(xhr.responseText===undefined||xhr.responseText==""){response=JSON.parse('{"error":"server_error","error_description":"An unknown error has occurred"}')}else{response=JSON.parse(xhr.responseText)}}if(status=="success"){if(xhr.responseText===undefined||xhr.responseText==""){response=JSON.parse('{"error":"server_error","error_description":"An unknown error has occurred"}')}else{response=JSON.parse(xhr.responseText)}}if(status=="timeout"){response=JSON.parse('{"error":"request_timeout","error_description":"No response from server"}')}if(xhr.responseText===undefined||xhr.responseText==""){if(xhr.statusText!=""){response=JSON.parse('{"error":"server_error","error_description":"'+xhr.statusText+'"}')}else{response=JSON.parse('{"error":"server_error","error_description":"An unknown error has occurred"}')}}else{response=JSON.parse(xhr.responseText)}this._rzlog(xhr,status,response,service);return response},_getQueryStringValue:function(key){return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(key).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))},_rzlog:function(xhr,status,response,service){if(window.RZSSODEBUG!=undefined&&window.RZSSODEBUG==1){console.info(service);console.info(response)}},verify:function(){this._verifyService()},session:function(){this._getSessionService()},tap:function(){this._putSessionService()},ext_login:function(provider){window.location.replace(DOMAIN+"/thirdparty?provider="+provider+"&client_id="+this._client_id+"&jwt=1&redirect_uri="+this._redirect_uri)},link_info:function(){var link_info=this._getQueryStringValue("link_info");this._extractLinkInfoService(link_info)},ext_link:function(params){this._linkService(params)},login:function(params){this._loginService(params)},logout:function(){this._logoutService()}};(function(funcName,baseObj){"use strict";funcName=funcName||"docReady";baseObj=baseObj||window;var readyList=[];var readyFired=false;var readyEventHandlersInstalled=false;function ready(){if(!readyFired){readyFired=true;for(var i=0;i<readyList.length;i++){readyList[i].fn.call(window,readyList[i].ctx)}readyList=[]}}function readyStateChange(){if(document.readyState==="complete"){ready()}}baseObj[funcName]=function(callback,context){if(typeof callback!=="function"){throw new TypeError("callback for docReady(fn) must be a function")}if(readyFired){setTimeout(function(){callback(context)},1);return}else{readyList.push({fn:callback,ctx:context})}if(document.readyState==="complete"||!document.attachEvent&&document.readyState==="interactive"){setTimeout(ready,1)}else if(!readyEventHandlersInstalled){if(document.addEventListener){document.addEventListener("DOMContentLoaded",ready,false);window.addEventListener("load",ready,false)}else{document.attachEvent("onreadystatechange",readyStateChange);window.attachEvent("onload",ready)}readyEventHandlersInstalled=true}}})("docReady",window);docReady(function(){try{window.RzSdk()}catch(e){console.error(e)}});