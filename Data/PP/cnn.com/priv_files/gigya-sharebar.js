!function(e){"use strict";function t(e){var t=e.attr("id");if(void 0===t||""===t){do{t="gigyaShareBar_"+C,C+=1}while(document.getElementById(t));e.attr("id",t)}return t}function o(e,t){if("function"==typeof window.trackMetrics)try{window.trackMetrics({type:"social-click",data:{clickObj:{socialType:"social: "+e+"_click",headline:t}}})}catch(e){}}function i(){if("function"==typeof window.trackMetrics)try{window.trackMetrics({type:"social-click",data:{clickObj:{socialType:"email_click"}}})}catch(e){}}function a(e,t){if("function"==typeof window.trackMetrics)try{window.trackMetrics({type:"social-click",data:{clickObj:{socialType:"social: facebook "+e+"_click",headline:t}}})}catch(e){}}function n(t,i){e.each(t.providers.split(","),function(a,n){o(n,i.title),e.ajax({url:CNN.SocialConfig.gigya.shareStatsPostURL||"",dataType:"json",type:"POST",data:{actionType:"socialShare",socialType:n||"",headline:i.title||"",shortUrl:t.targetURL||"",url:window.location.href||"",env:CNN.contentModel.env||""}})})}function r(e,t){var o=e.clone();return t&&t.url&&o.setLinkBack(t.url),o}function s(o,i){var a,r,s,c,d=CNN.accounts.cfg.gigya;i=i||{},void 0!==i.elem&&void 0!==i.elem.data("isshorturl")&&(M=i.elem.data("isshorturl")),r=e("<div>").attr("data-js-gigya-share","wrapper").appendTo("body"),s=t(r),c=M?"never":"whenRequired",a={deviceType:"auto",wrap:!0,operationMode:"simpleShare",containerID:s,userAction:o,moreEnabledProviders:d.primaryProviders+","+d.moreEnabledProviders,shortURLs:c,onSendDone:function(e){n(e,o)}},gigya.socialize.showShareUI(a),window.setTimeout(function(){r.attr("data-js-gigya-share-fade","")},10),window.setTimeout(function(){r.attr("data-js-gigya-share-active","")},300)}function c(e){var t=N||v;t?(t=r(t,e),s(t,e)):window.console&&window.console.error&&window.console.error("No canonical share widget has been defined")}function d(o,i){var a,r,s,c,d,l,h=CNN.accounts.cfg.gigya;i=i||{},void 0!==i.elem&&null!==i.elem&&"function"==typeof i.elem.data&&void 0!==i.elem.data("isshorturl")&&(M=i.elem.data("isshorturl")),r=e("<div>"),!Modernizr.mobile||Modernizr.ios&&Modernizr.tablet?r.appendTo(i.elem):(r.appendTo("body"),r.css("z-index","100")),s=t(r),c=M?"never":"whenRequired",a={deviceType:"auto",wrap:!0,operationMode:"simpleShare",containerID:s,userAction:o,moreEnabledProviders:h.primaryProviders+","+h.moreEnabledProviders,shortURLs:c,onSendDone:function(e){n(e,o)},onLoad:function(t){d=e(i.elem).offset(),l=e(i.elem).find(e("div.gig-simpleShareUI")),void 0!==l&&d.left<320&&(!Modernizr.mobile||Modernizr.ios&&Modernizr.tablet?e(l).css("margin-left","35px"):e(l).css("margin-left","0px")),e("div.gig-simpleShareUI-caption").on("click",function(){return!1}),e("div.gig-simpleShareUI-button").on("click",function(){return e("div.gig-simpleShareUI").hide(),!1})}},gigya.socialize.showShareUI(a),window.setTimeout(function(){r.attr("data-js-gigya-share-fade","")},10),window.setTimeout(function(){r.attr("data-js-gigya-share-active","")},300)}function l(t){var o,i=t.attr("data-canonical"),a=t.attr("data-user-message"),n=t.attr("data-link"),r=t.attr("data-title"),s=t.attr("data-subtitle"),c=t.attr("data-description"),d=t.attr("data-twitter-account"),l=t.attr("data-image-src"),h=new gigya.socialize.UserAction;return a&&h.setUserMessage(a),n&&(h.setLinkBack(n),h.addActionLink("Read More",n)),r&&h.setTitle(e.trim(r)+(d?" @"+d:"")),s&&h.setSubtitle(s),c&&h.setDescription(c),l&&(o={type:"image",src:l},n&&(o.href=n),h.addMediaItem(o)),void 0!==i&&(N=h),M=t.attr("data-isshorturl"),h}function h(o,i,a){var r,s,c=CNN.accounts.cfg.gigya,d=e("<div>"),l=t(d),h=c.showCounts,g="gigya-sharebar-element";k>3&&(g+=" gigya-element-large"),d.addClass(g).appendTo(i),k+=1,"none"===h&&"Facebook-Like"===o&&(h="right"),r=M?"never":"Facebook"===o?"never":"whenRequired",void 0!==c.providerCfg[o]?(c.providerCfg[o].provider=o,s=[c.providerCfg[o]]):s=o,gigya.socialize.showShareBarUI({deviceType:"auto",operationMode:"simpleShare",containerID:l,showCounts:h,userAction:a,shareButtons:s,moreEnabledProviders:c.moreEnabledProviders,shortURLs:r,useEmailCaptcha:!1,showEmailButton:!1,emailBody:"$userMsg$<br /><br />I thought you'd like this:<br />$URL$<br /><br />$title$<br />$description$<br />",useHTML:!0,onSendDone:function(e){n(e,a)}})}function g(e){var t,o=CNN.accounts.cfg.gigya.shareButtons.split(","),i=l(e),a=o.length;for(k=1,void 0===v&&(v=i),t=0;t<a;t++)h(o[t],e,i)}function u(e){var t=l(e);e.on("click",function(){s(t,{elem:e})}),e.show()}function f(t){var o,i;t.on("click",function(a){i=e(this),o=l(i),d(o,{elem:t})})}function p(t,o,i,a){if(!t&&window.console&&window.console.error)return void window.console.error("Gigya not loaded -- share bar disabled.");o.each(function(){g(e(this))}),i.each(function(){u(e(this))}),a.each(function(){f(e(this))})}function m(t){var o=e(".js-gigya-sharebar"),i=e(".js-gigya-share"),a=e(".js-gigya-share-collection");(o.length||i.length||a.length)&&(b=t,CNN.accounts.loadGigya(function(e){p(e,o,i,a)}))}function w(){var t,o,n,r,s,c,d=e("html").hasClass("mobile")&&e("html").hasClass("phone"),h=e(".m-share"),g=e(".fb-send-to-messenger-container").detach();for(e(document.body).append(g),t=0;t<h.length;t++)r=e(h[t]),s=r.find(".js-gigya-sharebar"),c=r.find(".share-bar-whatsapp-container").detach(),d&&(s.find(".gig-button-container-twitter").closest(".gigya-sharebar-element").after(c),c.show()),n=r.find(".share-bar-messenger-container").detach(),s.prepend(n),n.show(),o=r.find(".share-bar-email-container").detach(),s.prepend(o),o.show(),o.click(function(t){CNN.contentModel&&"section"===CNN.contentModel.pageType?window.location.href="mailto:?subject="+encodeURIComponent(e(".js-gigya-sharebar").attr("data-title"))+"&body=Check%20out%20this%20story%20on%20CNN:%20"+e(".js-gigya-sharebar").attr("data-link"):CNN.contentModel&&"video"===CNN.contentModel.pageType?window.location.href="mailto:?subject="+encodeURIComponent(e(".js-gigya-sharebar").attr("data-title"))+"&body=Check%20out%20this%20story%20on%20CNN:%20"+e('meta[property="og:url"]')[0].content:window.location.href="mailto:?subject="+encodeURIComponent(e('meta[property="og:title"]')[0].content.replace(/\s*-\ CNN\.com$/,""))+"&body=Check%20out%20this%20story%20on%20CNN:%20"+e('meta[property="og:url"]')[0].content}),o.on("click",i),n.click(function(t){var o,i,n,r=e(t.target).closest(".js-gigya-sharebar"),s=r.width(),c=e(window).width(),d=e(window).height(),h=e(".fb-send-to-messenger-container"),g=r.height(),u=r.offset(),f=u.left-20,p=u.top+g,m=u.left+s,w=l(r),y=e(".share-bar-messenger-container").data("social-media-name"),b=c-(u.left+s);h.show(),o=h.width(),a(y,w.title),u.left>o?(i=p,n=f-o):b>o?(i=u.top,n=m):(n=Math.max(0,(c-h.outerWidth())/2+e(window).scrollLeft()),i=p),(d<500&&c<1025||c<500)&&(n=Math.max(0,(c-h.outerWidth())/2+e(window).scrollLeft()),i=Math.max(0,(d-h.outerHeight())/2+e(window).scrollTop())),h.css({top:i,left:n,position:"absolute"}),CNN.Facebook.addToFBInitHandlers(function(){FB.init({appId:"989591237802489",xfbml:!0,version:"v2.5"}),function(e,t,o){var i,a=e.getElementsByTagName(t)[0];e.getElementById(o)||(i=e.createElement(t),i.id=o,i.src="//connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(i,a))}(document,"script","facebook-jssdk")}),h.find(".close-button").click(function(t){var o=e(t.target).closest(".fb-send-to-messenger-container");o.length>0&&o.is(":visible")&&o.hide()})});e(document).click(function(t){e(t.target).closest(".fb-send-to-messenger-container, .share-bar-messenger-container").length||e(".fb-send-to-messenger-container").hide()})}function y(){var t,o,i,a,n=e(".js-gigya-sharebar"),r=e(".js-gigya-share"),s=e(".js-gigya-share-collection");if(n&&n.length>0){for(t=0;t<n.length;t++)i=e(n[t]).find("div.share-bar-whatsapp-container"),a=e(n[t]).find("div.share-bar-messenger-container"),o=e(n[t]).find("div.share-bar-email-container"),void 0!==i&&e(n[t]).before(e(i)),void 0!==a&&e(n[t]).before(e(a)),void 0!==o&&e(n[t]).before(e(o));n.html("")}r&&r.length>0&&r.html(""),s&&s.length>0&&s.html(""),(n.length||r.length||s.length)&&CNN.accounts.loadGigya(function(e){p(e,n,r,s),w()})}var b,v,N,k,C=0,M=!1;e(window).load(w),e(function(){CNN.accounts.onInitialized(m)}),window.CNN=window.CNN||{},CNN.gigyaShareBar=function(){CNN.accounts.onInitialized(m)},CNN.share=CNN.share||{},CNN.share.popup=c,CNN.share.reloadShareBar=y}(jQuery);