/* Slot Placement [2.0.2] | Copyright JPMorgan Chase & Co. */
(function(a){function i(b){return typeof h[b]=="function"&&(h[b]=h[b](a,d,e)),h[b]}function j(b,c,f){h[b]=f?c(a,d,e):c}function k(a,b){var d=!1,e=a.charAt(0).toUpperCase()+a.slice(1),f=c.length,g=b.style;if(typeof g[a]=="string")d=!0;else while(f--)if(typeof g[c[f]+e]=="string"){d=!0;break}return d}function l(a){if(a)while(a.lastChild)a.removeChild(a.lastChild);return a}function m(a,c){var d=typeof a[c];return d=="object"?!!a[c]:!b[d]}var b={"boolean":1,number:1,string:1,"undefined":1},c=["Webkit","Moz","O","ms","Khtml"],d=m(a,"document")&&a.document,e=d&&m(d,"createElement")&&d.createElement("DiV"),f=typeof exports=="object"&&exports,g=typeof module=="object"&&module,h={};i.add=j,i.clearElement=l,i.cssprop=k,i.isHostType=m,i._tests=h,i.add("dom",function(a,b,c){return b&&c&&m(a,"location")&&m(b,"documentElement")&&m(b,"getElementById")&&m(b,"getElementsByName")&&m(b,"getElementsByTagName")&&m(b,"createComment")&&m(b,"createElement")&&m(b,"createTextNode")&&m(c,"appendChild")&&m(c,"insertBefore")&&m(c,"removeChild")&&m(c,"getAttribute")&&m(c,"setAttribute")&&m(c,"removeAttribute")&&m(c,"style")&&typeof c.style.cssText=="string"});try{document.execCommand("BackgroundImageCache",!1,!0)}catch(n){}typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("has",[],function(){return i}):f?g&&g.exports==f?(g.exports=i).has=i:f.has=i:a.has=i})(this),define("jquery-cookie",["jquery"],function(a){return function(a,b,c){function d(a){return a}function e(a){return decodeURIComponent(a.replace(f," "))}var f=/\+/g;a.cookie=function(f,g,h){if(g!==c&&!/Object/.test(Object.prototype.toString.call(g))){if(h=a.extend({},a.cookie.defaults,h),null===g&&(h.expires=-1),"number"==typeof h.expires){var j=h.expires,k=h.expires=new Date;k.setDate(k.getDate()+j)}return g=String(g),b.cookie=[encodeURIComponent(f),"=",h.raw?g:encodeURIComponent(g),h.expires?"; expires="+h.expires.toUTCString():"",h.path?"; path="+h.path:"",h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}h=g||a.cookie.defaults||{};for(var l,m=h.raw?d:e,o=b.cookie.split("; "),p=0;l=o[p]&&o[p].split("=");p++)if(m(l.shift())===f)return m(l.join("="));return null},a.cookie.defaults={},a.removeCookie=function(b,c){return null!==a.cookie(b,c)?(a.cookie(b,null,c),!0):!1}}(a,document),a.cookie}),!function(a){function b(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}function c(a,b){if("function"!=typeof a)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}function d(){this._bindings=[],this._prevParams=null;var a=this;this.dispatch=function(){d.prototype.dispatch.apply(a,arguments)}}b.prototype={active:!0,params:null,execute:function(a){var b,c;return this.active&&this._listener&&(c=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,c),this._isOnce&&this.detach()),b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},d.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,c,d,e){var f,g=this._indexOfListener(a,d);if(-1!==g){if(f=this._bindings[g],f.isOnce()!==c)throw new Error("You cannot add"+(c?"":"Once")+"() then add"+(c?"Once":"")+"() the same listener without removing the relationship first.")}else f=new b(this,a,c,d,e),this._addBinding(f);return this.memorize&&this._prevParams&&f.execute(this._prevParams),f},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c,d=this._bindings.length;d--;)if(c=this._bindings[d],c._listener===a&&c.context===b)return d;return-1},has:function(a,b){return-1!==this._indexOfListener(a,b)},add:function(a,b,d){return c(a,"add"),this._registerListener(a,!1,b,d)},addOnce:function(a,b,d){return c(a,"addOnce"),this._registerListener(a,!0,b,d)},remove:function(a,b){c(a,"remove");var d=this._indexOfListener(a,b);return-1!==d&&(this._bindings[d]._destroy(),this._bindings.splice(d,1)),a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var a,b=Array.prototype.slice.call(arguments),c=this._bindings.length;if(this.memorize&&(this._prevParams=b),c){a=this._bindings.slice(),this._shouldPropagate=!0;do c--;while(a[c]&&this._shouldPropagate&&a[c].execute(b)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var e=d;e.Signal=d,"function"==typeof define&&define.amd?define("signals",[],function(){return e}):"undefined"!=typeof module&&module.exports?module.exports=e:a.signals=e}(this),define("optional",{load:function(a,b,c,d){if(d.isBuild)c();else{var e=function(a){c(a)},f=function(a){var c=a.requireModules&&a.requireModules[0];window.console&&console.log("Slot Placement - Could not load optional module=["+c+"]"),requirejs.undef(c),define(c,[],function(){return{}}),b([c],e)};b([a],e,f)}}}),define("jquery-isOnScreen",["jquery"],function(a){a.fn.isOnScreen=function(b,c){if(b==null||typeof b=="undefined")b=1;if(c==null||typeof c=="undefined")c=1;var d=a(window),e={top:d.scrollTop(),left:d.scrollLeft()};e.right=e.left+d.width(),e.bottom=e.top+d.height();var f=this.outerHeight(),g=this.outerWidth();if(!g||!f)return!1;var h=this.offset();h.right=h.left+g,h.bottom=h.top+f;var i=!(e.right<h.left||e.left>h.right||e.bottom<h.top||e.top>h.bottom);if(!i)return!1;var j={top:Math.min(1,(h.bottom-e.top)/f),bottom:Math.min(1,(e.bottom-h.top)/f),left:Math.min(1,(h.right-e.left)/g),right:Math.min(1,(e.right-h.left)/g)};return j.left*j.right>=b&&j.top*j.bottom>=c}}),define("slotplacement/config",["jquery","optional!slotplacement/clientconfig","slotplacement/slotplacementconfig"],function(a,b,c){var d={contentServer:a.isEmptyObject(b)||typeof b.contentServer=="undefined"?c.contentServer:b.contentServer,isAuthorMode:a.isEmptyObject(b)||typeof b.isAuthorMode=="undefined"?c.isAuthorMode:b.isAuthorMode,isClassic:a.isEmptyObject(b)||typeof b.isClassic=="undefined"?c.isClassic:b.isClassic,loadingImagePath:a.isEmptyObject(b)||typeof b.loadingImagePath=="undefined"?c.loadingImagePath:b.loadingImagePath,timeout:a.isEmptyObject(b)||typeof b.timeout=="undefined"?c.timeout:b.timeout,timeoutFailover:a.isEmptyObject(b)||typeof b.timeoutFailover=="undefined"?c.timeoutFailover:b.timeoutFailover,excludedQueryPassforwardParams:a.isEmptyObject(b)||typeof b.excludedQueryPassforwardParams=="undefined"?c.excludedQueryPassforwardParams:b.excludedQueryPassforwardParams,adServiceURL:a.isEmptyObject(b)||typeof b.adServiceURL=="undefined"?c.adServiceURL:b.adServiceURL,trackingPixelImagePath:a.isEmptyObject(b)||typeof b.trackingPixelImagePath=="undefined"?c.trackingPixelImagePath:b.trackingPixelImagePath,XPOOrgID:c.XPOOrgID,adTrackingDisabled:a.isEmptyObject(b)||typeof b.adTrackingDisabled=="undefined"?c.adTrackingDisabled.toString():b.adTrackingDisabled.toString(),loggingEnabled:a.isEmptyObject(b)||typeof b.loggingEnabled=="undefined"?a.isEmptyObject(c)||typeof c.loggingEnabled=="undefined"?"true":c.loggingEnabled:b.loggingEnabled,debugEnabled:a.isEmptyObject(b)||typeof b.debugEnabled=="undefined"?a.isEmptyObject(c)||typeof c.debugEnabled=="undefined"?"false":c.debugEnabled:b.debugEnabled,activityTagURL:a.isEmptyObject(b)||typeof b.activityTagURL=="undefined"?c.activityTagURL:b.activityTagURL,variationActivityTag:a.isEmptyObject(b)||typeof b.variationActivityTag=="undefined"?c.variationActivityTag:b.variationActivityTag,viewableImpressionTag:a.isEmptyObject(b)||typeof b.viewableImpressionTag=="undefined"?c.viewableImpressionTag:b.viewableImpressionTag,failOverAdServiceUrl:a.isEmptyObject(b)||typeof b.failOverAdServiceUrl=="undefined"?c.failOverAdServiceUrl:b.failOverAdServiceUrl,isLoggingEnabled:function(){return window.console&&d.loggingEnabled!=="false"},isDebugEnabled:function(){return window.console&&d.debugEnabled==="true"}};return d}),define("slotplacement/adsize",[],function(){var a={"iab-pop-medrec":{width:300,height:250},"iab-pop-wideskyscraper":{width:160,height:600},"iab-pop-leaderboard":{width:728,height:90},"iab-pop-halfpage":{width:300,height:600},"iab-large-portrait":{width:300,height:1050},"iab-large-billboard":{width:970,height:250},"iab-small-rectangle":{width:180,height:150},"iab-small-button1":{width:120,height:90},"iab-small-button2":{width:120,height:60},"iab-small-microbar":{width:88,height:31},"pb-tile":{width:250,height:65},"pb-tile1":{width:232,height:100},"pb-tile2":{width:232,height:200},"pb-medrec":{width:226,height:157},"pb-halfpage":{width:720,height:360},"cig-navad":{width:155,height:90},"cig-banner":{width:379,height:75},"cig-widebanner":{width:530,height:75},"cig-tout":{width:46,height:88},"cig-halfpage":{width:720,height:700},"cig-marque":{width:572,height:150},"cig-masthead":{width:680,height:287},"cig-carousel":{width:867,height:200},"cig-smallmarquee":{width:350,height:150},"cig-hero-marquee":{width:600,height:250},banw:{width:575,height:350},ban:{width:375,height:35},rtnv1:{width:155,height:90},rtnv2:{width:155,height:90},nvann:{width:155,height:90},interstitial:{width:833,height:380},ur_primary_bnr:{width:894,height:392},ur_dual_bnr:{width:440,height:205},ur_quad_bnr:{width:219,height:195},ur_footer_bnr:{width:468,height:215},"ur-hero-main":{width:716,height:300},"ur-hero-travel":{width:650,height:325},"ur-tile-travel":{width:345,height:204},"pb-tile3":{width:474,height:200},"ur-tile-mobile":{width:575,height:223},"cig-hero-marquee2":{width:960,height:250},"cig-hero-marquee3":{width:930,height:490}};return a}),define("slotplacement/cookie",["jquery","jquery-cookie","has"],function(a,b,c,d){c.add("cookies",function(a,b,c){var d=!1;return"cookie"in b&&(b.cookie="cookietest=1",d=b.cookie.indexOf("cookietest=")!==-1,b.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT"),d});if(c("cookies")){var e=window.document.domain,f=window.location.protocol,g=/localhost|127\.0\.0\.1/.test(e),h=/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/.test(e),i=/https/.test(f),j=function(){var a;return g||(h?a=e:e.indexOf(".")!==-1&&(a="."+e.split(".").slice(-2).join("."))),a},k=j(),l=function(b,c){l.cookies=l.cookies||{};var d=b&&l.cookies[b];return d||(d={settings:c||{},erase:function(c){var d=a.extend({},this.settings,c||{});try{a.removeCookie(b,d)}catch(e){}},read:function(){var c;try{c=a.cookie(b)}catch(d){}return c},write:function(c,d){var e=a.extend({},this.settings,d||{});try{a.cookie(b,c,e)}catch(f){}}},b&&(l.cookies[b]=d)),d};return a.cookie.defaults=a.extend({path:"/",secure:i,raw:!0},k?{domain:k}:{}),l}}),define("slotplacement/cors",["jquery","has"],function(a,b){function j(a){var b=a.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return b&&{protocol:b[1],host:b[2],hostname:b[3],port:b[4],pathname:b[5],search:b[6],hash:b[7]}}b.add("xhr-cors",function(a,c,d){return b.isHostType(a,"XMLHttpRequest")&&"withCredentials"in new XMLHttpRequest});var c=Array.prototype.slice,d="Content-Type",e="cors",f={xhrFields:{withCredentials:!0}},g=a.Deferred(),h=g.promise(),i;return a.ajaxPrefilter(function(c,d,g){if(c.dataType===e||c.crossDomain&&c.async&&c.dataType!=="script"&&c.dataType!=="jsonp"){c=a.extend({},f,c);if(!b("xhr-cors"))return e}}),b("xhr-cors")||a.ajaxTransport(e,function(b,c,e){var f,g=function(){f=undefined};if(typeof XDomainRequest!="undefined")return f=new XDomainRequest,b.dataTypes.shift(),{send:function(c,h){var i=function(a,b,c,d){g(),h(a,b,c,d)};c[d]=b.contentType;var j=b.url,k=a(location).attr("protocol")+"//"+a(location).attr("host");c.Origin=k,b.timeout&&(f.timeout=b.timeout),f.open(b.type,j),setTimeout(function(){f.send()},0),f.onerror=function(){b.error()},f.ontimeout=function(){b.error()},f.onprogress=function(){},f.onload=function(){var c={},g=200,h="OK",j=b.contents,k=b.dataTypes,l={},m=b.mimeType||f.contentType||e.getResponseHeader(d)||e.getResponseHeader(d.toLowerCase()),n;while(k[0]==="*")k.shift();if(m){for(n in j)if(j[n]&&j[n].test(m)){k.unshift(n);break}}else k.unshift("text");b.dataType=k[0],b.dataType=="json"?c[k[0]]=a.parseJSON(f.responseText):c[k[0]]=f.responseText,i(g,h,c,l)}},abort:function(){g()}}}),a.corsAjax=function(b,c){a.isPlainObject(b)?(c=b,b=undefined):(c=c||{},c.url=b);var d=a.extend({dataType:"html"},c);return a.ajax(d)},a.corsAjax}),define("slotplacement/persona",["jquery","slotplacement/cookie","has"],function(a,b,c,d){var e,f={}.toString,g=new Date,h="[object Function]";c.add("cookies",function(a,b,c){var d=!1;return"cookie"in b&&(b.cookie="cookietest=1",d=b.cookie.indexOf("cookietest=")!==-1,b.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT"),d}),c.add("date-toisostring",function(a,b,c){return f.call(g.toISOString)==h});if(c("cookies")){var i=window.document,j=window.decodeURIComponent,k=window.encodeURIComponent,l=window.escape,m=window.unescape,n="PC_1_0",o=function(a,b){a=a.split(" ");for(var c=0,e=a.length;c<e;c++)b[a[c]]!==d&&delete b[a[c]]},p=function(){var a=new Date,b;if(c("date-toisostring"))b=a.toISOString().split("T")[0];else{var d=function(a,b){var c=""+a;b=b||2;for(var d=0,e=b-c.length;d<e;d++)c="0"+c;return c},e=a.getFullYear(),f=d(a.getMonth()+1),g=d(a.getDate());b=[e,f,g].join("-")}return b},q=function(a){var b={};if(a)for(var c=0,d=a.length;c<d;c++){var e=a[c];b[e[0]]={},b[e[0]].uratc=e[1],b[e[0]].rwdb=e[2]}return b},r=function(b){var c=v(m(b),"|"),d={};for(var e=0,f=c.length;e<f;e++){var g=c[e].split("="),h=g[0],i=v(j(g[1]),"&");if(a.isArray(i))for(var k=0,l=i.length;k<l;k++){var n=i.shift();n=n.split(","),i.push(n)}else i=v(i,",");d[h]=i}return d},s=function(a,b,c){var d=c[a];if(d)for(var e=0,f=d.length;e<f;e++)if(b==d[e])return"Y";return"N"},t=function(b){var c=[],d,e,f,g;return a.each(b,function(b,h){d=a.isArray(h),e=d&&!!h.length&&a.isArray(h[0]),f=w(b,h);if(f){if(e){for(var i=0,j=h.length;i<j;i++){var m=h.shift();m=m.join(","),h.push(m)}h=u(h,"&")}d&&(h=u(h,",")),g=e?l(b+"=")+h:l(b+"="+k(h)),c.push(g)}}),u(c,"|")},u=function(b,c){return a.isArray(b)?b.join(c)+c:b},v=function(a,b){if(a.indexOf(b)!==-1){var c=a.charAt(a.length-1)===b,d=c&&a.charAt(a.length-2)===b;return(c&&!d?a.substring(0,a.length-1):a).split(b)}return a},w=function(b,c){var d=/^([A-Za-z0-9]{1,5}|,)*$/,e=/^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$/,f=/^\d{4}-\d{2}-\d{2}$/,g=/^(Y|N)$/,h=/^([A-Za-z0-9]{3,4}|,)*$/,i=/^\d{5}-?(\d{4})?$/,j=function(a,b){return a.test(b)},k={AOC:a.proxy(j,this,d),GUID:a.proxy(j,this,g),known:a.proxy(j,this,g),lastSent:a.proxy(j,this,f),lastUpdate:a.proxy(j,this,f),RPC:a.proxy(j,this,h),segment:function(a){return a.length===3},source_code_applied:function(a){return a.length===4},zip:a.proxy(j,this,i)},l=a.isFunction(k[b])?k[b](c):!0;return l},x=a.proxy(b,this,n,{expires:365});e=function(){return{erase:function(){x().erase()},read:function(a){a=a||!1;var b=x().read(),c;if(a)c=b;else try{b=r(b),b.pplr=s("ppl","A",b),b.fieir=s("fiei","Y",b),b.fpeir=s("fpei","Y",b),b.sieir=s("siei","Y",b),b.tieir=s("tiei","Y",b),b.accounts=q(b.accts),c=b}catch(d){}return c},write:function(a){try{var b=p();typeof a=="string"&&(a=r(a)),a.lastUpdate=b,a.lastSent=a.lastSent||a.lastUpdate,a.segment&&a.seg&&delete a.seg,o("fieir fpeir pplr sieir tieir accounts",a),a=t(a),x().write(a)}catch(c){}}}}}return e}),define("slotplacement/topic",["jquery","signals"],function(a,b){function d(a){b.call(this),this.name=a||"",this.memorize=!0}function e(a){var b=a&&c[a];return b||(b=new d(a),a&&(c[a]=b)),b}var c={};return d.prototype=new b,d.constructor=d.prototype.constructor=d,d.prototype.clear=function(){return this.forget.apply(this,arguments)},d.prototype.once=function(){return this.addOnce.apply(this,arguments)},d.prototype.publish=function(a){return this.dispatch.apply(this,arguments)},d.prototype.subscribe=function(a,b,c){return this.add.apply(this,arguments)},d.prototype.unsubscribe=function(){return this.remove.apply(this,arguments)},e.Channel=d,e.channels=c,e.exists=function(a){return!!c[a]},e.publish=function(a,b){var c=a.split(" ");for(var d=0,f=c.length;d<f;d++){var g=e(c[d]);g.publish.apply(g,b||[])}},e.subscribe=function(b,c,d){var f={},g={},h=0,i,j;return a.isPlainObject(b)?(f=b,d=Array.prototype.pop.call(arguments),c=undefined):f[b]=c,a.each(f,function(a,b){i=e(a),d=d||i,j=function(){b.apply(d,arguments)},i.subscribe(j),g[a]=j,h++}),h===1?g[b]:g},e.unsubscribe=function(b,c){var d={};a.isPlainObject(b)?d=b:d[b]=c,a.each(d,function(a,b){e(a).unsubscribe(b)})},e}),define("slotplacement/v1st",["slotplacement/cookie","has"],function(a,b,c){var d="v1st",e;return b.add("cookies",function(a,b,c){var d=!1;return"cookie"in b&&(b.cookie="cookietest=1",d=b.cookie.indexOf("cookietest=")!==-1,b.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT"),d}),b("cookies")&&(e=function(){var b=a(d),e=/^\w+$/,f={erase:b.erase,read:function(){var a=b.read();return e.test(a)||(a=c),a},write:function(a){a!==null&&a!==c&&e.test(a)&&b.write(a)}};return f}),e}),define("slotplacement/logger",["jquery","slotplacement/config"],function(a,b){var c={},d={logErrorMsg:function(d,e){window.Blue&&window.Blue.version&&window.require(["blue/log"],function(b){a.isEmptyObject(c)&&(c=b("[ad-framework-messages]")),c.error(d,e)}),b.isLoggingEnabled()&&console.log(d,e)},logDebugMsg:function(d,e){window.Blue&&window.Blue.version&&window.require(["blue/log"],function(b){a.isEmptyObject(c)&&(c=b("[ad-framework-messages]")),c.debug(d,e)}),b.isDebugEnabled()&&console.log(d,e)},logMsg:function(a,c){b.isLoggingEnabled()&&console.log(a,c)},debugMsg:function(a,c){b.isDebugEnabled()&&console.log(a,c)}};return d}),define("slotplacement/contentprovider",["jquery","slotplacement/config","slotplacement/cors","slotplacement/topic","slotplacement/logger"],function(a,b,c,d,e){var f=b.contentServer,g=b.isAuthorMode,h=b.isClassic,i={settings:{cache:!0},failOverData:{},isCrossDomain:function(a){rurl=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,ajaxLocParts=rurl.exec(a.toLowerCase()),parts=rurl.exec(document.location.protocol+"//"+document.location.host);var b=!(!parts||parts[1]==ajaxLocParts[1]&&parts[2]==ajaxLocParts[2]&&(parts[3]||(parts[1]==="http:"?80:443))==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?80:443)));return b},getContentLocation:function(a){var b=a;return a.charAt(0)=="/"&&(b=f+a),b=b.replace("jcr:content","_jcr_content"),g||(g="false"),g==="true"&&(b.indexOf("?")===-1?b+="?wcmmode=disabled":b+="&wcmmode=disabled"),b},evaluateDynamicAd:function(b,c){function g(b){return a.inArray(b,f)>-1?!0:!1}var f=c.audiences?c.audiences.split(","):[],h=JSON.parse(b),i={},j={};for(permutationIndex in h.result.permutations)if(h.result.permutations[permutationIndex].rules!=""){var k="",l=h.result.permutations[permutationIndex].rules.split(" ");for(rulesIndex in l)if(l[rulesIndex].indexOf("hA")!==-1){var m=l[rulesIndex].substring(4,l[rulesIndex].length-2);k+=g(m)}else k+=l[rulesIndex];var n=(new Function("return "+k))();if(n){j.adVariantData=h.result.permutations[permutationIndex].adVariationContext,j.html=h.result.permutations[permutationIndex].html;break}}else j.adVariantData=h.result.permutations[permutationIndex].adVariationContext,j.html=h.result.permutations[permutationIndex].html;if(c.trackVariation){var o={};o.adLabel="XPlusOne",e.debugMsg("Slot Placement - [trackAdVariation] Event Published for PID:",c.pid),d("trackAdVariation").publish(c.pid,o,j.adVariantData,c.pageId)}return j},load:function(a,b,g,h){var j=i.getContentLocation(a),k=i.settings;k.error=function(){e.logErrorMsg("Slot Placement - Error loading content from URL:",j),window.Blue&&window.Blue.version&&(typeof h!="undefined"&&h!==""?d("trackfailOverImpression").publish("content_fail",h.pageId,h.pid):d("trackfailOverImpression").publish("content_fail"),e.logMsg("Slot Placement - [trackfailOverImpression] Event Published for URL:",j)),g()},e.debugMsg("Slot Placement - Loading content from URL:",j),c(j,k).then(function(a){e.debugMsg("Slot Placement - Content loaded successfully from URL:",j),i.isCrossDomain(j)&&(a=a.replace(/\"\//g,'"'+f+"/"),a=a.replace(/\'\//g,"'"+f+"/")),b(a)})},loadAd:function(a,b,c,d){if(h!=="false"){var e=a.substring(a.lastIndexOf("/"),a.length),f=e.split(".");if(f.length>2){var g="";for(var j=1;j<f.length-1;j++)g+=f[j]+".";a=a.replace("."+g+"html","/_jcr_content/par."+g+"html")}else a.indexOf(".html")!=-1?a=a.replace(".html","/_jcr_content/adcreationcontainer/par.html"):a.indexOf(".htm")!=-1&&(a=a.replace(".htm","/_jcr_content/adcreationcontainer/par.html"))}a.indexOf("/services/creatives/private/native-dynamic-ads")!==-1?i.load(a,function(a){var c={};c.trackVariation=!1;var e=i.evaluateDynamicAd(a,c),f=e.html.replace("${jpmcPageVar.clickThruUrl}",d);b(f)},c):i.load(a,function(a){a=a.replace("${jpmcPageVar.clickThruUrl}",d),b(a)},c)},loadBlueAd:function(b,c,d,e){var f=a.extend({clickThroughUrl:null,trackVariation:!0},e);b.indexOf(".dynamic.html")!=-1?i.load(b,function(a){a=a.replace("${jpmcPageVar.clickThruUrl}",f.clickThroughUrl),c(a)},d):i.load(b,function(a){var b=i.evaluateDynamicAd(a,f),d=b.html.replace("${jpmcPageVar.clickThruUrl}",f.clickThroughUrl);c(d,b.adVariantData)},d,f)},getFailoverContentPaths:function(b,c,d){var e={},f={};a.when(i.getFailOverAdData(b)).then(function(b){b.success&&b.result.failOverDetails!=undefined&&b.result.failOverDetails.length>0&&a.each(b.result.failOverDetails,function(a,b){b.hasOwnProperty("failoverAdUrl")&&b.failoverAdUrl!=""&&b.hasOwnProperty("slotId")&&b.slotId!=""&&b.hasOwnProperty("failoverAdId")&&b.failoverAdId!=""&&(e[b.slotId]=b.failoverAdUrl),f[b.slotId]=b.failoverAdId}),Object.keys(e).length>0?c(e,f):d()},function(a){d()})},getFailOverAdData:function(d,f){var g=a.Deferred();if(d===undefined||d=="")g.reject("Error - pageId is undefined");else if(i.failOverData[d]==undefined){var h=undefined;f!=undefined?h=b.failOverAdServiceUrl+"."+d+"."+f+".json":h=b.failOverAdServiceUrl+"."+d+".json";var j={url:h,dataType:"json",jsonp:"_callback",timeout:b.timeoutFailover,error:function(a,b,c){b==="timeout"?e.logErrorMsg("Slot Placement - Timeout. [adError] getFailOverUrl Event Published for Page Id:",d):e.logErrorMsg("Slot Placement - [adError] getFailOverUrl Event Published for Page Id:",d),g.reject(c+"Error")}};c(j).then(function(a){i.failOverData[d]=a,g.resolve(a)})}else g.resolve(i.failOverData[d]);return g.promise()},loadAdCollectionContent:function(b,c){var d=[],f={},g={},h={},j={};return c.failoverAdIds!=undefined&&(j=c.failoverAdIds),a.each(b,function(b,k){var l=new a.Deferred,m=i.getContentLocation(k),n=function(d){if(c.evaluateDynamicAd){var e=a.extend({clickThroughUrl:null,trackVariation:!0},c),k=i.evaluateDynamicAd(d,e);h[b]=k.adVariantData,g[b]=k.html}else g[b]=d;f.adVariationArray=h,f.contentArray=g,f.failoverAdIds=j,l.resolve(f)},o=function(){l.reject("Error")};if(k!=""){var p=a.extend({clickThroughUrl:null,trackVariation:!0,pid:b},c);i.load(m,function(a){n(a)},o,p),d.push(l)}else e.logErrorMsg("Slot Placement - [adCollectionUpdate] CID not forunt for the placement:",b)}),a.when.apply(undefined,d).promise()},loadAdCollection:function(b,c,d,e){var f=a.extend({evaluateDynamicAd:!1},e);a.when(i.loadAdCollectionContent(b,f)).then(function(a){c(a.contentArray,a.adVariationArray,a.failoverAdIds)},function(){var a=function(a,b){e.failoverAdIds=b,i.loadAdCollection(a,c,d,e)},b=function(){d()};i.getFailoverContentPaths(e.pageId,a,b)})},loadBlueAdCollection:function(b,c,d,e){var f=a.extend({loadFailover:!1,evaluateDynamicAd:!0},e);if(!f.loadFailover)i.loadAdCollection(b,c,d,f);else{var g=function(a,b){f.failoverAdIds=b,i.loadAdCollection(a,c,d,f)};i.getFailoverContentPaths(f.pageId,g,d)}}};return i}),define("slotplacement/service",["jquery","slotplacement/config","slotplacement/contentprovider","slotplacement/topic","slotplacement/persona","slotplacement/v1st","slotplacement/cors","slotplacement/logger"],function(a,b,c,d,e,f,g,h){var i="",j={},k={},l=function(a){if(a=="")return{};var b={};for(var c=0;c<a.length;++c){var d=a[c].split("=");if(d.length!=2)continue;b[d[0]]=decodeURIComponent(d[1].replace(/\+/g," "))}return b}(window.location.search.substr(1).split("&")),m={init:function(j,m,n){function o(a){var b=!!a;return b?(a+"").substr(0,5):b}function u(a,b){if(typeof a=="undefined")return;t.test(a)&&(s.data[b]=a)}function v(a,b,c){b!="adCollection"?d("adError").publish(a,b,c):d("adCollectionError").publish(a,b,c)}function w(b){require(["slotplacement/adtracking"],function(c){a.isEmptyObject(k)?k=new c(j,b):k.addPage(j,b),h.debugMsg("Slot Placement - Registered Ad Tracker for Page Id:",j)})}h.logMsg("Slot Placement - Service.init() called with Page Id:",j),i=j,this.pageid=j,this.ssv_parameters={},typeof m=="object"&&(this.ssv_parameters.pfid=typeof m.pfid=="undefined"?null:m.pfid,this.ssv_parameters.zip=typeof m.zip=="undefined"?null:m.zip,this.ssv_parameters.cigseg=typeof m.cigseg=="undefined"?null:m.cigseg,this.ssv_parameters.locale=typeof m.locale=="undefined"?null:m.locale,this.ssv_parameters.product=typeof m.product=="undefined"?null:m.product,this.ssv_parameters.userType=typeof m.userType=="undefined"?null:m.userType,this.ssv_parameters.products=typeof m.products=="undefined"?null:a.isArray(m.products)?m.products.join(";"):m.products,this.ssv_parameters.pnpcs=typeof m.pnpcs=="undefined"?null:a.isArray(m.pnpcs)?m.pnpcs.join(";"):m.pnpcs,this.ssv_parameters.lids=typeof m.lids=="undefined"?null:a.isArray(m.lids)?m.lids.join(";"):m.lids,this.ssv_parameters.eci=typeof m.eci=="undefined"?null:m.eci,this.ssv_parameters.sitebrand=typeof m.sitebrand=="undefined"?null:m.sitebrand,this.ssv_parameters.siteacct=typeof m.siteacct=="undefined"?null:m.siteacct,this.ssv_parameters.pnpc=typeof m.pnpc=="undefined"?null:m.pnpc,this.ssv_parameters.pageLayout=typeof m.pageLayout=="undefined"?null:m.pageLayout),d("personaUpdated").subscribe(function(){this.start()});if(typeof j=="undefined"){n!="adCollection"?(d("adError").publish("error",n,"decision_fail"),h.logErrorMsg("Slot Placement - [adError] Event Published for Page Id:",j)):(d("adCollectionError").publish("error",n,"decision_fail"),h.logErrorMsg("Slot Placement - [adCollectionError] Event Published for Page Id:",j));return}var p=this,q=a.isFunction(e)?e().read():{},r=b.isClassic==="true"?"jsonp":"json",s={url:b.adServiceURL,dataType:r,jsonp:"_callback",cache:!1,timeout:j==="timeout"?"900":b.timeout,xhrFields:{withCredentials:!0},data:{_o:b.XPOOrgID,_t:j,ssv_v1st:a.isFunction(f)?f().read():"",ssv_pfid:this.ssv_parameters.pfid||q.pfid||"",ssv_zip:o(this.ssv_parameters.zip)||o(q.zip)||"",ssv_cigseg:this.ssv_parameters.cigseg||q.segment||"",ssv_locale:this.ssv_parameters.locale||q.locale||"",ssv_random:Math.floor(Math.random()*998+1),ssv_product:this.ssv_parameters.product||"",ssv_userType:this.ssv_parameters.userType||"",ssvm_products:this.ssv_parameters.products||"",ssvm_pnpcs:this.ssv_parameters.pnpcs||"",ssvm_lids:this.ssv_parameters.lids||"",ssv_eci:this.ssv_parameters.eci||q.ECI,ssv_pnpc:this.ssv_parameters.pnpc||"",ssv_sitebrand:this.ssv_parameters.sitebrand||"",ssv_siteacct:this.ssv_parameters.siteacct||"",ssv_pageLayout:this.ssv_parameters.pageLayout||""},error:function(b,e,f){var g="decision_fail";e==="timeout"?(g="decision_timeout_fail",h.logErrorMsg("Slot Placement - Timeout. [adError] Event Published for Page Id:",j)):h.logErrorMsg("Slot Placement - [adError] Event Published for Page Id:",j),a.when(c.getFailOverAdData(j)).then(function(a){v(j,n,g)},function(){v(j,n,g)}),w(b),window.Blue&&window.Blue.version&&j!="test_cpo_secure_exploreproducts"&&j!="cpo_secure_exploreproducts"&&(h.logMsg("Slot Placement - [trackfailOverImpression] Event Published for Page Id:",j),d("trackfailOverImpression").publish(g,j))}},t=/^[0-9a-zA-Z]+$/;u(l.bu,"ssv_bu"),u(l.bi,"ssv_bi"),u(l.ad_id,"ssv_ad"),h.logMsg("Slot Placement - Calling XPO with Page Id:",j),g(s).then(function(a){n!="adCollection"?d("adUpdate").publish(j,a,n):d("adCollectionUpdate").publish(j,a,n),h.logMsg("Slot Placement - [adUpdate] Event Published for Page Id:",j),w(a)})},destroy:function(b){if(i!==""&&i===b){h.logMsg("Slot Placement - Destroying Page Id:",b),i="";var c=[];a.each(j,function(a,b){c.push(b)}),m.destroyPlacements(c),m.destroyAdTracker(b),a.each(d.channels,function(a,b){h.debugMsg("Slot Placement - Destroying Topic Channel:",b.name),d.channels[a]=null,delete d.channels[a]})}},destroyPlacements:function(){var b=[];for(var c=0;c<arguments.length;c++)typeof arguments[c]=="string"?b.push(arguments[c]):a.isArray(arguments[c])&&a.each(arguments[c],function(a,c){b.push(c)});a.each(b,function(b,c){typeof j[c]!="undefined"&&(h.debugMsg("Slot Placement - Destroying Event Handlers for Placement:",c),a("#"+c).children().off(".slotplacement"),j[c]=null,delete j[c])})},destroyAdTracker:function(b){a.isEmptyObject(k)||(h.debugMsg("Slot Placement - Destroying Ad Tracker for Page Id:",b),k={})},registerPlacement:function(a){typeof j[a]=="undefined"&&(j[a]=a)}};return m}),define("slotplacement/placement",["jquery","slotplacement/adsize","slotplacement/config","slotplacement/contentprovider","slotplacement/topic","slotplacement/cors","slotplacement/logger","jquery-isOnScreen"],function(a,b,c,d,e,f,g){function p(c){var f=this,p=this,q={};this.arguments=a.extend({},o,c),this.validateInput=function(){var a=!0;if(this.width==0||this.height==0)a=!1;return a},this.arguments.pid!=undefined?element=a("#"+this.arguments.pid):element=undefined,this.AdTracking={Element:element,Debounce:function(a,b,c){var d;return function(){function h(){c||a.apply(f,g),d=null}var f=this,g=arguments;d?clearTimeout(d):c&&a.apply(f,g),d=setTimeout(h,b||100)}},IsElementInViewport:function(a){var b=a.parent();if(a.isOnScreen(.5,.5)){if(b==undefined||b.attr("aria-hidden")==undefined)return!0;if(b.attr("aria-hidden")=="false")return!0}}},this.setParentSpinnerObject=function(b){var c=a("#"+b).parent().parent();return q.options={},q.options.loadingView=this.arguments.loadingView,q.options.responsive=this.arguments.responsive,q.element=c,q},this.getParentSpinnerObject=function(){return q},this.getAdCollection=function(b,c,e){p.pageId=e;var f={},h={},i={},j=!1;i.pageId=e;var k=function(a,b,d){d!=undefined&&(c.failoverAdIds=d),p.renderAdCollection(c,a)},l=function(){p.spinner.hide(p.getParentSpinnerObject())};for(var m=0;m<b.pids.length;m++){p.element=a("#"+b.pids[m]),g.debugMsg("Slot Placement - [adCollectionUpdate] Event Received for PID:",b.pids[m]);var n=function(a,b){i.failoverAdIds=b,d.loadAdCollection(a,k,l,i)},o=function(){p.spinner.hide(p.getParentSpinnerObject())};if(c[b.pids[m]]===undefined){g.logMsg("Slot Placement - [adCollectionUpdateError] RF response does not match for this placement: ",b.pids[m]),p.spinner.hide(p.getParentSpinnerObject()),j=!0;break}if(c[b.pids[m]].cid==""){g.logMsg("Slot Placement - [adCollectionUpdateError] RF response has empty cid for this placement: ",b.pids[m]),h={},j=!0,d.getFailoverContentPaths(e,n,o);break}f[b.pids[m]]=c[b.pids[m]].cid}j||d.loadAdCollection(f,k,l,i)},this.initializePlacement=function(c){this.options=a.extend({},o,c),this.width=b[c.size]?b[c.size].width:0,this.height=b[c.size]?b[c.size].height:0,this.pidData={},this.adVariantData={},this.adLabel="XPlusOne";var f=this,h={};if(this.options.pid!=undefined)g.logMsg("Slot Placement - Configuring new Slot Placement for PID:",this.options.pid),this.element=a("#"+this.options.pid),this.spinnerObject=this;else{if(!(this.options.pids!=undefined&&this.options.pids.length>0))return g.logMsg("Slot Placement - [InitializePlacementError] Invalid API call - pid or pids must be passed"),!1;g.logMsg("Slot Placement - Configuring new Slot Placement for an array of PID's:",this.options.pids),this.spinnerObject=this.setParentSpinnerObject(this.options.pids[0])}this.spinner.show(this.spinnerObject);if(!this.validateInput()&&!this.options.responsive)return!1;if(this.options.isDisabled){this.spinner.hide(this.spinnerObject);return}e.subscribe("adError",function(a,b,c){f.options.pid!=undefined&&b!="adCollection"&&f.options.pids==undefined&&(f.pageId=a,f.options.failoverReason=c,g.debugMsg("Slot Placement - [adError] Event Received for PID:",f.options.pid),f.adDataFail({}))}),e.subscribe("adCollectionError",function(a,b,c){if(f.options.pids!=undefined&&f.options.pids.length>0&&b=="adCollection"&&f.options.pageId===a){f.pageId=a,f.options.failoverReason=c;var e={},h={};h.pageId=a;var i=function(a,b,c){c!=undefined&&(e.failoverAdIds=c),f.renderAdCollection(e,a)},j=function(){f.spinner.hide(f.getParentSpinnerObject())},k=function(a,b){h.failoverAdIds=b,d.loadAdCollection(a,i,j,h)};g.debugMsg("Slot Placement - [adCollectionError] Event Received for an array of placement ID's:",f.options.pids),d.getFailoverContentPaths(f.options.pageId,k,j)}}),e.subscribe("adUpdate",function(a,b,c){f.options.pid!=undefined&&c!="adCollection"&&(g.debugMsg("Slot Placement - [adUpdate] Event Received for PID:",f.options.pid),f.pageId=a,b[f.options.pid]==undefined?(f.options.failoverReason="plc_config_fail",f.adDataFail({})):b[f.options.pid].cid?(f.pidData=b[f.options.pid],f.getAd(f.pidData)):(f.pidData=b[f.options.pid],f.options.failoverTreatment==="hide"?(f.spinner.hide(f),f.element.hide()):f.adDataFail({})))}),e.subscribe("adCollectionUpdate",function(a,b,c){if(f.options.pids!=undefined&&f.options.pids.length>0&&c=="adCollection"){g.debugMsg("Slot Placement - [adCollectionUpdate] Event Received for an array of placement ID's:",f.options.pids);if(typeof f.options.pageId=="undefined"){e("adCollectionError").publish("error","","Page Id not defined"),g.logErrorMsg("Slot Placement - Ad Collection - [adError] Page Id is undefined");return}f.options.pageId==a&&f.getAdCollection(f.options,b,a)}})},this.spinner={show:function(a){if(a.options.loadingView.toLowerCase()==="placement-spinner")a.element.css({position:"relative"}),a.element.append("<div class='jpui spinner'/>");else if(a.options.loadingView.toLowerCase()==="overlay-spinner")a.element.append("<div class='jpui spinner'/>");else{if(a.options.loadingView.toLowerCase()!=="spinner")return;a.options.responsive===!0?a.element.css({background:'url("'+i+'") no-repeat scroll center center',border:"1px solid #D5DCE2",opacity:"0.75",overflow:"hidden",display:"block","min-height":"60px"}):a.element.css({background:'url("'+i+'") no-repeat scroll center center',border:"1px solid #D5DCE2",opacity:"0.75",overflow:"hidden",display:"block",width:a.width,height:a.height})}},hide:function(a){if(a.options.loadingView.toLowerCase()==="placement-spinner")a.element.removeAttr("style"),a.element.find(".jpui.spinner").remove();else if(a.options.loadingView.toLowerCase()==="overlay-spinner")a.element.find(".jpui.spinner").remove();else{if(a.options.loadingView.toLowerCase()!=="spinner")return;a.options.responsive===!0?a.element.css({background:"none",opacity:"1",border:"none",display:"block",overflow:"visible"}):a.element.css({background:"none",opacity:"1",border:"none",display:"block",width:a.width,height:a.height,overflow:"visible"})}}},this.loadImage=function(a){var b=this,c=document.createElement("img");c.border=0,c.onerror=function(){c.onload=null,clearTimeout(d),b.options.failoverReason="content_fail",b.adDataFail(a)},c.onload=function(){clearTimeout(d),c.onload=null,b.render(a,c)};var d=window.setTimeout(c.onerror,k);c.src=h+a.cid},this.getAd=function(a,b){a.ctype&&(a.ctype=a.ctype.toLowerCase());var c=this,e=!!a.url&&a.url!=="",f=!!a.turl&&a.turl!=="",h=!!a.wa_aid,i=this.adLabel==="XPlusOne";e&&f&&h&&i&&a.url.attr("href").lastIndexOf("jp_aid_a")==-1&&(a.url=this.track(a.url,"jp_aid_a",a.creativeId||a.wa_aid));if(a.queryPassForward){var j=window.location.search.substr(1),k=/^[0-9a-zA-Z,;_-]+$/,m=a.url,o=m.match(/\?/)?"&":"?";if(j!==""&&j.length>0){j=j.split("&");var p={};for(var q=0;q<j.length;q++){var r=j[q].indexOf("=");k.test(j[q].substring(0,r))&&k.test(j[q].substring(r+1,j[q].length))&&(p[j[q].substring(0,r)]=j[q].substring(r,j[q].length))}if(l!=""&&l!=undefined){var s=l.split(",");for(var q=0;q<s.length;q++)n[s[q]]!=undefined&&delete p[s[q]]}for(var r in p)m=m+o+r+p[r],o==="?"&&(o="&")}a.url=m}if(a.ctype==="image"&&this.adLabel==="XPlusOne"){this.loadImage(a);return}var t=function(){c.render(c.pidData,arguments)},u=function(){c.options.failoverReason="content_fail",c.adDataFail(arguments)};g.debugMsg("Slot Placement - Loading content with CID:",a.cid),d.loadAd(a.cid,t,u,a.url)},this.track=function(a,b,c,d){var e=a.match(/\?/)?"&":"?";return a+=e+b+"="+c,this.adLabel==="XPlusOne"&&(d=this.options.pid!=undefined?this.options.pid:d,a+="&jp_aid_p="+this.pageId+"/"+d),this[b]=c,a},this.invokeClientConfigAdFailure=function(){var a=new Array;p.adLabel!=="default"&&p.options.failoverAdUrl!=""?(p.adLabel="default",p.options.adLabel="default",a.cid=p.options.failoverAdUrl,a.turl=null,a.url=null,p.getAd(a,p.element)):(p.spinner.hide(p),p.options.failoverTreatment==="hide"&&p.element.hide())},this.adDataFail=function(b){a.when(d.getFailOverAdData(this.pageId)).then(function(c){p.failOverAdData=c,c.success&&c.result.failOverDetails!=undefined&&c.result.failOverDetails.length>0&&a.each(c.result.failOverDetails,function(a,b){b.hasOwnProperty("failoverAdUrl")&&b.failoverAdUrl!=""&&b.hasOwnProperty("failoverAdId")&&b.failoverAdId!=""&&b.hasOwnProperty("slotId")&&b.slotId==p.options.pid&&(p.options.failoverAdUrl=b.failoverAdUrl,p.options.failoverAdId=b.failoverAdId)}),p.adLabel!=="default"&&p.options.failoverAdUrl!=""?(p.adLabel="default",p.options.adLabel="default",b.cid=p.options.failoverAdUrl,b.turl=null,b.url=null,p.getAd(b,p.element)):(p.spinner.hide(p),p.options.failoverTreatment==="hide"&&p.element.hide())},function(a){p.invokeClientConfigAdFailure()})},this.renderAdCollection=function(b,c){a.each(c,function(c,d){var e={};if(b.failoverAdIds!=undefined&&Object.keys(b.failoverAdIds).length)p.options.failOverAdIds=b.failoverAdIds,e.pid=c,e.ctype="html",e.failover=!0;else if(Object.keys(b).length>0){e=b[c],e.pid=c;if(b[c].ctype==undefined||b[c].ctype=="")e.ctype="html"}var f=new Array;p.element=a("#"+c),f[0]=d,p.render(e,f)}),this.spinner.hide(p.getParentSpinnerObject()),e("adCarouselRendered").publish("success",p.pageId)},this.render=function(b,c){function w(a){return m[a]?"width="+m[a].width+", height="+m[a].height+",toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes":""}function x(b){var c=a(window),d=b.currentTarget.href,f=d.substr(d.lastIndexOf("jp_aid_p")),h=f.substr(f.lastIndexOf("/")+1);p.options.failOverAdIds!=undefined&&Object.keys(p.options.failOverAdIds).length>0?p.options.adLabel="default":p.options.adLabel=p.adLabel,e("trackAdClick").publish(h,p.options,p.adVariantData,p.pageId),g.debugMsg("Slot Placement - [trackAdClick] Event Published for PID:",h),o&&(window.open(b.currentTarget.href,"popup",q),b.preventDefault());return}var d=b.url,f=b.turl||!1,h=b.alttext||"",i=b.target&&b.target.toLowerCase()||"",k=this.adLabel=="XPlusOne";b.failover&&(k=!1);var l=b.ctype=="image"&&k,n=b.ctype=="html",o=i=="window",q=b.targetsize&&w(b.targetsize)||"",r=!!b.data,s=this.element,t=l?"append":"html",u;this.options.creativeId=b.creativeId,l?(c.setAttribute("alt",h),u=a("<a/>").attr("href",d).attr("target",i).attr("style","display:block;line-height:12px;").append(c)):u=c[0];var v=u;s[t](v),this.clickThroughMgr=function(a,b,c){if(!k&&a.attr("href")&&a.attr("href").lastIndexOf("jp_aid_a")==-1){var e="";p.options["failOverAdIds"]!=undefined?e=p.options["failOverAdIds"][b]!=undefined?p.options.failOverAdIds[b]:p.options.failoverAdId:e=p.options.failoverAdId,a.attr("href",p.track(a.attr("href"),"jp_aid_a",e,b))}k&&a.attr("href")&&n&&a.attr("href").lastIndexOf("jp_aid_a")==-1&&(a.attr("href",p.track(a.attr("href"),"jp_aid_a",c.creativeId||c.wa_aid,b)),d=a.attr("href"));var f=p.options.weblinkClickHandler;f&&typeof f=="function"&&a.on("click.slotplacement",f),a.on("click.slotplacement",x)},this.assignTrackClick=function(b,c,d){var e="";p.options.pid=b;if(c=="adCollection"){e=a("div #"+b).find("a"),p.clickThroughMgr(e,b,d);var f=document.querySelectorAll('[data-pt-id="'+b+'"]');if(f.length>0)for(j=0;j<f.length;j++)e=a(f[j]).find("a"),p.clickThroughMgr(e,b,d)}else e=p.element.find("a"),p.clickThroughMgr(e,b,d)},e.subscribe("placementComplete",function(a,c,d){d==="adCollection"?b.pid==a&&(g.debugMsg("Slot Placement - [placementComplete] Event Received for PID:",a),p.adVariantData=c,p.invokeAdImpression(a),p.assignTrackClick(a,"adCollection",b),p.options.adLabel=p.adLabel):p.options.pid!=undefined&&p.options.pids==undefined&&a===p.options.pid&&(g.debugMsg("Slot Placement - [placementComplete] Event Received for PID:",a),p.adVariantData=c,p.invokeAdImpression(a),p.assignTrackClick(a,"ad",b),p.options.adLabel=p.adLabel)}),p.options.responsive||(e("trackAdImpression").publish(p.options.pid,p.options,null,p.pageId),g.debugMsg("Slot Placement - [trackAdImpression] Event Published for PID:",p.options.pid),p.assignTrackClick(p.options.pid,"ad",b)),p.options.pid!=undefined&&this.spinner.hide(this)},this.invokeAdImpression=function(b){var c=a(window),d=a("#"+b);d&&(p.AdTracking.IsElementInViewport(d)&&(d.hasClass("adimpression")||(e("trackAdImpression").publish(b,p.options,p.adVariantData,p.pageId),g.debugMsg("Slot Placement - [trackAdImpression] Event Published for PID:",b),d.addClass("adimpression"))),d.hasClass("adimpression")||(c.on("scroll",p.AdTracking.Debounce(function(){var a=c.scrollTop();p.AdTracking.IsElementInViewport(d)&&(d.hasClass("adimpression")||(e("trackAdImpression").publish(b,p.options,p.adVariantData,p.pageId),g.debugMsg("Slot Placement - [trackAdImpression] Event Published for PID:",b),d.addClass("adimpression")))},1e3)),c.on("click",p.AdTracking.Debounce(function(){if(p.AdTracking.IsElementInViewport(d)&&!d.hasClass("adimpression")){e("trackAdImpression").publish(d.attr("id"),p.options,p.adVariantData,p.pageId),g.debugMsg("Slot Placement - [trackAdImpression] Event Published for PID:",d.attr("id")),d.addClass("adimpression");var b=document.querySelectorAll('[data-pt-id="'+d.attr("id")+'"]');if(b.length>0)for(j=0;j<b.length;j++)p.AdTracking.IsElementInViewport(a(b[j]))&&a(b[j]).addClass("adimpression")}else{var b=document.querySelectorAll('[data-pt-id="'+d.attr("id")+'"]');if(b.length>0)for(j=0;j<b.length;j++)p.AdTracking.IsElementInViewport(a(b[j]))&&!a(b[j]).hasClass("adimpression")&&(e("trackAdImpression").publish(d.attr("id"),p.options,p.adVariantData,p.pageId),g.debugMsg("Slot Placement - [trackAdImpression] Event Published for PID:",d.attr("id")),d.addClass("adimpression"),a(b[j]).addClass("adimpression"))}},1e3))))},this.initializePlacement(c)}var h=c.contentServer,i=c.loadingImagePath,k=c.timeout,l=c.excludedQueryPassforwardParams,m={small:{width:200,height:200},medium:{width:980,height:600},large:{width:1006,height:600}},n=function(a){if(a=="")return{};var b={};for(var c=0;c<a.length;++c){var d=a[c].split("=");if(d.length!=2)continue;b[d[0]]=decodeURIComponent(d[1].replace(/\+/g," "))}return b}(window.location.search.substr(1).split("&")),o={size:null,failoverTreatment:"hide",failoverAdId:"",failoverAdUrl:"",loadingView:"placement-spinner",responsive:!0};return p}),define("slotplacement/adtracking",["jquery","slotplacement/topic","slotplacement/config","slotplacement/logger"],function(a,b,c,d){function e(e,f){var g=this;this.random=Math.floor(Math.random()*9e8)+1e8,this.pagesData={},this.pagesData[e]=f,this.addPage=function(a,b){this.pagesData[a]=b},this.strictEncodeURIComponent=function(a){return encodeURIComponent(a).replace(/[!'()*]/g,escape)},this.invokePixelTag=function(a){if(document.images){var b=new Image;b.src=a}else document.write('<IMG ALT="" BORDER="0" NAME="DCSIMG" WIDTH="1" HEIGHT="1" SRC="'+a+'">')},this.createBaseTrackingPixelUrl=function(){return c.trackingPixelImagePath+"&wa_cb="+this.random},this.create_jp_aid_p=function(a,b){return a?"&jp_aid_p="+a+(b?"/"+b:""):""},this.create_jp_aid_c=function(a){return typeof a!="undefined"&&a!==""?"&jp_aid_c="+a:""},this.create_wa_ad_fi=function(a){return typeof a!="undefined"&&a!==""?"&wa_ad_fi="+a:""},this.create_wa_tp=function(){return"&wa_tp=13"},this.create_wa_uri=function(){return"&wa_uri="+this.strictEncodeURIComponent(document.location.href)},this.insightAdClick=function(a,b,c,e,f){var g=this.createBaseTrackingPixelUrl();g+="&wa_aid_lnk="+a;var h=this.create_jp_aid_p(b,c),i=this.create_jp_aid_c(e),j=this.create_wa_tp(),k=this.create_wa_uri(),l=this.create_wa_ad_fi(f);g+=h+i+j+k+l,this.invokePixelTag(g),d.debugMsg("Slot Placement - [Ad Click] Fired for PID:",c)},this.insightAdImpression=function(a,b,c,e,f){var g=this.createBaseTrackingPixelUrl();g+="&wa_aid_i="+a;var h=this.create_jp_aid_p(b,c),i=this.create_jp_aid_c(e),j=this.create_wa_tp(),k=this.create_wa_uri(),l=this.create_wa_ad_fi(f);g+=h+i+j+k+l,this.invokePixelTag(g),d.debugMsg("Slot Placement - [Ad Impression] Fired for PID:",c)},this.trackfailOverImpression=function(a,b,c,e){var f="62146166";e!=undefined&&(f=e.creativeId),window.require(["blue/event/channel/analytics"],function(d){d.emit("requestAdvertisementActionsDisplay",{placement:c,adId:f,tagMap:b,failoverReason:a})}),d.debugMsg("Slot Placement - [Failover Ad Impression] Fired for pageId:",b)},this.trackfailOverClick=function(a,b,c,e){var f="62146166";e!=undefined&&(f=e.creativeId),window.require(["blue/event/channel/analytics"],function(d){d.emit("requestAdvertisementDetails",{placement:c,adId:f,tagMap:b,failoverReason:a})}),d.debugMsg("Slot Placement - [Failover Click Impression] Fired for pageId:",b)},this.adImpression=function(b,c,d,e){typeof this.pagesData[e]!="undefined"&&(this.pidData=this.pagesData[e][b]);var f=a.extend({},c);f.adLabel==="default"||f["failOverAdIds"]!=undefined?(f["failOverAdIds"]!=undefined?g.jp_aid_a=f["failOverAdIds"][b]!=undefined?f.failOverAdIds[b]:f.failoverAdId:g.jp_aid_a=f.failoverAdId,g.jp_aid_a&&this.insightAdImpression(g.jp_aid_a,e,b,d,f.failoverReason)):typeof this.pidData!="undefined"&&(g.jp_aid_a=this.pidData.creativeId||this.pidData.wa_aid,g.jp_aid_a&&this.insightAdImpression(this.pidData.creativeId||g.jp_aid_a,e,b,d))},this.trackClick=function(b,d,e,f){var g=a.extend({},d);g.adLabel||(g.adLabel="XPlusOne");var h=a(window),i=window.document,j=typeof this.pagesData[f]!="undefined"?this.pagesData[f][b]:{},k="";g.adLabel==="default"&&(j={},j.cid=g.failoverAdUrl,j.turl=null,j.url=null),g.failOverAdIds!=undefined&&g.failOverAdIds[b]!=undefined?k=g.failOverAdIds[b]:k=g.failoverAdId;if(typeof j!="undefined"){var l=j.turl||!1,m=g.adLabel=="XPlusOne",n=m?j.creativeId?j.creativeId:j.wa_aid:k;if(l){var o=i.createElement("img");o.src=j.turl}c.adTrackingDisabled!=="true"&&c.adTrackingDisabled!==!0&&(window.Blue&&window.Blue.version?window.require(["blue/event/channel/analytics"],function(a){a.emit("requestAdvertisementDetails",{placement:b,adId:d.creativeId,location:d.location,variations:e,tagMap:f})}):this.insightAdClick(n,f,b,e,g.failoverReason))}},this.trackOriginImpression=function(a,b,d){typeof this.pagesData[d]!="undefined"&&(this.pidData=this.pagesData[d][a]);if(typeof this.pidData!="undefined"){var e=RegExp("[?&]_xt=([^&]*)").exec(this.pidData.turl);e=e&&decodeURIComponent(e[1].replace(/\+/g," "));var f=RegExp("[?&]ssv_random=([^&]*)").exec(this.pidData.turl);f=f&&decodeURIComponent(f[1].replace(/\+/g," "));var g="?_o="+c.XPOOrgID,h="&_t="+c.viewableImpressionTag,i=typeof e!="undefined"&&e!==""?"&ssv_transid="+e:"",j=typeof f!="undefined"&&f!==""?"&ssv_random="+f:"",k="&ssv_placement="+d+"/"+a,l=b.adLabel==="default"?"&ssv_creativeid="+b.failoverAdId:"&ssv_creativeid="+this.pidData.creativeId,m=c.activityTagURL+g+h+i+j+k+l;if(document.images){var n=new Image;n.src=m}else document.write('<IMG ALT="" BORDER="0" NAME="DCSIMG" WIDTH="1" HEIGHT="1" SRC="'+m+'">')}},this.trackAdVariation=function(a,b,d,e){typeof this.pagesData[e]!="undefined"&&(this.pidData=this.pagesData[e][a]);if(typeof this.pidData!="undefined"&&b.adLabel!=="default"&&typeof d!="undefined"&&d!==""){var f=RegExp("[?&]_xt=([^&]*)").exec(this.pidData.turl);f=f&&decodeURIComponent(f[1].replace(/\+/g," "));var g=RegExp("[?&]ssv_random=([^&]*)").exec(this.pidData.turl);g=g&&decodeURIComponent(g[1].replace(/\+/g," "));if(f){var h="?_o="+c.XPOOrgID,i="&_t="+c.variationActivityTag,j="&ssv_transid="+f,g="&ssv_random="+g,k="&ssv_adcontext="+d,l="&ssv_placement="+e+"/"+a,m=c.activityTagURL+h+i+j+g+k+l;if(document.images){var n=new Image;n.src=m}else document.write('<IMG ALT="" BORDER="0" NAME="DCSIMG" WIDTH="1" HEIGHT="1" SRC="'+m+'">')}}},c.adTrackingDisabled!=="true"&&c.adTrackingDisabled!==!0&&b.subscribe("trackAdImpression",function(a,b,c,d){window.Blue&&window.Blue.version?(typeof g.pagesData[d]!="undefined"&&(g.pidData=g.pagesData[d][a]),typeof g.pidData!="undefined"&&window.require(["blue/event/channel/analytics"],function(e){e.emit("requestAdvertisementActionsDisplay",{placement:a,adId:b.creativeId,location:b.location,variations:c,tagMap:d})})):g.adImpression(a,b,c,d),g.pagesData[d]!==undefined&&g.trackOriginImpression(a,b,d)}),b.subscribe("trackAdClick",function(a,b,c,d){g.pagesData[d]!==undefined&&g.trackClick(a,b,c,d)}),b.subscribe("trackAdVariation",function(a,b,c,d){}),b.subscribe("trackfailOverImpression",function(a,b,c,d){g.trackfailOverImpression(a,b,c,d)}),b.subscribe("trackfailOverClick",function(a,b,c,d){g.trackfailOverClick(a,b,c,d)})}return e})
