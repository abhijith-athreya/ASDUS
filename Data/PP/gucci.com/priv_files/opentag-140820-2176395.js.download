/*
 * Opentag, a tag deployment platform
 * Copyright 2011-2016, Qubit Group
 * http://opentag.qubitproducts.com
 */
(function(){var L=function(){return this}();L.qubit=L.qubit||{};L.qubit.SYSTEM_DEFAULTS={pingServerUrl:"opentag-stats.qubit.com/ping",tellLoadTimesProbability:1}})();(function(){var L={"id":"140820"};try{var H=function(){return this}();if(!H.qubit)H.qubit={};var N=H.qubit;if(!N.cs)N.cs={};N.CLIENT_CONFIG=L;var Q=L.id||"efault";Q="d"+Q;if(!N.cs[Q])N.cs[Q]={};N.cs[Q].ClientConfig=L;if(N.SYSTEM_DEFAULTS)N.cs[Q].SystemDefaults=N.SYSTEM_DEFAULTS}catch(O){}})();
(function(){(function(){function L(){function a(c,v){v=e(v||{});v.meta=v.meta||{};v.meta.type=c;k.push(v);if(k.length===1)q(k[0]);r.listeners=g(r.listeners,function(t){return!t.disposed})}function q(c){r.events.push(c);f(r.listeners,function(v){if(v.disposed)return;if(!l(v.type,c.meta.type))return;try{v.callback.call(v.context,c)}catch(t){if(console&&console.error)console.error("Error emitting UV event",t.stack)}});k.shift();if(k.length>0)q(k[0])}function n(c,v,t){function y(){f(r.events,function(x){if(p.disposed)return;
if(!l(c,x.meta.type))return;v.call(t,x)});return u}function B(){p.disposed=true;return u}var p={type:c,callback:v,disposed:false,context:t||window};r.listeners.push(p);var u={replay:y,dispose:B};return u}function w(c,v,t){var y=r.on(c,function(){v.apply(t||window,arguments);y.dispose()});return y}function f(c,v){var t=c.length;for(var y=0;y<t;y++)v(c[y],y)}function e(c){var v={};for(var t in c)if(c.hasOwnProperty(t))v[t]=c[t];return v}function l(c,v){return typeof c==="string"?c===v:c.test(v)}function g(c,
v){var t=c.length;var y=[];for(var B=0;B<t;B++)if(v(c[B]))y.push(c[B]);return y}var k=[];var r={emit:a,on:n,once:w,events:[],listeners:[]};return r}function H(){return ia.uv}function N(){var a=H();if(!a||!a.emit)return false;if(!da){da=true;for(var q=0;q<X.length;q++){var n=X[q];if(n.on)a.on.apply(a,n.on);else if(n.emit)a.emit.apply(a,n.emit)}a.on(/.*/,function(w){var f=w.meta.type;var e=Y[f];if(!e)Y[f]={current:w,history:[w]};else{e.current=w;e.history.push(w)}}).replay();Z=true}return true}(function(){if(!Function.prototype.bind)Function.prototype.bind=
function(a){if(typeof this!=="function")throw new TypeError("Function.prototype.bind - what is trying "+"to be bound is not callable");var q=Array.prototype.slice.call(arguments,1);var n=this;var w=function(){};var f=function(){return n.apply(this instanceof w?this:a,q.concat(Array.prototype.slice.call(arguments)))};w.prototype=this.prototype;f.prototype=new w;return f}})();var Q={__anonymous__:true};var O=null;try{O=(false||eval)("this")}catch(a){}if(!O)try{var ja=function(){return this};O=ja()}catch(a){}Q=
O;var A=Q.qubit||{};if(!Q.qubit)Q.qubit=A;var ea="3.1.1-r1";if(A.VERSION&&A.VERSION!==ea)try{console.warn("There is already 'qubit.VERSION' set to: "+A.VERSION)}catch(a){}A.VERSION=ea;try{if(typeof module==="object")module.exports=Q}catch(a){}var M=function(){};var fa;(function(){function a(){}function q(f,e,l,g,k){var r=f.split(".");var c=a.NAMESPACE_BASE||Q;var v=null;var t=null;var y;if(k)c=O;var B=c;c=l||c;for(y=0;y<r.length-1;y+=1){v=c;t=r[y];c[t]=c[t]||{};c=c[t]}v=c;t=r[r.length-1];if(O.TAGSDK_NS_OVERRIDE)g=
false;if(O.TAGSDK_NS_FORCED_OVERRIDE_OPTION!==undefined)g=!O.TAGSDK_NS_FORCED_OVERRIDE_OPTION;if(e!==undefined){if(v[t]===undefined||!g)v[t]=e}else v[t]=v[t]||{};if(e){e.CLASSPATH=r.join(".");r.splice(r.length-1,1);e.PACKAGE_NAME=r.join(".")}return{root:B,object:v,instance:v[t]}}a.global=function(){return O};a.STANDARD_CS_NS="qubit.cs";a.clientSpaceClasspath=function(){if(window.qubit.CLIENT_CONFIG)return"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id;return a.STANDARD_CS_NS};a.globalNamespace=function(f,
e,l,g){return q(f,e,l,g,true)};a.namespace=function(f,e,l,g){return q(f,e,l,g,false)};a.clientNamespace=function(f,e,l,g){return a.namespace(a.clientSpaceClasspath()+"."+f,e,l,g)};a.clazz=function(f,e,l,g,k){a.namespace(f,e,g,true);if(typeof l==="function"){e.SUPER=l;e.superclass=l;e.prototype=new l(k);e.prototype.SUPER=l;e.prototype.CLASS=e}var r=f.split(".");if(e.prototype){e.prototype.CLASSPATH=r.join(".");e.prototype.CLASS_NAME=r[r.length-1];r.splice(r.length-1,1);e.prototype.PACKAGE_NAME=r.join(".")}else{e.CLASSPATH=
r.join(".");e.STATIC_NAME=r[r.length-1];r.splice(r.length-1,1);e.PACKAGE_NAME=r.join(".")}return e};a.clazz("qubit.Define",a);a.clientClazz=function(f,e,l,g,k){return a.clazz(a.clientSpaceClasspath()+"."+f,e,l,g,k)};a.STANDARD_VS_NS="qubit.vs";a.vendorsSpaceClasspath=function(f){var e=A.VENDOR_SPACE_CP;var l=e===undefined||e===null?a.STANDARD_VS_NS:e;if(f)if(l)return l+"."+f;else return f;return l};var n=a.vendorsSpaceClasspath();var w;if(n)w=a.namespace(n,{},null,true).instance;else w=a.global();
a.getVendorSpace=function(){return w};a.vendorNamespace=function(f,e,l,g){f=a.vendorsSpaceClasspath(f);return a.namespace(f,e,l,g)};a.vendorClazz=function(f,e,l,g,k){f=a.vendorsSpaceClasspath(f);return a.clazz(f,e,l,g,k)}})();(function(){function a(f){}var q="abcdefghijklmnopqrstuvwxyz"+"0123456789"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"*!-#$\x26+()@"+"'%./:\x3c\x3e?["+'"]^_`{|}~'+"\\"+";\x3d";var n={};for(var w=0;w<q.length;w++)n[q.charAt(w)]=w;A.Define.clazz("qubit.Cookie",a);a.cookieAlphabet=q;a.cookieAlphabetMap=
n;a.decode=function(f){return unescape(f)};a.encode=function(f){return escape(f)};a.set=function(f,e,l,g,k){var r;if(l){var c=new Date;c.setTime(c.getTime()+l*24*60*60*1E3);r="; expires\x3d"+c.toGMTString()}else r="";if(!k){f=a.encode(f);e=a.encode(e)}var v=f+"\x3d"+e+r+"; path\x3d/;";if(g)v+=" domain\x3d"+g;document.cookie=v};a.get=function(f,e){var l=f+"\x3d";var g=document.cookie.split(";");for(var k=0;k<g.length;k++){for(var r=g[k];r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(l)===
0){var c=r.substring(l.length,r.length);if(!e)c=a.decode(c);return c}}return null};a.getAllForName=function(f,e){if(!f)return[];var l=f+"\x3d";var g=document.cookie.split(";");var k=[];for(var r=0;r<g.length;r++){for(var c=g[r];c.charAt(0)===" ";)c=c.substring(1,c.length);if(c.indexOf(l)===0){var v=c.substring(l.length,c.length);if(e)v=a.decode(v);k.push(v)}}return k};a.getAll=function(f){var e=document.cookie.split(";");var l=[];for(var g=0;g<e.length;g++){for(var k=e[g];k.charAt(0)===" ";)k=k.substring(1,
k.length);var r=k.substring(0,k.indexOf("\x3d"));var c=k.substring(r.length+1,k.length);if(f)c=a.decode(c);l.push([r,c])}return l};a.rm=function(f,e){a.set(f,"",-1,e)}})();(function(){function a(b){return k.addToArrayIfNotExist(k.ANON_VARS,b)}function q(b){return b.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function n(b,h){var m=c.length;for(var z=0;z<m;z++)if(b===c[z][0])return c[z][1];c[c.length]=[b,h];return false}function w(b,h,m,z,C){var D=false;var E=false;var F=false;var I=false;var J=false;
var R=false;var S=false;if(h){J=!!h.all;D=J||h.nodes;I=J||h.win;E=J;S=!!h.emptyForMaxDeep;F=h.noFunctions&&!J;if(h.noOwn!==undefined)E=!!h.noOwn;if(h.noFunctions!==undefined)F=!!h.noFunctions;if(h.win!==undefined)I=!!h.win;if(h.nodes!==undefined)D=!!h.nodes;R=!!h.copyReference}if(m!==undefined&&!m){if(S)return;return b}else if(m!==undefined)m--;if(!b||!(b instanceof Object))return b;if(!D){try{if(b instanceof Node)return b}catch(aa){if(b instanceof ActiveXObject&&b.nodeType!==undefined)return b}if(b===
document)return b}if(!I)if(b===r)return b;var K=b instanceof Array?[]:{};if(b instanceof Date)K=new Date(b);if(!F&&b instanceof Function){var V=String(b).replace(/\s+/g,"");if(V.indexOf("{[nativecode]}")+14===V.length)K=function(){return b.apply(C||this,arguments)};else K=function(){return b.apply(this,arguments)}}if(z===undefined){c=[];z=0}var W=n(b,K);if(W)return W;var T;if(K instanceof Array)for(T=0;T<b.length;T++)if(b[T]===b[T])K[K.length]=w(b[T],h,m,z+1,b);else K[K.length]=b[T];else{T=0;for(var U in b){if(E||
b.hasOwnProperty(U))if(b[U]===b[U])K[U]=w(b[U],h,m,z+1,b);else K[U]=b[U];T++}}if(h.proto)K.prototype=w(b.prototype,h,m,z+1,b);if(R)K.___copy_ref=b;return K}function f(b,h){for(var m=0;m<h&&m<v.length;m++)if(b===v[m])return true;return false}function e(b,h,m,z,C,D,E,F){m=m||{};if(m.hasOwn===undefined)m.hasOwn=true;if(m.objectsOnly&&!(b instanceof Object))return;if(F!==undefined&&!F)return;else if(F!==undefined)F--;if(!m||!m.nodes)try{if(b instanceof Node)return}catch(V){if(b instanceof ActiveXObject&&
b.nodeType!==undefined)return}if(b===r)return;if(z===undefined){v=[];z=0}if(f(b,z))return;v[z]=b;C=C||b;if(C&&D&&C[D]!==C[D])return;var I=h(b,C,D,E);if(I)return;var J=0;var R="";for(var S in b){if(!m.hasOwn||b.hasOwnProperty(S))try{var K=b[S];if(m.track)R=E?E+"."+S:S;e(K,h,m,z+1,C,S,R,F)}catch(V){}J++}}var l=A.Define;var g=A.Cookie;var k=function(){};var r=l.global();l.clazz("qubit.opentag.Utils",k);k.global=l.global;k.namespace=l.namespace;k.clazz=l.clazz;k.getObjectUsingPath=function(b,h){h=h||
r;var m=b.split(".");for(var z=0;z<m.length;z++)if(h&&m[z])h=h[m[z]];return h};k.getParentObject=function(b){var h=b.lastIndexOf(".");var m=b.substring(0,h);return k.getObjectUsingPath(m)};k.variableExists=function(b){return b!==undefined&&b!==null};k.ANON_VARS=[];k.getAnonymousAcessor=function(b){var h=k.indexInArray(b,k.ANON_VARS);if(h===-1)h=a(b);return"qubit.opentag.Utils.ANON_VARS["+h+"]"};k.replaceAll=function(b,h,m){return b.replace(new RegExp(q(h),"g"),m)};k.secureText=function(b){if(typeof b!==
"string")b+="";b=b.replace(/</g,"\x26lt;");b=b.replace(/>/g,"\x26gt;");return b};k.getUrl=function(){return document.location.href};k.getQueryParam=function(b){var h;var m;var z;var C;var D;var E;var F;C=k.getUrl();if(C.indexOf("?")>0){E=C.substring(C.indexOf("?")+1).split("\x26");for(h=0,m=E.length;h<m;h+=1){D=E[h];if(D.indexOf("\x3d")>0){F=D.split("\x3d");if(F.length===2&&F[0]===b)return F[1]}}}return null};k.getElementValue=function(b){var h=document.getElementById(b);if(h)return h.textContent||
h.innerText;return null};var c=[];k.objectCopy=function(b,h){h=h||{};var m=w(b,h,h.maxDeep);c=[];return m};var v=[];k.traverse=function(b,h,m){var z;e(b,h,m,z,z,z,z,m.maxDeep)};k.prepareQuotedString=function(b){if(typeof b==="string")return'"'+b.replace(/\"/g,'\\"')+'"';else return b};k.expressionToFunction=function(b,h){h=h||"";var m="function ("+h+") {"+b+"}";return k.gevalAndReturn(m).result};k.defineWrappedClass=function(b,h,m,z,C){var D=function(){if(C)return C.apply(this,arguments);else return h.apply(this,
arguments)};l.clazz(b,D,h,z);for(var E in m)if(m.hasOwnProperty(E)&&E!=="CONSTRUCTOR")D.prototype[E]=m[E];return D};k.copyAandAddFromB=function(b,h,m){m=m||8;var z=this.objectCopy(b,{maxDeep:m});for(var C in h)if(h.hasOwnProperty(C))z[C]=h[C];return z};k.keys=function(b){if(b instanceof Object){if(Object.keys)return Object.keys(b);var h=[];for(var m in b)if(b.hasOwnProperty(m))h[h.length]=m;return h}else throw"keys() called on non-object!";};k.getSrcElement=function(b){var h;b=b||window.event;if(b.srcElement)h=
b.srcElement;else if(b.target)h=b.target;return h};k.addToArrayIfNotExist=function(b,h,m){var z=0;for(var C=false;z<b.length;z+=1){var D=m&&m(b[z],h);if(D||b[z]===h){C=true;break}}if(!C){b[b.length]=h;z=-1}return z};k.indexInArray=function(b,h){var m=0;for(var z=false;m<b.length;m++)if(b[m]===h){z=true;break}return z?m:-1};k.removeFromArray=function(b,h){var m=0;for(var z=0;m<b.length;)if(b[m]===h){b.splice(m,1);z++}else m++;return z};k.addClass=function(b,h){var m;try{b.classList.add(h)}catch(z){if(b.className===
null){b.className=h;return}m=b.className.split(" ");k.addToArrayIfNotExist(m,h);b.className=m.join(" ")}};k.removeClass=function(b,h){var m;try{b.classList.remove(h)}catch(z){if(b.className===null){b.className="";return}m=b.className.split(" ");k.removeFromArray(m,h);b.className=m.join(" ")}};var t="try{this.qubitopentagutilsgevalandreturn__var_test__\x3d(";var y=");}catch(ex){"+"this.qubitopentagutilsgevalandreturn__var_test__error \x3d ex;}";k.gevalAndReturn=function(b){var h=O;h.qubitopentagutilsgevalandreturn__var_test__=
undefined;h.qubitopentagutilsgevalandreturn__var_test__error=undefined;b=t+b+y;k.geval(b);var m=h.qubitopentagutilsgevalandreturn__var_test__;var z=h.qubitopentagutilsgevalandreturn__var_test__error;try{h.qubitopentagutilsgevalandreturn__var_test__=fa;h.qubitopentagutilsgevalandreturn__var_test__error=fa;delete h.qubitopentagutilsgevalandreturn__var_test__;delete h.qubitopentagutilsgevalandreturn__var_test__error}catch(C){}return{result:m,error:z}};k.trim=function(b){try{return String(b).trim()}catch(h){return String(b).replace(/^\s+|\s+$/g,
"")}};k.setIfUnset=function(b,h){if(b&&h)for(var m in h)if(h.hasOwnProperty(m)&&!b.hasOwnProperty(m))b[m]=h[m]};k.overrideFromLeftToRight=function(b,h){if(b&&h)for(var m in h)if(h.hasOwnProperty(m))b[m]=h[m];return b};k.geval=function(b){if(window&&window.execScript)return window.execScript(b===""?" ":b);else return function(){return r["eval"].call(r,b)}()};var B=[];k.bodyAvailable=function(b){var h=!!document.body;if(h){if(B){for(var m=0;m<B.length;m++)try{B[m]()}catch(z){}B=false}b()}else B.push(b)};
k.rmCookiesMatching=function(b){var h=g.getAll();for(var m=0;m<h.length;m++){var z=h[m][0];if(z.match(b)===0)g.rm(z)}};var p=[];var u=false;var x=false;k.bodyReady=function(b){if(x){if(b)b();return true}u=u||!!(document.body&&document.readyState==="complete");if(u){x=true;for(var h=0;h<p.length;h++)try{p[h]()}catch(m){}if(b)b()}else if(b)p.push(b);return u};var d=r.onload;r.onload=function(b){try{k.bodyReady()}catch(m){try{window.qubit.opentag.Utils.bodyReady()}catch(z){}}var h=false;try{h=d}catch(m){}if(h)h(b)};
(function(){var b;var h=false;var m=1;var z;var C;var D;var E;C=function(I){var J;if(I===true)m-=1;if(!m||I!==true&&!h){if(!document.body)return setTimeout(C,1);h=true;if(I!==true){m-=1;if(m>0)return}for(;z.length>0;){J=z.shift();J()}}};E=function(){if(h)return;try{document.documentElement.doScroll("left")}catch(I){setTimeout(E,1);return}C()};D=function(){if(z)return;z=[];if(document.readyState==="complete")return setTimeout(C,1);if(document.addEventListener){document.addEventListener("DOMContentLoaded",
b,false);window.addEventListener("load",C,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",b);window.attachEvent("onload",C);var I=false;try{I=window.frameElement===null||window.frameElement===undefined}catch(J){}if(document.documentElement.doScroll&&I)E()}};var F=function(I){D();if(h)setTimeout(I,1);else z.push(I)};if(document.addEventListener)b=function(){document.removeEventListener("DOMContentLoaded",b,false);C()};else if(document.attachEvent)b=function(){if(document.readyState===
"complete"){document.detachEvent("onreadystatechange",b);C()}};F(function(){u=true;k.bodyReady()})})()})();(function(){function a(t,y,B){this.collectLogs=!!a.isCollecting();this.collectLocally=B;this.collection=[];this.getPrefix=function(){var p="";if(y){if(typeof y==="function")p=y(this.ref);else if(y.CLASS_NAME)p=y.CLASS_NAME;else if(y.constructor&&y.constructor.name)p=y.constructor.name;if(p)p+=" -\x3e "}return(t||"")+p}}function q(t,y,B,p,u,x,d,b){var h;var m=f>=b;if(a.getCollectLevel()>=0||m){if(u)h=
[p,d,B];else h=[y+t.getPrefix()+p,x,B];h[3]=b;t.collect(h,b);if(m)t.printMessage.apply(t,h)}}var n=A.Define;var w=null;n.clazz("qubit.opentag.Log",a);a.LEVEL_FINEST=4;a.LEVEL_FINE=3;a.LEVEL_INFO=2;a.LEVEL_WARN=1;a.LEVEL_ERROR=0;a.LEVEL_NONE=-1;a.MAX_LOG_LEN=1E4;a.prototype.MAX_LOG_LEN=-1;var f=a.LEVEL_NONE;var e=a.LEVEL_NONE;var l=true;a.setLevelFromCookie=function(){var t=A.Cookie.get("qubit.opentag.Log.LEVEL");if(t){t=+t;if(!isNaN(t))if(t>0){var y=a.LEVEL_FINE;a.setCollectLevel(t>y?t:y);a.setLevel(+t)}}};
a.setCollecting=function(t){l=!!t};a.isCollecting=function(){return l||a.COLLECT};a.setLevel=function(t){f=+t};a.setCollectAndLevel=function(t){a.setLevel(t);a.setCollectLevel(t)};a.getLevel=function(){return f};a.setCollectLevel=function(t){e=+t};a.getCollectLevel=function(){return e};var g=[];a.logsCollection=g;a.rePrintAll=function(t,y,B,p){var u=f;if(t!==undefined)f=t;try{if(a.isCollecting()){try{if(!B)w.clear()}catch(h){}var x=p||a.logsCollection;var d=0;for(var b=0;b<x.length;b++)(function(h){var m=
x[h];var z=m[3];if(z!==undefined&&f>=z){d++;if(!y)a.print.apply(a,m);else A.opentag.Timed.setTimeout(function(){if(t!==undefined)f=t;try{a.print.apply(a,m)}finally{f=u}},d*y)}})(b)}}catch(h){}finally{f=u}};var k=n.global();var r=!!(k.webkitMediaStream||k.webkitURL||k.mozContact);a.isStyleSupported=function(){return r};var c={};a.setConsole=function(t){w=t||c;return w};a.delayPrint=-1;var v=(new Date).valueOf();a.prototype.printMessage=function(t,y,B,p){if(a.delayPrint>0){var u=a.delayPrint;var x=
v-(new Date).valueOf();if(x>0)u+=x;try{A.opentag.Timed.setTimeout(function(){this.print(t,y,B,p)}.bind(this),u)}catch(d){setTimeout(function(){this.print(t,y,B,p)}.bind(this),u)}v=(new Date).valueOf()+u}else this.print(t,y,B,p)};a.prototype.print=function(t,y,B,p){a.print(t,y,B,p)};a.print=function(t,y,B,p){if(p!==undefined&&f<p)return;try{if(w&&w.log)if(y&&a.isStyleSupported())if(B&&w[B])w[B]("%c"+t,y);else w.log("%c"+t,y);else if(B&&w[B])w[B](t);else w.log(t)}catch(u){}};a.prototype.collect=function(t,
y){if(y===undefined)y=a.getCollectLevel();var B=false;var p=this.collectLogs&&a.isCollecting()&&a.getCollectLevel()>=+y;if(p){g.push(t);B=true}if(this.collectLocally&&p){this.collection.push(t);B=true}if(a.MAX_LOG_LEN>0)if(g.length>a.MAX_LOG_LEN)g.splice(0,g.length-a.MAX_LOG_LEN);if(a.MAX_LOG_LEN>0||this.MAX_LOG_LEN>0){var u=a.MAX_LOG_LEN;if(this.MAX_LOG_LEN>0)u=this.MAX_LOG_LEN;if(this.collection.length>u)this.collection.splice(0,this.collection.length-u)}return B?t:null};a.clearAllLogs=function(){try{w.clear()}catch(t){}finally{g.splice(0,
g.length)}};a.getCollectedByLevel=function(t,y){y=y||g;var B=[];for(var p=0;p<y.length;p++){var u=y[p];var x=u[0];var d=x[4];if(d===t)B.push(u)}return B};a.prototype.rePrint=function(t,y,B){a.rePrintAll(t,y,!B,this.collection)};a.prototype.FINEST=function(t,y){q(this,"FINEST: ",false,t,y,"color:#CCCCCC;",false,a.LEVEL_FINEST)};a.prototype.FINE=function(t,y){q(this,"FINE: ",false,t,y,"color:#999999;",false,a.LEVEL_FINE)};a.prototype.INFO=function(t,y,B){q(this,"INFO: ","info",t,y,B,B,a.LEVEL_INFO)};
a.prototype.WARN=function(t,y){q(this,"WARN: ","warn",t,y,"color:#26A110;",false,a.LEVEL_WARN)};a.prototype.ERROR=function(t,y){q(this,"ERROR: ","error",t,y,"color:red;",false,a.LEVEL_ERROR)};a.setConsole(n.global().console);a.setLevelFromCookie()})();(function(){function a(n){if(n){this._rate=n.rate||10;this._smallestRate=-1;if(n.start)this.startPooling();this.config=n}this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}A.Define.clazz("qubit.opentag.Timer",a);a.prototype.timers=
[];a.prototype.startPooling=function(n){if(n&&this.config.dynamic)if(this._smallestRate<0||this._smallestRate>n)this._smallestRate=Math.min(Math.floor(n/2),1500);if(!this.started){this.started=true;setTimeout(this._binded_pool,0)}};a.prototype._pool=function(){this.maxFrequent(function(){var w="";if(this.config&&this.config.name)w="["+this.config.name+"]"},5E3,this._lck_obj);this.callTimers();if(this.timers.length!==0){var n=this._smallestRate>this._rate?this._smallestRate:this._rate;setTimeout(this._binded_pool,
n)}else{this.started=false;this._smallestRate=-1}};a.prototype.callTimers=function(){this.lastCalled=(new Date).valueOf();for(var n=0;n<this.timers.length;n++){var w=this.timers[n];var f=(new Date).valueOf();if(f>=w.time){try{w.execute()}catch(e){}this.timers.splice(n,1);--n}}};a.prototype.cancellAll=function(){this.timers=[]};a.prototype.setRate=function(n){this._rate=n};a.prototype.maxFrequent=function(n,w,f){if(!f){n.__maxFrequent__timer_opentag_qubit_=n.__maxFrequent__timer_opentag_qubit_||{};
f=n.__maxFrequent__timer_opentag_qubit_}var e=f.____last__timed__max__frequent____;if(!e||(new Date).valueOf()-e>w){e=(new Date).valueOf();f.____last__timed__max__frequent____=e;n()}};a.prototype.runIfNotScheduled=function(n,w,f){f=f||n;if(f.__lastRun__&&(new Date).valueOf()<w+f.__lastRun__)return this.schedule(n,w,f);else{f.__lastRun__=(new Date).valueOf();n();return true}};a.prototype.schedule=function(n,w,f){if(f.___scheduled___)return false;else{f.___scheduled___=(new Date).valueOf();this.setTimeout(function(){f.___scheduled___=
false;f.__lastRun__=(new Date).valueOf();n()},w);return true}};var q=1;a.prototype.setTimeout=function(n,w){var f={id:q++,time:(new Date).valueOf()+ +w,execute:n};this.timers.push(f);this.startPooling(w);return f};a.prototype.setInterval=function(n,w){var f=setInterval(n,w);this.inervals.push(f);return f}})();(function(){A.Define.namespace("qubit.opentag.Timed",new A.opentag.Timer({rate:37,dynamic:true}));var a=A.opentag.Timed;a.tillTrue=function(q,n,w){var f=function(){if(!q())a.setTimeout(f,w||
33);else n()};f()}})();var G={};G.html=G.html||{};G.html.fileLoader={};G.html.fileLoader.load=function(a,q,n,w,f,e){var l;var g;var k;var r;var c;c=false;r=function(v){return function(){if(!c){c=true;if(v&&!k)k={url:document.location.href};n(a,k,v)}}};try{if(q)g=q(a)}catch(v){g=false;n(a,"Exception loading pre",true)}finally{if(g!==false){l=G.html.fileLoader.createScriptEl(a,f,false,e);if(n){l.onload=r(false);l.onerror=r(true);l.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState===
"loaded")setTimeout(function(){r(false)()},1)}}if(!w)w=window.document.getElementsByTagName("head")[0];w.appendChild(l)}}};G.html.fileLoader.createScriptEl=function(a,q,n,w){var f;var e=document.createElement("script");e.type="text/javascript";e.src=G.html.fileLoader.tidyUrl(a)+(n?"?"+(new Date).getTime():"");if(q!==false){e.async="true";e.defer="true"}else{e.async="false";if(e.async!==false)e.async=false;e.defer="false";if(e.defer!==false)e.defer=false}for(f in w)if(w.hasOwnProperty(f))e.setAttribute(f,
w[f]);return e};G.html.fileLoader.tidyUrl=function(a){if(a.substring(0,5)==="http:")return a;if(a.substring(0,6)==="https:")return a;return"//"+a};(function(){function a(f){this.log=new A.opentag.Log("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.config={order:0,include:true,name:"Filter-"+n++,script:undefined,session:undefined};this.session=null;if(f){for(var e in f)if(f.hasOwnProperty(e))this.config[e]=f[e];if(f.session)this.setSession(f.session);this.register(this)}}
var q=A.opentag.Utils;var n=0;var w=[];A.Define.clazz("qubit.opentag.filter.BaseFilter",a);a.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};a.prototype.reset=function(){this.enable()};a.prototype.disable=function(){this.config.disabled=true};a.prototype.enable=function(){this.config.disabled=false};a.prototype.match=function(){return true};a.prototype.setSession=function(f){this.session=f};a.prototype.getSession=function(){return this.session};a.prototype.getState=function(){var f=a.state.PASS;if(this.config.disabled)return a.state.DISABLED;
if(this.config.script)f=this.config.script.call(this,f);if(isNaN(+f))f=a.state.FAIL;this.lastState=+f;return f};a.getFilters=function(){return w};a.prototype.register=function(){a.register(this)};a.register=function(f){q.addToArrayIfNotExist(w,f)}})();(function(){var a=A.Define;var q={CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"};a.namespace("qubit.opentag.filter.pattern.PatternType",
q)})();(function(){function a(e){this._lockObject={};var l={patternType:f.CONTAINS,pattern:""};if(e)for(var g in e)if(e.hasOwnProperty(g))l[g]=e[g];a.SUPER.call(this,l)}var q=A.opentag.Utils;var n=A.opentag.filter.BaseFilter;var w=A.opentag.Timed;var f=A.opentag.filter.pattern.PatternType;A.Define.clazz("qubit.opentag.filter.URLFilter",a,n);a.prototype.PATTERNS=f;a.prototype.getURL=function(e){return e||q.getUrl()};a.prototype.match=function(e){e=this.getURL(e);var l=true;var g=this.config.pattern;
switch(this.config.patternType){case f.CONTAINS:l=e.toLowerCase().indexOf(g.toLowerCase())>=0;break;case f.MATCHES_EXACTLY:l=e.toLowerCase()===this.config.pattern.toLowerCase();break;case f.STARTS_WITH:l=e.toLowerCase().indexOf(g.toLowerCase())===0;break;case f.ENDS_WITH:l=e.lastIndexOf(g.toLowerCase())+g.length===e.length;break;case f.REGULAR_EXPRESSION:l=(new RegExp(g)).test(e);break;case f.ALL_URLS:l=true;break}return l}})();(function(){function a(e){var l={};if(e){for(var g in e)if(e.hasOwnProperty(g)){if(g===
"customStarter"&&e[g])this.customStarter=e[g];else if(g==="customScript"&&e[g])this.customScript=e[g];l[g]=e[g]}this.uid="f"+f++}this.tagsToRun=[];a.SUPER.call(this,l)}var q=A.opentag.filter.BaseFilter;var n=A.opentag.filter.URLFilter;var w=A.opentag.Utils;var f=0;A.Define.clazz("qubit.opentag.filter.Filter",a,n);a.prototype.customStarter=function(e,l,g){l(false)};a.prototype.isSession=function(){if(this.config.sessionDisabled)return false;if(this.customStarter===null&&this.customScript===null)return false;
return true};a.prototype.customScript=function(e){return true};a.prototype.match=function(e){var l=true;try{if(this.customScript){if(this._matchState===undefined)this._matchState=!!this.customScript(this.getSession());l=this._matchState}}catch(g){l=false}return l&&a.SUPER.prototype.match.call(this,e)};a.prototype.runTag=function(e){w.addToArrayIfNotExist(this.tagsToRun,e);if(!this.starterExecuted){if(!this._starterWasRun){this._starterWasRun=true;var l=function(g){this.reRun=g;this.starterExecuted=
(new Date).valueOf();this._processQueuedTagsToRun()}.bind(this);if(this.customStarter)this.customStarter(this.getSession(),l,e);else a.prototype.customStarter.call(this,this.getSession(),l,e)}}else this._triggerTag(e)};a.prototype._processQueuedTagsToRun=function(){for(var e=0;e<this.tagsToRun.length;e++){var l=this.tagsToRun[e];this._triggerTag(l)}};a.prototype._triggerTag=function(e){if(this.reRun===true)e.run();else e.runOnce()};a.prototype.getState=function(e){if(e)this.setSession(e);var l=a.SUPER.prototype.getState.call(this);
if(l===q.state.DISABLED)return q.state.DISABLED;if(l===q.state.PASS)if(this.isSession())l=q.state.SESSION;if(this.config.script)l=this.config.script.call(this,l,this.getSession());this.lastState=l;return l};a.prototype.reset=function(){this._matchState=undefined;a.SUPER.prototype.reset.call(this);this._starterWasRun=undefined;this.starterExecuted=undefined;this.tagsToRun=[];this.reRun=undefined}})();G.html.GlobalEval={};G.html.GlobalEval.globalEval=function(a){if(window.execScript)window.execScript(a===
""?" ":a);else{var q=function(){window["eval"].call(window,a)};q()}};G.html.HtmlInjector={};G.html.HtmlInjector.inject=function(a,q,n,w,f){var e;var l;var g;var k;var r;var c;var v;if(n.toLowerCase().indexOf("\x3cscript")>=0){g=document.createElement("div");g.innerHTML="a"+n;k=g.getElementsByTagName("script");r=[];for(e=0,l=k.length;e<l;e+=1)r.push(k[e]);v=[];for(e=0,l=r.length;e<l;e+=1){c=r[e];var t={attributes:G.html.HtmlInjector.getAttributes(c)};if(c.src)t.src=c.src;else t.script=c.innerHTML;
v.push(t);c.parentNode.removeChild(c)}if(g.innerHTML)if(g.innerHTML.length>0)g.innerHTML=g.innerHTML.substring(1);G.html.HtmlInjector.doInject(a,q,g);G.html.HtmlInjector.loadScripts(v,0,w,a)}else{g=document.createElement("div");g.innerHTML=n;G.html.HtmlInjector.doInject(a,q,g);if(w)w()}};G.html.HtmlInjector.doInject=function(a,q,n){if(n.childNodes.length>0){for(var w=document.createDocumentFragment();n.childNodes.length>0;)w.appendChild(n.removeChild(n.childNodes[0]));if(q)G.html.HtmlInjector.injectAtStart(a,
w);else G.html.HtmlInjector.injectAtEnd(a,w)}};G.html.HtmlInjector.injectAtStart=function(a,q){if(a.childNodes.length===0)a.appendChild(q);else a.insertBefore(q,a.childNodes[0])};G.html.HtmlInjector.injectAtEnd=function(a,q,n){if(!n)n=1;if(a===document.body&&document.readyState!=="complete"&&n<50)setTimeout(function(){G.html.HtmlInjector.injectAtEnd(a,q,n+1)},100);else a.appendChild(q)};G.html.HtmlInjector.loadScripts=function(a,q,n,w){var f;var e;var l=false;for(f=a.length;q<f;q+=1){e=a[q];if(e.src){l=
true;break}else G.html.GlobalEval.globalEval(e.script)}if(l)G.html.fileLoader.load(e.src,null,function(){G.html.HtmlInjector.loadScripts(a,q+1,n,w)},w,false,e.attributes);if(n&&q===f)n()};G.html.HtmlInjector.getAttributes=function(a){var q;var n;var w;var f;var e;var l={};if(a){w=a.attributes;n=w.length;for(q=0;q<n;q++){f=w[q].value;e=w[q].name.toLowerCase();if(f!==""&&(e==="id"||e==="class"||e==="charset"||e.substr(0,5)==="data-"))l[e]=f}return l}};(function(){function a(){v=v||{write:document.write,
writeln:document.writeln}}function q(){document.write=v.write;document.writeln=v.writeln;v=null}var n=A.opentag.filter.BaseFilter;var w=A.opentag.Utils;var f=G.html.HtmlInjector;var e=G.html.fileLoader;var l=A.opentag.filter.Filter;var g=function(){};A.Define.clazz("qubit.opentag.TagsUtils",g);var k=false;g.bodyLoaded=function(){if(k)return true;k=!!(document.body&&document.readyState!=="loading");return k};g.bodyAvailable=function(b){return!!document.body};var r={};var c={SUCCESS:"success",FAIL:"failure",
INIT:"not started"};g.loadScript=function(b){var h=b.url;var m=function(D,E,F){r[h].error=E;if(F){r[h].state=c.FAIL;b.onerror()}else{r[h].state=c.SUCCESS;b.onsuccess()}};if(r[h]){if(b.noMultipleLoad)return m(h,r[h].error,r[h].state===c.FAIL);r[h].count+=1}else r[h]={count:1,state:null};var z=!b.async;var C=g.bodyLoaded();if(z&&C);z=z&&!C;if(z)g.writeScriptURL(h,function(D,E){m(h,E,!D)});else e.load(h,false,m,b.node,b.async)};var v=null;g.redirectDocumentWritesToArray=function(b,h){var m=b;a();document.write=
function(z){m.push(z)};document.writeln=function(z){m.push(z)}};g.flushDocWritesArray=function(b,h,m,z,C){var D=h;if(D&&b){var E=b.splice(0,b.length);try{g.injectHTML(D,m,E.join("\n"),C||M);return true}catch(I){}}else{var F="Flushing location not found!";return false}if(C)C();return true};g.unlockDocumentWrites=function(){if(v)q()};var t=g.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks";var y={};A.Define.namespace(t,y,O,true);var B=0;var p=(new Date).valueOf();g.writeScriptURL=function(b,
h){var m="_"+p+"_"+B++;var z=t+"."+m;var C=false;y[m]=function(R){if(C)return;C=true;if(R)h(false,"error while loading script "+b);else h(true);y[m]=undefined;delete g.writeScriptURL.callbacks[m]};var D='if(this.readyState \x3d\x3d\x3d "loaded" || '+'this.readyState \x3d\x3d\x3d "complete"){ try {'+z+"(true)"+"} catch (ex) {}}";var E="try{"+z+"(false)}catch(ex){}";var F="try{"+z+"(true)}catch(ex){}";var I="scr";var J;b=e.tidyUrl(b);J="\x3c"+I+"ipt onload\x3d'"+E+"'  onerror\x3d'"+F+"' onreadystatechange\x3d'"+
D+"' type\x3d'text/javascript' "+" src\x3d'"+b+"'\x3e"+"\x3c/"+I+"ipt\x3e";if(v){q();document.write(J);a()}else document.write(J);w.bodyReady(function(){if(!C){C=true;h(true)}})};g.writeScriptURL.callbacks={};var u=n.state.SESSION;var x=n.state.PASS;var d=n.state.FAIL;g.filtersState=function(b,h,m,z){b=b.sort(function(aa,ka){try{var ba=ka.config.order;var ca=aa.config.order;if(isNaN(-ca))ca=0;if(isNaN(-ba))ba=0;return ba-ca}catch(la){return 0}});var C=x;if(!b||b.length===0)return C;var D=null;var E=
false;var F=false;var I=0;var J;var R;var S=[];var K;var V;for(var W=0;W<b.length;W++){K=b[W];K.setSession(h);if(K.match()){J=K.getState();if(J>0){if(I===0||I>J)I=J}else if(J===n.state.DISABLED)E=true;else if(J===u){F=true;D=K;R=K;S.push(K)}else D=K}else V=K}var T=false;if(D===null){T=true;if(!E)C=d;else C=x}else if(D.config.include)C=J;else C=J===x?d:x;if(I>0&&(C===x||T))C=I;if(C===u||C===x&&F){if(!R.config.include)return d;C=u;if(R instanceof l&&R.isSession())if(z)for(var U=0;U<S.length;U++)try{S[U].runTag(m)}catch(aa){}}if(m.config.dedupe&&
C===x)if(V&&V instanceof l&&V.isSession()){m.sendDedupePing=true;C=d}return C};g.injectHTML=function(b,h,m,z){return f.inject(b,!h?1:0,m,z||M)};g.getHTMLLocationForTag=function(b){var h;var m=b.prepareLocationObject(b.config.locationObject);switch(m){case "HEAD":h=document.getElementsByTagName("head")[0];break;case "BODY":h=document.body;break;default:if(m)h=document.getElementById(m);else h=document.body}return h}})();(function(){function a(g){this.config={};this.handlers=[];this.parameters=null;
this.callHandlersOnRead=false;if(g){this.uniqueId="BV"+f++;a.ALL_VARIABLES[this.uniqueId]=this;for(var k in g)if(g.hasOwnProperty(k)){this.config[k]=g[k];if(k==="value")this.value=g.value}var r=a.register(this);if(r&&r!==this);return r}}function q(){if(l)return false;for(var g=0;g<e.length;g++)try{var k=e[g];k.getValue()}catch(r){}w.setTimeout(q,a.CHECK_POLL_RATE);return true}var n=A.opentag.Utils;var w=A.opentag.Timed;var f=0;A.Define.clazz("qubit.opentag.pagevariable.BaseVariable",a);a.ALL_VARIABLES=
{};var e=[];a.OBSERVED_VARIABLES=e;a.pageVariables=[];a.register=function(g){if(g instanceof a){for(var k=0;k<a.pageVariables.length;k++){var r=a.pageVariables[k];if(g===r)return r}a.pageVariables.push(g);return g}return null};a.prototype.getValue=function(){this._updateCurrentValue(this.value);return this.currentValue};a.prototype._updateCurrentValue=function(g){if(!this.valuesAreEqual(g,this.currentValue)){this.oldValue=this.currentValue;this.currentValue=g;if(!l||this.callHandlersOnRead)this._handleValueChanged();
return true}return false};a.prototype.getDefaultValue=function(){return this.defaultValue};a.prototype.setDefaultValue=function(g){this.defaultValue=g};a.prototype.exists=function(g){var k=n.variableExists(this.getValue());if(g)k=k||n.variableExists(this.getDefaultValue());return k};a.prototype.getRelativeValue=function(g,k){var r=this.getValue();if(!n.variableExists(r))r=k;var c;if(g&&!n.variableExists(r)){c=this.getDefaultValue();if(n.variableExists(c))r=c}return r};a.prototype.replaceToken=function(g,
k,r,c){var v=this.exists();var t=v?this.getValue():r;g="\\$\\{"+g+"\\}";if(c||t instanceof Array){var y;if(v)y=this.getValueAccessorString();else y=n.getAnonymousAcessor(t);return k.replace(new RegExp(g,"g"),y)}else return k.replace(new RegExp(g,"g"),t)};a.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};a.prototype.getValueAccessorString=function(){return this.getAccessorString()+".getValue()"};a.prototype.onValueChanged=function(g,
k){if(n.addToArrayIfNotExist(this.handlers,g)===-1);if(k!==false)this.startObservingForChanges()};a.prototype.deatchOnValueChanged=function(g){if(n.removeFromArray(this.handlers,g)>0);};a.prototype._handleValueChanged=function(){var g={oldValue:this.oldValue,newValue:this.currentValue,variable:this};for(var k=0;k<this.handlers.length;k++)try{this.handlers[k](g)}catch(r){}};var l=true;a.CHECK_POLL_RATE=333;a.prototype.startObservingForChanges=function(){this.addToObservedVariables();if(l){l=false;
q()}};a.prototype.stopObservingForChanges=function(){this.removeFromObservedVariables();if(e.length===0)l=true};a.prototype.addToObservedVariables=function(){n.addToArrayIfNotExist(e,this)};a.prototype.removeFromObservedVariables=function(){n.removeFromArray(e,this)};a.prototype.getObservedVariables=function(){return e};a.prototype.valuesAreEqual=function(g,k){return g===k}})();(function(){function a(w){this._lockExprObject={};a.SUPER.apply(this,arguments)}var q=A.opentag.Utils;var n=A.opentag.Timed;
A.Define.clazz("qubit.opentag.pagevariable.Expression",a,A.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var w;var f;var e=this.value;try{if(e&&e.indexOf("[#]")===-1){var l=q.gevalAndReturn(e);w=l.result;this.failMessage=null;f=l.error}else w=a.parseUVArray(e)}catch(r){f=r}if(f){var g="could not read value of expression: \n"+e+"\nexact cause: "+f;if(this.failMessage!==g)this.failMessage=g;w=null}var k=this._updateCurrentValue(w);return w};a.parseUVArray=function(w){var f=w.split("[#]");
var e=q.gevalAndReturn(f[0]).result;var l=[];var g=f[1];if(g.indexOf(".")===0)g=g.replace(".","");for(var k=0;k<e.length;k++){var r=q.getObjectUsingPath(g,e[k]);l.push(r)}return l};a.prototype.replaceToken=function(w,f,e,l){if(this.getValue()instanceof Array)l=true;return a.SUPER.prototype.replaceToken.call(this,w,f,e,l)}})();(function(){function a(n){a.SUPER.apply(this,arguments)}var q=A.opentag.Utils;A.Define.clazz("qubit.opentag.pagevariable.DOMText",a,A.opentag.pagevariable.BaseVariable);a.prototype.getValue=
function(){var n=q.getElementValue(this.value);this._updateCurrentValue(n);return n}})();(function(){function a(q){a.SUPER.apply(this,arguments);this._lockObject={}}A.Define.clazz("qubit.opentag.pagevariable.Cookie",a,A.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var q=A.Cookie.get(this.value);this._updateCurrentValue(q);return q}})();(function(){function a(n){a.SUPER.apply(this,arguments)}var q=A.opentag.Utils;A.Define.clazz("qubit.opentag.pagevariable.URLQuery",a,A.opentag.pagevariable.BaseVariable);
a.prototype.getValue=function(){var n=q.getQueryParam(this.value);this._updateCurrentValue(n);return n}})();(function(){function a(){}function q(u,x){var d=[];try{var b=u.parameters;if(b)for(var h=0;h<b.length;h++)if(u.getVariableForParameter(b[h])===x)d.push(b[h])}catch(m){}return d}var n=A.opentag.Utils;var w=A.opentag.TagsUtils;var f=A.opentag.Timed;var e=A.opentag.pagevariable.BaseVariable;var l=A.opentag.pagevariable.Expression;var g=A.opentag.pagevariable.UniversalVariable;var k=A.opentag.pagevariable.DOMText;
var r=A.opentag.pagevariable.Cookie;var c=A.opentag.pagevariable.URLQuery;A.Define.clazz("qubit.opentag.TagHelper",a);a.injectHTMLForLoader=function(u,x,d,b){var h=b!==undefined?b:u.getHtml();if(h){var m=u.config.locationPlaceHolder==="END";var z=w.getHTMLLocationForTag(u);u.injectHTMLNotFinished=true;try{if(z)w.injectHTML(z,m,h,function(){u.injectHTMLNotFinished=false;if(x)try{x()}catch(C){}}.bind(u));else if(d&&document.readyState==="loading"){document.write(h);u.injectHTMLNotFinished=false}else u.injectHTMLFailed=
(new Date).valueOf()}catch(C){u.injectHTMLNotFinished=false;u.injectHTMLFailed=(new Date).valueOf()}}};a.getAllVariablesWithParameters=function(u){var x=u.getPageVariables();var d=[];for(var b=0;b<x.length;b++){var h=x[b];var m=q(u,h);for(var z=0;z<m.length;z++)d.push({parameter:m[z],variable:h})}return d};var v={};a.allParameterVariablesReadyForTag=function(u,x){var d=x;var b=true;var h=u.getPageVariables();for(var m=0;m<h.length;m++){var z=h[m];try{var C=q(u,z);var D=z.exists();if(!D&&d){if(C.length>
0)D=!!C[0].defaultValue;D=D||z.exists(true)}if(!D){b=false;break}}catch(E){b=false;break}}return b};var t="2";var y="3";var B="4";var p="5";a.validateAndGetVariableForParameter=function(u){if(u.hasOwnProperty("variable")&&u.variable)u.variable=a.initPageVariable(u.variable);return u.variable};a.initPageVariable=function(u){if(!u||u instanceof e)return u;if(typeof u==="string"){var x=n.getObjectUsingPath(u);if(x&&x instanceof e)return x}switch(u.type){case t:return new l(u);case y:return new c(u);
case B:return new r(u);case p:return new k(u);case "EPRESSION":return new l(u);case "URL_PARAMETER":return new c(u);case "COOKIE_VALUE":return new r(u);case "DOM_VALUE":return new k(u);default:return new e(u)}}})();(function(){function a(w){this.calls={}}var q=A.Define;var n=A.opentag.Utils;a.prototype.on=function(w,f){if(!this.calls[w])this.calls[w]=[];return n.addToArrayIfNotExist(this.calls[w],f)};a.prototype.call=function(w,f){var e=this.calls[w];if(e)for(var l=0;l<e.length;l++)try{e[l](f)}catch(g){}};
a.prototype.remove=function(w,f){if(this.calls[w])return n.removeFromArray(this.calls[w],f);return null};a.prototype.removeAll=function(w){var f=0;for(var e in this.calls)if(this.calls.hasOwnProperty(e))f+=n.removeFromArray(this.calls[e],w);return f};a.prototype.clear=function(){this.calls={}};q.clazz("qubit.Events",a)})();(function(){function a(c){this.log=new g("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.urlsLoaded=0;this.urlsFailed=0;this.runCounter=
0;this.events=new A.Events({});this._depLoadedHandler=function(){if(this.dependenciesLoaded()&&this.awaitingDependencies)this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+l++,async:true,usesDocumentWrite:false,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,locationPlaceHolder:"END",locationObject:null,dontWaitForInjectionLocation:false,noMultipleLoad:false,loadDependenciesOnLoad:false};this.delayDocWrite=false;this.dependencies=[];this._lockObject={count:0};
this._lockObjectDepsLoaded={};this.genericDependencies=[];if(c){if(!c.name){var v="Tag-"+l++;this.config.name=v}this.addState("INITIAL");for(var t in c)this.config[t]=c[t];if(c.genericDependencies)this.genericDependencies=this.genericDependencies.concat(c.genericDependencies);if(c.dependencies)this.dependencies=c.dependencies.concat(this.dependencies);if(c.PACKAGE)this._package=c.PACKAGE;this.onInit()}}function q(){if(this.cancelled){this._handleCancel();return}this.waitForDependenciesFinished=(new Date).valueOf();
var c=this._fullBodyNeededAndUnLoaded();var v=this._bodyNeededButNotAvailable();if(c||v)this.waitForDependenciesFinished=false;else{if(!this.timeoutCountdownStart)this.timeoutCountdownStart=(new Date).valueOf();if(this.allDependenciesLoaded())this._markLoadedSuccesfuly();else if(this._loadingOutOfTimeFrames()){this.loadingTimedOut=(new Date).valueOf();if(this.allDependenciesLoaded(true))this._markLoadedSuccesfuly();else{this.addState("TIMED_OUT");this._markLoadingDependenciesFailed();this._triggerOnLoadTimeout()}}else this.waitForDependenciesFinished=
false}if(!this.waitForDependenciesFinished)this._setTimeout(q.bind(this),65);else this.addState("LOADED_DEPENDENCIES")}var n=A.opentag.Utils;var w=A.opentag.TagsUtils;var f=A.opentag.Timed;var e=A.opentag.TagHelper;var l=0;var g=A.opentag.Log;var k="after";var r="before";A.Define.clazz("qubit.opentag.GenericLoader",a);a.prototype.onInit=M;a.prototype.LOADING_TIMEOUT=5*1E3;a.prototype.getHtml=function(){if(this.config.html)return this.config.html;if(this.htmlContent)return n.trim(this.htmlContent);
return null};a.prototype._executeScript=function(){var c=false;try{this.script();c=true}catch(v){this.addState("EXECUTED_WITH_ERRORS");this.executedWithErrors=(new Date).valueOf();this._onError(v)}finally{this._onExecute(c)}};a.prototype.getTimeout=function(){return this._getTimeout()};a.prototype._getTimeout=function(c){var v=+this.config.timeout;var t=this.dependencies;if(v!==-1&&t.length>0){var y=0;c=c||[];var B=n.indexInArray(c,this)!==-1;if(!B){c[c.length]=this;for(var p=0;p<t.length;p++){var u=
t[p]._getTimeout(c);if(u>y)y=u}if(y>0)v+=y}else return 0}return v};a.prototype._onExecute=function(c){this.onExecute(c)};a.prototype.onExecute=M;a.prototype._flushDocWrites=function(c){var v=true;this._docWriteNotFlushed=false;try{var t=w.getHTMLLocationForTag(this);if(t&&this._securedWrites&&this._securedWrites.length>0){var y=this.config.locationPlaceHolder==="END";v=w.flushDocWritesArray(this._securedWrites,t,y,this.log,c);if(v)this._docWriteFlushed=(new Date).valueOf();else this._docWriteNotFlushed=
(new Date).valueOf()}}catch(B){this._onError(B)}if(c)c();if(this._securedWrites&&this._securedWrites.length>0){v=false;this._docWriteNotFlushed=(new Date).valueOf()}return v};a.prototype.log=M;a.prototype.finished=function(){return!!this.runIsFinished};a.prototype.script=function(){};a.prototype.before=function(){this.beforeRun=(new Date).valueOf();try{this.events.call(r,this)}catch(c){this._onError(c)}};a.prototype.onBefore=function(c){this.events.on(r,c)};a.prototype.after=function(c){this.afterRun=
(new Date).valueOf();try{this.events.call(k,{success:c,tag:this})}catch(v){this._onError(v)}};a.prototype.onAfter=function(c){this.events.on(k,c)};a.prototype.runOnce=function(){if(!this._runOnceTriggered&&!this.scriptExecuted){this._runOnceTriggered=(new Date).valueOf();this.run()}};a.CANCEL_ALL=false;a.prototype.run=function(){if(!isNaN(this.config.runningLimit))if(this.config.runningLimit<=this.runCounter)return false;if(this.cancelled||a.CANCEL_ALL){this._handleCancel();return false}if(this.isRunning)return false;
if(this.lastRun)this.reset();this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;this._ignoreDeps=!!this.ignoreDependencies;if(!this._ignoreDeps&&!this.dependenciesLoaded()){this._attachDepsEventsToContinue();return false}return this._triggerLoadingAndExecution()};a.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();if(this._ignoreDeps)this.execute();else this.waitForDependenciesAndExecute();return true};a.prototype._attachDepsEventsToContinue=
function(){this.awaitingDependencies=(new Date).valueOf();var c=this.dependencies;for(var v=0;v<c.length;v++)try{c[v].events.on("success",this._depLoadedHandler)}catch(t){}};a.prototype.dependenciesLoaded=function(){var c=this.dependencies;for(var v=0;v<c.length;v++)if(c[v]!==this){var t=+c[v].scriptExecuted>0;if(!t)return false}return true};a.prototype._setTimeout=function(c,v){this._wasTimed=(new Date).valueOf();return f.setTimeout(c,v)};a.prototype._handleCancel=function(){this.addState("CANCELLED");
try{this.onCancel()}catch(c){this._onError(c)}};a.prototype.waitForDependenciesAndExecute=function(){if(this.cancelled){this._handleCancel();return}if(this.loadedDependencies)this.execute();else if(this.loadingDependenciesFailed){this._markFailure();this._markFinished()}else this._setTimeout(this.waitForDependenciesAndExecute.bind(this),30)};a.prototype.execute=function(){this._triggerExecution()};a.prototype._triggerExecution=function(){if(this.cancelled){this._handleCancel();return}if(this.scriptExecuted)return;
var c=true;if(this.shouldWaitForDocWriteProtection())c=false;else{if(!this._beforeEntered){this._beforeEntered=(new Date).valueOf();var v=false;try{v=this.before()}catch(y){this._onError(y)}if(v){this._markFailure();this._markFinished();return}}c=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(this.scriptExecuted)return;if(this.unexpectedFail)c=true;if(!c)this._setTimeout(this._triggerExecution.bind(this),30);else{this._flushDocWrites();if(this.scriptLoadingFailed||this.injectHTMLFailed||
this.unexpectedFail)this._markFailure();else{this.scriptExecuted=(new Date).valueOf();this.addState("EXECUTED");this._executeScript()}if(this.cancelled){this._handleCancel();return false}else{var t=this.scriptExecuted>0;try{if(!this.afterRun){this.afterRun=(new Date).valueOf();this.after(t)}}catch(y){this.executedWithErrors=(new Date).valueOf()}if(!this.executedWithErrors)if(t)this.events.call("success")}this._flushDocWrites();this._markFinished()}};a.prototype._markFailure=function(){this.scriptExecuted=
-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};a.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();this.isRunning=false;if(a.LOCK_DOC_WRITE===this){this._flushDocWrites();w.unlockDocumentWrites();a.LOCK_DOC_WRITE=false}this.onFinished(true)};a.prototype.onFinished=M;a.prototype.onCancel=M;a.prototype.onFinished=M;a.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!a.LOCK_DOC_WRITE){a.LOCK_DOC_WRITE=this;this._secureWriteAndCollectForExecution()}else if(a.LOCK_DOC_WRITE!==
this){if(!this._lockedDocWriteInformed)this._lockedDocWriteInformed=(new Date).valueOf();return true}return false};a.prototype.runWithoutDependencies=function(){this.ignoreDependencies=true;this.run()};a.prototype.loadExecutionURLsAndHTML=function(c){if(this.cancelled){this._handleCancel();return true}if(!this._loadExecutionURLsAndHTMLInformed)this._loadExecutionURLsAndHTMLInformed=true;this._triggerURLsLoading(c);if(!this.loadURLsNotFinished){this._flushDocWrites();this._triggerHTMLInjection();this._flushDocWrites();
if(!this.injectHTMLNotFinished){this._flushDocWrites();if(!this._docWriteNotFlushed){if(this._docWriteFlushed);return true}}}return false};a.prototype._triggerURLsLoading=function(c){if(!this._urlLoadTriggered&&this.config.url){this._urlLoadTriggered=true;this.loadURLs(false,c)}};a.prototype._triggerHTMLInjection=function(){if(!this._injectHTMLTriggered&&this.getHtml()){this._injectHTMLTriggered=true;this.injectHTML()}};a.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,
LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,UNEXPECTED_FAIL:2048,CANCELLED:2048*2};a.prototype.addState=function(c){if(this.STATE.hasOwnProperty(c)){this.state=this.state|this.STATE[c];try{this.onStateChange(c)}catch(v){this._onError(v)}}};a.prototype.onStateChange=M;a.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};a.prototype.unCancel=function(){this.cancelled=undefined};
a.prototype.state=a.prototype.STATE.INITIAL;a.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};a.prototype._secureWriteAndCollectForExecution=function(){if(!this._securedWrites){this._securedWrites=[];w.redirectDocumentWritesToArray(this._securedWrites,this.log)}};a.prototype._markLoadingDependenciesFailed=function(){this.addState("FAILED_TO_LOAD_DEPENDENCIES");this.loadingDependenciesFailed=(new Date).valueOf()};a.prototype.allDependenciesLoaded=
function(c,v){return this.getDependenciesToBeLoaded(c,v).length===0};a.prototype.getDependenciesToBeLoaded=function(c,v){var t=v||[];if(!this.injectionLocationReady())t.push("injection location");var y;var B=this.dependencies;for(y=0;y<B.length;y++)if(B[y]!==this){var p=+B[y].scriptExecuted>0;if(!p){var u=B[y].config?B[y].config.name:"anonymous";t.push("dependant Tag with name -\x3e "+u)}}for(y=0;y<this.genericDependencies.length;y++){var x=this.genericDependencies[y](this);if(!x)t.push("this.genericDependencies["+
y+"] (index: "+y+")")}if(t!=="");return t};a.prototype.docWriteAsksToWaitForBody=function(){return!!(this.delayDocWrite&&this.config.usesDocumentWrite)};a.prototype._bodyNeededButNotAvailable=function(){if(this._dontWaitForInjections())return false;return this._isBodyLocationNeeded()&&!w.bodyAvailable()};a.prototype._isBodyLocationNeeded=function(){if(!this.isLoadingAsynchronously())return false;if(this._isBodyLocationSet())return true;else{var c=this.config.locationObject==="HEAD";return c&&this.config.locationPlaceHolder===
"END"}};a.prototype._isBodyLocationSet=function(){var c=this.config.locationObject;return!c||c==="BODY"};a.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return false;var c=false;if(this._isBodyLocationNeeded())c=this.config.locationPlaceHolder==="END";c=c||(this.fullbodyNeeded||this.docWriteAsksToWaitForBody());return c&&!n.bodyReady()};a.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||
a.dontWaitForInjectionLocation};a.prototype.injectionLocationReady=function(){if(this._dontWaitForInjections())return true;if(this._fullBodyNeededAndUnLoaded())return false;if(!this.isLoadingAsynchronously())return true;return!!w.getHTMLLocationForTag(this)};a.prototype._loadingOutOfTimeFrames=function(){if(this.getTimeout()<0)return false;return(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};a.prototype.loadDependencies=function(){this._loadDependencies()};a.prototype.addClientDependenciesList=
function(c,v){return this.addDependenciesList(c,A.Define.clientSpaceClasspath())};a.prototype.addDependenciesList=function(c,v){if(!c||c.length===0)return;if(!this.failedDependenciesToParse)this.failedDependenciesToParse=[];var t=this.dependencies;for(var y=0;y<c.length;y++){var B=c[y];var p=false;if(B instanceof a)t.push(B);else if(typeof B==="string"){var u=B;if(v)B=v+"."+B;var x=n.getObjectUsingPath(B);if(x)if(x instanceof a)t.push(x);else p=true;else this.failedDependenciesToParse.push(u)}else p=
true;if(p){this.badDepsObjects=this.badDepsObjects||[];n.addToArrayIfNotExist(this.badDepsObjects,B)}}};a.prototype._loadDependencies=function(c){c=c||[];var v=this.dependencies;var t=n.indexInArray(c,this)!==-1;if(!t){c[c.length]=this;for(var y=0;y<v.length;y++)v[y].load(c)}};a.prototype.onError=M;a.prototype._onError=function(c){try{this.onError(c)}catch(v){}};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.onLoadTimeout=M;a.prototype.onScriptsLoadSuccess=M;a.prototype.onScriptLoadError=
M;a.prototype.onAllDependenciesLoaded=M;a.prototype.onBeforeLoad=null;a.prototype.load=function(){if(this.loadStarted)return;else{this.loadStarted=(new Date).valueOf();try{if(this.onBeforeLoad)this.onBeforeLoad()}catch(c){this._onError(c)}}this.addState("LOADING_DEPENDENCIES");try{if(!this._ignoreDeps&&this.config.loadDependenciesOnLoad)this.loadDependencies()}catch(c){throw c;}q.call(this)};a.prototype._singleUrlLoadHandler=function(c,v,t){++this.urlsLoaded;if(!c)++this.urlsFailed;if(this.urlsLoaded===
v.length){this.loadURLsNotFinished=false;if(c&&this.urlsFailed===0){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{if(t)t(true)}catch(B){this._onError(B)}finally{this.onScriptsLoadSuccess()}}else{var y="error loading urls. Failed "+this.urlsFailed;this._onError(y);this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=true;if(t)t(false)}catch(B){this._onError(B)}finally{this.onScriptLoadError(y)}}}};a.prototype.loadURLs=function(c,
v){var t=c||this.config.url;this.addState("LOADING_URL");try{if(t&&!(t instanceof Array))t=[t];for(var y=0;y<t.length;y++){this.loadURLsNotFinished=true;var B=t[y];B=this.prepareURL(B);this.loadURL(B,function(p){this._singleUrlLoadHandler(p,t,v)}.bind(this))}}catch(p){this.loadURLsNotFinished=false;this.addState("UNEXPECTED_FAIL");this.unexpectedFail=(new Date).valueOf();this._onError(p)}};a.prototype.prepareLocationObject=function(c){return c};a.prototype.prepareURL=function(c){return c};a.prototype.prepareHTML=
function(c){return c};a.prototype.loadURL=function(c,v,t){var y=c;this.addState("LOADING_URL");w.loadScript({onsuccess:function(){try{if(v)v(true)}catch(B){}}.bind(this),onerror:function(){try{if(v)v(false)}catch(B){}}.bind(this),url:y,node:t||this.config.urlLocation,async:this.isLoadingAsynchronously(),noMultipleLoad:this.config.noMultipleLoad})};a.prototype.reset=function(){var c;this._injectHTMLTriggered=c;this._loadExecutionURLsAndHTMLInformed=c;this._lockedDocWriteInformed=c;this._runOnceTriggered=
c;this._urlLoadTriggered=c;this.afterRun=c;this.beforeRun=c;this.filtersRunTriggered=c;this.injectHTMLFailed=c;this.loadStarted=c;this.loadURLsNotFinished=c;this.loadedDependencies=c;this.loadingDependenciesFailed=c;this.loadingTimedOut=c;this.runIsFinished=c;this.scriptExecuted=c;this.scriptLoadingFailed=c;this.delayDocWrite=c;this._securedWrites=c;this.state=0;this.unexpectedFail=c;this.urlsFailed=0;this.urlsLoaded=0;this.waitForDependenciesFinished=c;this.isRunning=c;this._lastRun=c;this.cancelled=
c;this._beforeEntered=c;this.awaitingDependencies=c;this.timeoutCountdownStart=c;this.addState("INITIAL")};a.prototype.isLoadingAsynchronously=function(){if(this._wasTimed)return true;return!!(this.config.async||this.forceAsynchronous)};a.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};a.prototype.injectHTML=function(c){var v=!this.docWriteAsksToWaitForBody();var t=this.prepareHTML(this.getHtml());if(t)e.injectHTMLForLoader(this,c,
v,t)};a.prototype.clone=function(){var c=new a(this.config);return c}})();(function(){function a(d){var b={filterTimeout:d&&d.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:d&&d.PACKAGE,dedupe:false,needsConsent:false,inactive:false,variables:null,runner:null,disabled:false,locked:false,reRunOnVariableChange:false};n.setIfUnset(d,b);a.SUPER.apply(this,arguments);this.namedVariables={};this.parameters=[];this.filters=[];this.session=null;this.pingSent=false;this.oldPingSent=false;this.dedupePingSent=
false;this.oldDedupePingSent=false;this.reRunCounter=0;if(d){this.addState("INITIAL");try{a.register(this)}catch(h){}this.setupConfig(d);this.uniqueRefString=null;if(d.init)try{d.init.call(this,d)}catch(h){}this.onTagInit();this.handleVariableChange=this._handleVariableChange.bind(this)}}function q(d,b){var h=d.namedVariables;var m=g.initPageVariable(h[b]);h[b]=m;return m}var n=A.opentag.Utils;var w=A.opentag.TagsUtils;var f=A.opentag.Timed;var e=A.opentag.filter.BaseFilter;var l=A.opentag.GenericLoader;
var g=A.opentag.TagHelper;var k=A.opentag.pagevariable.BaseVariable;var r=A.Cookie;var c=A.Define;c.clazz("qubit.opentag.BaseTag",a,l);a.prototype.setupConfig=function(d){if(!d)return;if(d.filters)this.addFilters(d.filters);if(d.parameters)this.addParameters(d.parameters);if(d.variables)for(var b in d.variables)if(d.variables.hasOwnProperty(b)){var h=this.getParameterByTokenName(b);if(h){var m=d.variables[b];h.variable=m;if(m.defaultValue!==undefined)h.defaultValue=m.defaultValue;if(m.uv!==undefined)h.uv=
m.uv}}if(d.locked)this.lock()};a.prototype.valueForToken=function(d,b){var h=this.getParameterByTokenName(d);if(h){if(b===undefined)if(this.loadingTimedOut)b=true;return this.getParameterValue(h,b)}var m=this.namedVariables;if(m&&m[d]){var z=q(this,d);if(z)return z.getRelativeValue(b)}return undefined};a.prototype.addParameters=function(d){this.parameters=this.parameters.concat(d)};a.prototype.LOADING_TIMEOUT=5*1E3;a.prototype.FILTER_WAIT_TIMEOUT=-1;a.prototype._isVariable=function(d){return d!==
null&&d!==undefined};a.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var d=this.parameters;if(d)for(var b=0;b<d.length;b++){var h=this.getVariableForParameter(d[b]);if(!this._isVariable(h)){this._markLoadingDependenciesFailed();this._markFinished();return}}if(this.config.runner){var m=false;try{this.addState("AWAITING_CALLBACK");m=this._runner=(new Date).valueOf();this.config.runner.call(this)}catch(z){}return m}else{this._runner=false;return this.start()}};
a.prototype.lock=function(){this.locked=true;this._unlock=null};a.prototype.unlock=function(){this.locked=false;if(this._unlock){this._unlock();this._unlock=false}};a.prototype.start=function(){if(!this.locked)return a.SUPER.prototype.run.call(this);else{this._unlock=function(){return a.SUPER.prototype.run.call(this)}.bind(this);return false}};a.prototype.startOnce=function(){if(!this.locked)return a.SUPER.prototype.runOnce.call(this);else{this._unlock=function(){return a.SUPER.prototype.runOnce.call(this)}.bind(this);
return false}};a.prototype.getFilters=function(){return this.filters};a.prototype.runOnceIfFiltersPass=function(){if(!this._runOnceIfFiltersPassTriggered&&!this.scriptExecuted){this._runOnceIfFiltersPassTriggered=(new Date).valueOf();this.runIfFiltersPass()}};a.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var d=this.filtersState(true);this.addState("FILTER_ACTIVE");if(!this.filtersRunTriggered)this.filtersRunTriggered=(new Date).valueOf();
if(d===e.state.SESSION){this.addState("AWAITING_CALLBACK");this.awaitingCallback=(new Date).valueOf()}else if(d===e.state.PASS){this.filtersPassed=(new Date).valueOf();try{this.onFiltersPassed()}catch(h){}this.run()}else if(d===e.state.FAIL){this._markFiltersFailed();this._markFinished()}else if(d>0){var b=this.config.filterTimeout;if(b<0||(new Date).valueOf()-this.filtersRunTriggered>b){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(h){}}this._setTimeout(this.runIfFiltersPass.bind(this),
d)}else{this._markFiltersFailed();this._markFinished();this.filtersRunTimedOut=(new Date).valueOf()}}try{this.onFiltersCheck(d)}catch(h){}return d};a.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};a.prototype.STATE={INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,
FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,TIMED_OUT:4096*2,UNEXPECTED_FAIL:4096*2*2,CANCELLED:4096*2*2*2};a.prototype.addState=function(d){a.SUPER.prototype.addState.call(this,d);try{a.onStateChange(this)}catch(z){}this.stateStack=[];var b=this.STATE;var h=this.state;var m=this.stateStack;if(h&b.INITIAL)m.push("Initial state.");if(h&b.FILTER_ACTIVE)m.push("Tag running with filters pass triggered.");if(h&b.FILTERS_FAILED)m.push("Filters failed to pass.");if(h&b.AWAITING_CALLBACK)m.push("Awaiting callback to run this tag. Not pooling.");
if(h&b.STARTED)m.push("Tag is initialized and loading has been started.");if(h&b.LOADING_DEPENDENCIES)m.push("Dependencies are being loaded.");if(h&b.LOADED_DEPENDENCIES)m.push("Dependencies loading process has been finished.");if(h&b.LOADING_URL)m.push("External URL is being loaded.");if(h&b.LOADED_URL)m.push("External URL has been loaded.");if(h&b.EXECUTED)m.push("Main script has been executed.");if(h&b.EXECUTED_WITH_ERRORS)m.push("Main script has been executed but errors occured.");if(h&b.FAILED_TO_LOAD_DEPENDENCIES)m.push("Dependencies has failed to load.");
if(h&b.FAILED_TO_LOAD_URL)m.push("URL location failed to load.");if(h&b.FAILED_TO_EXECUTE)m.push("Script failed to execute.");if(h&b.TIMED_OUT)m.push("Script timed out awaiting for dependencies.");if(h&b.UNEXPECTED_FAIL)m.push("Script occured UNEXPECTED exception and is failed.");if(h&b.CANCELLED)m.push("Tag has been cancelled.")};a.prototype.onTagInit=M;a.onStateChange=M;a.prototype.onFiltersDelayed=M;a.prototype.onFiltersPassed=M;a.prototype.onFiltersCheck=M;a.prototype.state=a.prototype.STATE.INITIAL;
a.prototype.arePageVariablesLoaded=function(d){return g.allParameterVariablesReadyForTag(this,d)};a.prototype.getDependenciesToBeLoaded=function(d,b){var h=b||[];if(!this.arePageVariablesLoaded(d))h.push("page variables");return a.SUPER.prototype.getDependenciesToBeLoaded.call(this,d,h)};a.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};a.prototype.resolveDependencies=function(){var d=this.failedDependenciesToParse;if(d){this.failedDependenciesToParse=
null;this.addDependenciesList(d,c.clientSpaceClasspath())}return this.dependencies};a.prototype.addClientVariablesMap=function(d){this.unresolvedClientVariablesMap=this._addVariablesMap(d,c.clientSpaceClasspath());return this.unresolvedClientVariablesMap};a.prototype.resolvePageVariables=function(){var d=this.unresolvedClientVariablesMap;if(d){this.unresolvedClientVariablesMap=null;this.addClientVariablesMap(d)}d=this.unresolvedVariablesMap;if(d){this.unresolvedVariablesMap=null;this.addVariablesMap(d)}return this.getPageVariables()};
a.prototype.addVariablesMap=function(d){this.unresolvedVariablesMap=this._addVariablesMap(d);return this.unresolvedVariablesMap};a.prototype._addVariablesMap=function(d,b){if(!d)return;var h={};var m=this.namedVariables;for(var z in d)if(d.hasOwnProperty(z)){var C=d[z];if(C instanceof k)m[z]=C;else if(typeof C==="string"){var D=C;if(b)C=b+"."+C;var E=n.getObjectUsingPath(C);if(E)if(E instanceof k)m[z]=E;else m[z]=C;else h[z]=D}else;}return h};a.prototype.prepareURL=function(d){return this.replaceTokensWithValues(d)};
a.prototype.prepareLocationObject=function(d){return this.replaceTokensWithValues(d)};a.prototype.prepareHTML=function(d){if(d)d=this.replaceTokensWithValues(d);return d};a.prototype._executeScript=function(){if(this.config&&this.config.script)if(typeof this.config.script==="function")this.script=this.config.script;else{var d=this.replaceTokensWithValues(String(this.config.script));this.script=n.expressionToFunction(d).bind(this)}a.SUPER.prototype._executeScript.call(this)};a.prototype.replaceTokensWithValues=
function(d){if(!d||d.indexOf("${")===-1)return d;var b=this.parameters;if(b)for(var h=0;h<b.length;h++){var m=b[h];var z=this.getVariableForParameter(m);if(z){var C=b[h].token;var D=this.valueForToken(C);d=z.replaceToken(C,d,D)}}return d};a.prototype.getParameter=function(d){var b=this.parameters;var h=null;if(b)for(var m=0;m<b.length;m++)if(b[m].name===d)h=b[m];return h};a.prototype.setParameterValueByTokenName=function(d,b){var h=this.getParameterByTokenName(d);if(h!==null){h.variable={value:b};
return true}return false};a.prototype.getParameterValue=function(d,b){var h=typeof d==="string"?this.getParameter(d):d;if(h){var m=this.getVariableForParameter(h);if(m)try{var z;if(b&&h.defaultValue!=="")z=n.gevalAndReturn(h.defaultValue).result;z=m.getRelativeValue(b,z);return z}catch(C){return undefined}}return undefined};a.prototype.filtersState=function(d){var b=d;return w.filtersState(this.filters,this.session,this,b)};a.prototype.addFilter=function(d){n.addToArrayIfNotExist(this.filters,d)};
a.prototype.addFilters=function(d){for(var b=0;b<d.length;b++)this.addFilter(d[b])};a.prototype.addClientFiltersList=function(d){this.unresolvedClientFilterClasspaths=this.addFiltersList(d,c.clientSpaceClasspath());return this.unresolvedClientFilterClasspaths};a.prototype.resolveFilters=function(){var d=this.unresolvedClientFilterClasspaths;if(d){this.unresolvedClientFilterClasspaths=null;this.addClientFiltersList(d)}return this.filters};a.prototype.addFiltersList=function(d,b){var h=[];for(var m=
0;m<d.length;m++)try{var z=d[m];var C=z;var D=null;if(typeof z==="string"){D=z;if(b)z=b+"."+z;z=n.getObjectUsingPath(z)}if(typeof z==="function"){var E=z;z=new E}if(!z);if(!z instanceof e)z=null;if(z)this.addFilter(z);else if(D)n.addToArrayIfNotExist(h,D)}catch(F){this.failedFilters=this.failedFilters||[];this.failedFilters.push(d[m])}return h};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);var d;this.filtersPassed=d;this.dedupePingSent=false;this.oldDedupePingSent=false;this.pingSent=
false;this.oldPingSent=false;this._runOnceIfFiltersPassTriggered=d;this.filtersRunTriggered=d;this._runner=d;this.reRunCounter=0;this.detachVariablesChangedListeners()};a.prototype.resetFilters=function(){for(var d=0;d<this.filters.length;d++)this.filters[d].reset()};a.prototype.getParameterByTokenName=function(d){var b=null;if(this.parameters){var h=this.parameters;for(var m=0;m<h.length;m++)if(h[m].token===d)b=h[m]}return b};a.prototype.removeFilter=function(d){n.removeFromArray(this.filters,d)};
var v=0;var t=[];var y={};var B={};a.register=function(d){var b=n.addToArrayIfNotExist(t,d);if(b===-1)d._tagIndex=t.length-1;else d._tagIndex=b;if(d.config.id){var h="Q"+d.config.id;B[h]=d;d.uniqueId=h}else B[d.CLASSPATH]=d};a.getById=function(d){return B[String(d)]};a.prototype.getById=a.getById;a.prototype.unregister=function(d){a.unregister(d||this)};a.prototype.destroy=function(){this.destroyed=true;this.cancel();a.unregister(this)};a.unregister=function(d){var b=n.removeFromArray(t,d);d._tagIndex=
-1};a.getTags=function(){return t};a.getAccessorsMap=function(){return y};a.prototype.getTags=function(){return t};a.prototype.getPageVariables=function(){var d=this.parameters;var b=[];if(d)for(var h=0;h<d.length;h++){var m=this.getVariableForParameter(d[h]);if(this._isVariable(m))n.addToArrayIfNotExist(b,m)}if(this.namedVariables)for(var z in this.namedVariables)n.addToArrayIfNotExist(b,q(this,z));return b};a.prototype.getAccessorString=function(){if(!this._accessorsMapKey){this._accessorsMapKey=
"_"+v++;y[this._accessorsMapKey]=this}return"qubit.opentag.BaseTag.getAccessorsMap()."+this._accessorsMapKey};a.prototype.getVariableForParameter=function(d){var b;var h=this.namedVariables;if(h&&h[d.token])b=q(this,d.token);if(!b)b=g.validateAndGetVariableForParameter(d);return b};a.prototype.printVariablesState=function(){var d=[];var b=g.getAllVariablesWithParameters(this);for(var h=0;h<b.length;h++){var m=b[h].parameter;var z=b[h].variable;var C;if(m&&m.token)C=this.valueForToken(m.token);else C=
z.getRelativeValue(true);var D={name:z.config.name,exists:z.exists(),token:m?m.token:null,value:C,variable:z};d.push(D)}return d};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.getId=function(){return this._getUniqueId()};a.prototype._getUniqueId=function(){if(this.config.id)return this.config.id;if(String(this.CLASSPATH).indexOf(c.STANDARD_CS_NS)===0)return this.CLASSPATH.substring(c.STANDARD_CS_NS.length+1);else return this.CLASSPATH+"#"+this.config.name};var p="qubit.tag.forceRunning_";
var u="qubit.tag.disableRunning_";var x="qubit.tag.forceAllToRun";a.prototype.cookieSaysToRunEvenIfDisabled=function(){var d=this._getUniqueId();var b=!!r.get(x);if(!b)b=!!r.get(p+d);return b};a.prototype.setCookieForcingTagToRun=function(){var d=this._getUniqueId();r.set(p+d,"true")};a.setCookieForcingTagsToRun=function(){r.set(x,"true")};a.prototype.setCookieToDisable=function(){var d=this._getUniqueId();r.set(u+d,"true")};a.prototype.rmCookieToDisable=function(){var d=this._getUniqueId();r.rm(u+
d)};a.prototype.disabledByCookie=function(){var d=this._getUniqueId();return!!r.get(u+d)};a.rmCookieForcingTagsToRun=function(){r.rm(x)};a.prototype.rmCookieForcingTagToRun=function(){var d=this._getUniqueId();r.rm(p+d)};a.rmAllDisablingCookies=function(){n.rmCookiesMatching(u)};a.rmAllCookiesForcingTagToRun=function(){n.rmCookiesMatching(p);a.rmCookieForcingTagsToRun()};a.prototype.onVariableChanged=function(d){this.attachVariablesChangedListeners(true);this.events.on("variableChanged",d)};a.prototype._handleVariableChange=
function(d){this.events.call("variableChanged",d);if(!this.isRunning&&this.config.reRunOnVariableChange){if(!isNaN(this.config.reRunLimit))if(this.config.reRunLimit<=this.reRunCounter)return;var b=this.reRunCounter+1;this.reset();this.reRunCounter=b;this.resetFilters();this.runIfFiltersPass()}};a.prototype.attachVariablesChangedListeners=function(d){var b=this.getPageVariables();var h=!!(this.config.reRunOnVariableChange||this.config.observeVariables||d);if(h)for(var m=0;m<b.length;m++){var z=b[m];
z.onValueChanged(this.handleVariableChange,h)}};a.prototype.detachVariablesChangedListeners=function(){var d=this.getPageVariables();for(var b=0;b<d.length;b++){var h=d[b];h.deatchOnValueChanged(this.handleVariableChange)}};a.prototype._markFinished=function(){a.SUPER.prototype._markFinished.call(this);this.attachVariablesChangedListeners()}})();(function(){var a=A.opentag.Utils;var q=A.opentag.filter.BaseFilter;var n=function(){};A.Define.clazz("qubit.opentag.Tags",n);n.getById=function(f){return A.opentag.BaseTag.getById(String(f))};
n.getAllTagsByState=function(){return A.opentag.Container.getAllTagsByState(n.getTags())};n.findTagByName=function(f){var e=this.getTags();var l=[];for(var g=0;g<e.length;g++)if(e[g].config.name===f)l.push(e[g]);return l};n.findTagByMatch=function(f){var e=this.getTags();var l=[];for(var g=0;g<e.length;g++)if(e[g].config.name.match(f))l.push(e[g]);return l};n.findTagContainers=function(f){var e=n.getContainers();var l=[];for(var g=0;g<e.length;g++){var k=e[g].tags;for(var r in k)if(k[r]===f){l.push(e[g]);
break}}return l};n.getTags=function(){return A.opentag.BaseTag.getTags()};n.resetAllTags=function(f){var e=n.getTags();for(var l=0;l<e.length;l++){e[l].reset();if(!f)e[l].resetFilters()}};n.getContainersPageVariables=function(){var f=n.getContainers();var e=[];for(var l=0;l<f.length;l++)e=e.concat(f.getPageVariables());return e};n.getAllPageVariables=function(){var f=n.getTags();var e=[];for(var l=0;l<f.length;l++)e=e.concat(f[l].getPageVariables());return e};n.cancelAll=function(){var f=n.getTags();
for(var e=0;e<f.length;e++)f[e].cancel()};n.resetAll=function(f){var e=n.getTags();for(var l=0;l<e.length;l++){e[l].reset();if(!f)e[l].resetFilters()}};n.getPageVariableByName=function(f){var e=n.getAllPageVariables();var l=[];for(var g=0;g<e.length;g++)if(e[g].config.name===f)l.push(e[g]);return l};n.getLoadTime=function(f){var e=f.beforeRun;var l=f.runIsFinished;if(isNaN(l))return{tag:f,loadTime:null};else return{tag:f,loadTime:l-e}};n.getLoadTimes=function(f){var e=[];if(f instanceof A.opentag.BaseTag){e.push([n.getLoadTime(f[k])]);
return e}f=f||n.getTags();var l=f instanceof Array;if(l)for(var g=0;g<f.length;g++){if(f[g]instanceof A.opentag.BaseTag)e.push(n.getLoadTime(f[g]))}else for(var k in f)if(f[k]instanceof A.opentag.BaseTag)e.push(n.getLoadTime(f[k]));return e};n.forceAllContainersAndTagsToRunIfDisabled=function(){A.opentag.Container.setCookieForDisabledContainersToRun();A.opentag.BaseTag.setCookieForcingTagsToRun()};n.rmAllContainersAndTagsForcingFlags=function(){A.opentag.Container.rmCookieForDisabledContainersToRun();
A.opentag.BaseTag.rmAllCookiesForcingTagToRun()};n.getContainers=function(){return A.opentag.Container.getContainers()};n.findAllTagsByClassPath=function(f){var e=(new Date).valueOf();var l=[];var g=[];try{g.push(A.opentag.CustomTag);g.push(A.opentag.LibraryTag)}catch(v){}var k=n.getTags();for(var r=0;r<k.length;r++){var c=k[r];if(a.indexInArray(g,c)<0&&c.PACKAGE_NAME.indexOf(f)===0)l.push(c)}return l};n.findAllTags=function(f,e){var l=A.opentag.BaseTag;var g;var k=[];var r=(new Date).valueOf();try{k.push(A.opentag.CustomTag);
k.push(A.opentag.LibraryTag)}catch(c){}g=n.findAllInstances(f,l,k,e);return g};var w=function(f,e,l,g){var k=[];if(typeof f==="string")f=a.getObjectUsingPath(f);if(f){var r={objectsOnly:true};if(g)r.maxDeep=true;var c=function(v,t,y,B){if(e(v)){for(var p=0;p<l.length;p++)if(l[p]===v)return true;a.addToArrayIfNotExist(k,v);return true}return false}.bind(this);a.traverse(f,c,r)}return k};n.findAllInstances=function(f,e,l,g){var k=function(r){return r instanceof e};return w(f,k,l,g)};n.findAllInheriting=
function(f,e,l,g){var k=function(r){return r.prototype instanceof e};return w(f,k,l,g)};n.findAllFilters=function(f,e){var l=[];try{l.push(A.opentag.filter.Filter);l.push(A.opentag.filter.URLFilter)}catch(g){}return n.findAllInheriting(f,q,l,e)}})();G.cookie={};G.cookie.PageView={};G.cookie.PageView.update=function(){var a;var q;q=function w(){return Math.floor(1+Math.random()*65536).toString(36).substring(1)};if(!window.__pageViewId__){a=(new Date).getTime().toString(36);window.__pageViewId__=a+
q()+q()+q()}return window.__pageViewId__};G.html.PostData=function(a,q,n,w){var f;var e;var l;var g;var k;var r;var c;var v;var t;var y;y=2;t=5E3;c=false;v=function(){if(y>0)setTimeout(function(){if(!c){y-=1;f()}},t)};e=navigator.userAgent.toLowerCase();l=e.indexOf("msie")!==-1;g=e.indexOf("msie 9")!==-1;k=e.indexOf("msie 7")!==-1||e.indexOf("msie 6")!==-1;r=("https:"===document.location.protocol?"https:":"http:")+a;n=n||"POST";f=function(){var B;try{B=null;try{B=new XMLHttpRequest}catch(p){}if(B&&
!l)B.open(n,r,true);else if(typeof XDomainRequest!=="undefined"){B=new XDomainRequest;B.open(n,r)}else B=null;try{B.withCredentials=false}catch(p){}if(B.setRequestHeader)if(w)B.setRequestHeader("Content-Type",w);else B.setRequestHeader("Content-Type","text/plain;charset\x3dUTF-8");B.onload=function(){c=true};B.onreadystatechange=function(){};B.ontimeout=function(){};B.onerror=function(){};B.onprogress=function(){};B.send(q)}catch(p){try{try{G.html.fileLoader.load(r)}catch(u){if(window.console&&window.console.log)window.console.log(p)}}catch(u){}}};
if(k){G.html.fileLoader.load(r);return}else f()};(function(){function a(){}function q(w,f){var e={};e.clientId=""+f.clientId;e.containerId=""+w.getContainerId();e.classpath=""+w.PACKAGE_NAME;e.opentagStats=true;if(w.sentPing)e.containerLoad=false;else{w.sentPing=(new Date).valueOf();e.containerLoad=true}e.isS3=false;e.pageViewId=G.cookie.PageView.update();e.tags=[];return e}var n="text/plain;charset\x3dUTF-8";A.Define.clazz("qubit.opentag.Ping",a);a.prototype.oldSend=function(w,f){var e=w.config;
var l="c\x3d"+e.clientId+"\x26"+"p\x3d"+w.getContainerId()+"\x26"+"l\x3d"+e.tellLoadTimesProbability+"\x26"+"pv\x3d"+G.cookie.PageView.update()+"\x26"+"d\x3d";var g=[];for(var k=0;k<f.length;k++){var r=f[k].tag;var c=f[k].loadTime;if(c===null||isNaN(c))continue;var v=a.getPingID(r);if(!r.oldPingSent&&v&&c!==null)if(v!==undefined){g.push('"'+v+'":'+c);r.oldPingSent=true}else;else if(r.oldPingSent);else if(c===null);}if(e.pingServerUrl&&g.length>0){l+=encodeURIComponent("{"+g.join(",")+"}");var t="//"+
e.pingServerUrl+"/tag2?"+l;G.html.PostData(t,null,"GET")}else{if(!g.length);if(!e.pingServerUrl);}};a.prototype.sendErrors=function(w,f){};a.prototype.oldSendDedupe=function(w,f){var e=w.config;var l="c\x3d"+e.clientId+"\x26"+"p\x3d"+w.getContainerId()+"\x26"+"l\x3d"+e.tellLoadTimesProbability+"\x26"+"pv\x3d"+G.cookie.PageView.update()+"\x26"+"dd\x3d";var g=[];for(var k=0;k<f.length;k++){var r=f[k];var c=a.getPingID(r);if(c===undefined);else if(!r.oldDedupePingSent){g.push(c);r.oldDedupePingSent=
true}}if(g.length>0&&e.pingServerUrl){l+=encodeURIComponent("["+g.join(",")+"]");G.html.PostData("//"+e.pingServerUrl+"/tag2?"+l,null,"GET")}else{if(!g.length);if(!e.pingServerUrl);}};a.getPingID=function(w){if(w.config.id)return w.config.id;var f=w.PACKAGE_NAME.lastIndexOf(".");if(f!==-1)return w.PACKAGE_NAME.substring(f+1);else return w.PACKAGE_NAME};a.prototype.send=function(w,f){var e=w.config.pingServerUrl;if(e&&e.indexOf("opentag-stats")!==-1)this.newSend(w,f);else this.oldSend(w,f)};a.prototype.newSend=
function(w,f){var e=w.config;var l=q(w,e);var g=l.tags;var k=e.pingServerUrl;for(var r=0;r<f.length;r++){var c=f[r].tag;var v=f[r].loadTime;if(v===null||isNaN(v))continue;var t={};var y=a.getPingID(c);if(!c.pingSent&&y&&v!==null)if(y!==undefined){t.tagId=y;t.loadTime=v;t.fired=true;g.push(t);c.pingSent=true}else;else if(c.pingSent);else if(v===null);}if(k&&(g.length>0||l.containerLoad)){var B=P.stringify(l);var p="//"+k;G.html.PostData(p,B,"POST",n)}else{if(!g.length);if(!k);}};a.prototype.sendDedupe=
function(w,f){var e=w.config.pingServerUrl;if(e&&e.indexOf("opentag-stats")!==-1)this.newSendDedupe(w,f);else this.oldSendDedupe(w,f)};a.prototype.newSendDedupe=function(w,f){var e=w.config;var l=q(w,e);var g=e.pingServerUrl;var k=l.tags;for(var r=0;r<f.length;r++){var c=f[r];var v=a.getPingID(c);var t={};if(v===undefined);else if(!c.dedupePingSent){t.tagId=""+v;t.fired=false;t.loadTime=0;k.push(t);c.dedupePingSent=true}}if(g&&(k.length>0||l.containerLoad)){var y=P.stringify(l);var B="//"+g;G.html.PostData(B,
y,"POST",n)}else{if(!k.length);if(!g);}}})();G.cookie.SimpleSessionCounter={};G.cookie.SimpleSessionCounter._cookieName="_qst_s";G.cookie.SimpleSessionCounter._sessionCookie="_qsst_s";G.cookie.SimpleSessionCounter.update=function(a){var q;var n;var w;var f=30;q=A.Cookie.get(G.cookie.SimpleSessionCounter._cookieName);n=A.Cookie.get(G.cookie.SimpleSessionCounter._sessionCookie);if(!q)q=1;else{q=parseInt(q,10);if(!n||parseInt(n,10)<(new Date).getTime()-f*60*1E3)q+=1}A.Cookie.set(G.cookie.SimpleSessionCounter._cookieName,
q,365,a);A.Cookie.set(G.cookie.SimpleSessionCounter._sessionCookie,(new Date).getTime().toString(),null,a);return q};var P={};(function(){function a(c){return c<10?"0"+c:c}function q(c){e.lastIndex=0;return e.test(c)?'"'+c.replace(e,function(v){var t=k[v];return typeof t==="string"?t:"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+c+'"'}function n(c){return isFinite(c.valueOf())?c.getUTCFullYear()+"-"+a(c.getUTCMonth()+1)+"-"+a(c.getUTCDate())+"T"+a(c.getUTCHours())+":"+a(c.getUTCMinutes())+
":"+a(c.getUTCSeconds())+"Z":null}function w(c,v){var t;var y;var B;var p;var u=l;var x;var d=v[c];if(d instanceof Date)d=n(d);else if(d instanceof String||d instanceof Number||d instanceof Boolean)d=d.valueOf();if(typeof r==="function")d=r.call(v,c,d);switch(typeof d){case "string":return q(d);case "number":return isFinite(d)?String(d):"null";case "boolean":case "null":return String(d);case "object":if(!d)return"null";l+=g;x=[];if(Object.prototype.toString.apply(d)==="[object Array]"){p=d.length;
for(t=0;t<p;t+=1)try{x[t]=w(t,d)||"null"}catch(b){x[t]='{"stack_exceeded": null}'}B=x.length===0?"[]":l?"[\n"+l+x.join(",\n"+l)+"\n"+u+"]":"["+x.join(",")+"]";l=u;return B}if(r&&typeof r==="object"){p=r.length;for(t=0;t<p;t+=1)if(typeof r[t]==="string"){y=r[t];try{B=w(y,d)}catch(b){B='{"stack_exceeded": null}'}if(B)x.push(q(y)+(l?": ":":")+B)}}else for(y in d)if(Object.prototype.hasOwnProperty.call(d,y)){try{B=w(y,d)}catch(b){B='{"stack_exceeded": null}'}if(B)x.push(q(y)+(l?": ":":")+B)}B=x.length===
0?"{}":l?"{\n"+l+x.join(",\n"+l)+"\n"+u+"}":"{"+x.join(",")+"}";l=u;return B}}var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var l;var g;var k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var r;if(typeof P.stringify!=="function")P.stringify=function(c,v,t){var y;l="";g="";
if(typeof t==="number")for(y=0;y<t;y+=1)g+=" ";else if(typeof t==="string")g=t;r=v;if(v&&typeof v!=="function"&&(typeof v!=="object"||typeof v.length!=="number"))throw new Error("JSON.stringify");return w("",{"":c})};if(typeof P.parse!=="function")P.parse=function(c,v){function t(B,p){var u;var x;var d=B[p];if(d&&typeof d==="object")for(u in d)if(Object.prototype.hasOwnProperty.call(d,u)){x=t(d,u);if(x!==undefined)d[u]=x;else delete d[u]}return v.call(B,p,d)}var y;c=String(c);f.lastIndex=0;if(f.test(c))c=
c.replace(f,function(B){return"\\u"+("0000"+B.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){y=eval("("+c+")");return typeof v==="function"?t({"":y},""):y}throw new SyntaxError("JSON.parse");}})();(function(){function a(k){if(k)if(k.alphabet){this.alphabet=k.alphabet;this.dict={};for(var r=0;r<this.alphabet.length;r++)this.dict[this.alphabet[r]]=
r}else{this.alphabet=n;this.dict=e}}function q(k,r){for(var c in r)if(k===r[c])return c;return null}var n=[];var w=Math.pow(2,8);for(var f=0;f<w;f++)n.push(String.fromCharCode(f));var e={};for(var l=0;l<n.length;l++)e[n[l]]=l;var g=A.Define;g.clazz("qubit.compression.LZW",a);a.prototype.encode=function(k){var r=this.alphabet.length;var c={};var v=[];var t=0;var y=k.charAt(t++);var B;for(var p=this.dict;!!(B=k.charAt(t++));){var u=y+B;if(p.hasOwnProperty(u)||c.hasOwnProperty(u))y=u;else{var x=p.hasOwnProperty(y)?
p[y]:c[y];if(x===undefined)throw"Dictionary base is to small for those contents: "+y;v.push(x);c[u]=r++;y=B}}if(y!=="")v.push(c.hasOwnProperty(y)?c[y]:p[y]);return v};a.prototype.decode=function(k){var r=this.dict;var c=this.alphabet.length;var v;var t={};var y=q(k[0],r);var B=y;var p=[y];for(var u=1;u<k.length;u++){var x=k[u];v=q(x,r);if(v===null){if(t.hasOwnProperty(x))v=t[x];if(v===null)v=B+y}p.push(v);y=v.charAt(0);t[c++]=B+y;B=v}return p.join("")}})();(function(){function a(p){var u=0;var x=
p<0;if(x)p=-p;var d="";var b=true;do{u=p%t;if(b){d=r[v[u]];b=false}else d=v[u]+d;p=(p-u)/t}while(p>0);if(x)return"-"+d;return d}function q(p){var u=0;var x=0;var d=true;for(var b=0;b<p.length;b++){var h=p.charAt(p.length-1-b);if(d){d=false;h=w.charAt(g[h])}u+=e[h]*Math.pow(t,x++)}return u}function n(p){}var w="abcdefghijklmnopqrstuvwxyz"+"0123456789"+"'%./:\x3c\x3e?[";var f="ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"*!-+()@{|}"+'"]^_`~$\x26#';var e={};for(var l=0;l<w.length;l++)e[w.charAt(l)]=l;var g={};for(var k=
0;k<w.length;k++)g[f.charAt(k)]=k;var r={};for(var c=0;c<w.length;c++)r[w.charAt(c)]=f.charAt(c);var v=w.split("");var t=v.length;var y=new A.compression.LZW({});var B=A.Define;B.clazz("qubit.compression.Compressor",n);n.prototype.compress=function(p,u){var x=(u||y).encode(p);var d=[];for(var b=0;b<x.length;b++)d.push(String.fromCharCode(x[b]));return d.join("")};n.prototype.compressAnsi=function(p,u){var x=(u||y).encode(p);var d=[];for(var b=0;b<x.length;b++){var h=a(x[b]);d.push(h)}return d.join("")};
n.prototype.decompressAnsi=function(p,u){var x=[];var d="";for(var b=0;b<p.length;b++){var h=p.charAt(b);if(g.hasOwnProperty(h)){var m=d+h;d="";m=q(m);x.push(m)}else d+=h}return(u||y).decode(x)};n.prototype.decompress=function(p,u){var x=[];for(var d=0;d<p.length;d++)x.push(p.charCodeAt(d));return(u||y).decode(x)}})();(function(){function a(x){var d=[];for(var b=0;b<x.length;b++){var h=e(x[b][0]);d.push([new RegExp(h,"g"),"*"+x[b][1]])}return d}function q(x,d){for(var b=0;b<d.length;b++)if(d[b][1]===
x)return d[b][0];return null}function n(x){this._regexDefs=v;this._defs=c;if(x)if(x.definitions){this._regexDefs=a(x.definitions);this._defs=x.definitions}}function w(x,d){var b=[];for(var h=0;h<x.length;h++){var m=true;if(d)m=x.charCodeAt(h)<=d;var z=r.cookieAlphabetMap.hasOwnProperty(x.charAt(h));if(m&&!z)b.push("*"+x.charCodeAt(h)+".");else b.push(x.charAt(h))}return b.join("")}function f(x,d){d=d.replace(/@/g,"@@");var b=[];var h=0;for(var m=0;h<x.length;h++){var z=x[h][0];var C=new RegExp(e(z),
"g");var D=d.replace(C,"@"+m+"-");if(D!==d){b.push(x[h][0]);m++;d=D}}return[d,b]}function e(x){return x.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function l(x){var d={};var b="";for(var h=0;h<x.length;h++){var m=x.charAt(h);if(!y[m]){if(isNaN(d[b]))d[b]=x.split(b).length-1;b=""}else b+=m}var z=[];for(var C in d)if(d.hasOwnProperty(C)){var D=d[C];if(D>=u&&C.length>=p)z.push([C,D])}z=z.sort(function(E,F){if(E[0].length===F[0].length)return 0;if(F[0].length>E[0].length)return 1;else return-1});return z}
function g(x,d){if(!d||d.length===0||!x)return x;var b="";var h=false;var m=false;var z="";for(var C=0;C<x.length;C++){var D=x.charAt(C);if(D==="@"||h||m)if(h||m){h=false;if(D==="@")b+="@";else if(!isNaN(+("-"+D))){m=true;z=z+D}else if(m){if(d&&D==="-"&&d[+z])b+=d[+z];else b+="@"+z+D;z="";m=false}else b+="@"+D}else h=true;else b+=D}if(z)b+="@"+z;if(h)b+="@";return b}var k=A.Define;var r=A.Cookie;var c=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',
"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww","10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],
["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["\x3c","S"],["\x3e","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'","i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]];var v=a(c);k.clazz("qubit.opentag.compression.Encoder",n);n.prototype.encode=function d(b,h){var m=b.replace(/\*/g,"**");var z=l(m);for(var C=0;C<this._regexDefs.length;C++){var D=this._regexDefs[C];m=m.replace(D[0],
D[1])}m=m.replace(/;/g,"*-");m=m.replace(/&/g,"*.");m=m.replace(/\\/g,"*/");m=m.replace(/=/g,"*+");m=m.replace(/\n/g,"*N");m=m.replace(/ /g,"*_");m=m.replace(/\t/g,"*T");m=m.replace(/"/g,"*Q");var E=l(m);E.concat(z);var F=f(E,m);var I=F[1];var J=I.length>0;if(J)m=F[0];if(!h)m=w(m);else m=w(m,h);if(J)return"Y"+I.join("*")+"@"+m;else return"N"+m};var t="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.";var y={};for(var B=0;B<t.length;B++)y[t.charAt(B)]=true;var p=4;var u=2;n.prototype.decode=
function(d){var b=null;if(d.charAt(0)==="N")d=d.substring(1);else if(d.charAt(0)==="Y"){var h=d.indexOf("@");if(h>=0){b=d.substring(1,h);b=b.split("*");d=d.substring(h+1);d=g(d,b)}}var m="";var z=false;var C=false;var D="";for(var E=0;E<d.length;E++){var F=d.charAt(E);if(F==="*"||z||C)if(z||C){z=false;if(!isNaN(+("-"+F))){D=D+F;C=true}else if(C){if(F===".")m+=String.fromCharCode(+D);else if(F==="-"&&q(D+"-",this._defs))m+=q(D+"-",this._defs);else m+="*"+D+F;D="";C=false}else if(F==="*")m+="*";else if(F===
"-")m+=";";else if(F==="/")m+="\\";else if(F===".")m+="\x26";else if(F==="+")m+="\x3d";else if(F==="N")m+="\n";else if(F==="_")m+=" ";else if(F==="T")m+="\t";else if(F==="Q")m+='"';else if(q(F,this._defs)!==null){var I=q(F,this._defs);m+=I}else m+="*"+F}else z=true;else m+=F}if(D)m+="*"+D;if(z)m+="*";return m}})();(function(){function a(f){this.testBinary=false;this.binSupported=w;if(f){this.compressor=new A.compression.Compressor;this.encoder=new A.opentag.compression.Encoder({})}}var q=A.Define;
var n=A.Cookie;var w=false;q.clazz("qubit.opentag.compression.CookieCompressor",a);a.prototype.compress=function(f,e){if(typeof f!=="string"||f==="")return f;var l=this.encoder.encode(f);var g;if(this.binSupported||this.testBinary){var k=this.compressor.compress(l);g='"B'+this.encoder.encode(k,128)+'"';n.set("__qtag_test_bin__",g,undefined,undefined,true);var r=n.get("__qtag_test_bin__",true);n.rm("__qtag_test_bin__");if(r&&r!==g)g=null}var c;var v=this.encoder.encode(this.compressor.compressAnsi(l));
if(!e&&l.length<=v.length)c="E"+l;else c="C"+v;if(g&&g.length<c.length)return g;else return c};a.prototype.decompress=function(f){if(typeof f!=="string"||f==="")return f;if(f.charAt(0)==='"')f=f.substring(1,f.length-1);var e=f.charAt(0);f=f.substring(1);switch(e){case "E":return this.encoder.decode(f);case "C":var l=this.compressor.decompressAnsi(this.encoder.decode(f));return this.encoder.decode(l);case "B":var g=this.compressor.decompress(this.encoder.decode(f));return this.encoder.decode(g);default:throw"This code is not supported! Code: "+
e;}}})();(function(){var a=A.Cookie;var q=A.opentag.Utils;var n=function(){};A.Define.clazz("qubit.opentag.Session",n);var w=new A.opentag.compression.CookieCompressor({});n.readCompressedCookie=function(f){var e=a.get(f,true);return w.decompress(e)};n.setupSession=function(f){var e=f.config;var l;var g;var k;var r;var c;var v;l={};l.sessionCount=G.cookie.SimpleSessionCounter.update(e.cookieDomain);c="qtag_"+f.getContainerId();var t="x_qtag_"+f.getContainerId();k=a.get(c);var y=!!k;if(k===null){k=
a.get(t,true);k=w.decompress(k)}if(k)try{k=P.parse(k)}catch(p){k={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else k={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};v=(new Date).getTime();if(l.sessionCount!==parseInt(k.sc,10)){k.sessionStartTime=v;k.sc=l.sessionCount;k.sessionCount+=1;k.referrer.push({url:n.getReferrer(),landing:q.getUrl().substring(0,300),time:v});k.sessionLandingPage=q.getUrl().substring(0,
300)}else if(n.isReferrerDifferent())if(!n.referrerIsSameAsPrevious(k.referrer,v,30*60*1E3)){k.referrer.push({url:n.getReferrer(),landing:q.getUrl().substring(0,300),time:v});k.sessionLandingPage=q.getUrl().substring(0,300);k.sessionStartTime=v;k.sessionCount+=1}l.sessionCount=k.sessionCount;l.sessionStartTime=k.sessionStartTime;l.pageStartTime=v;k.pageViews+=1;l.pageViews=k.pageViews;l.sessionLandingPage=k.sessionLandingPage;l.referrer=k.referrer;if(l.referrer.length>5)l.referrer.splice(2,l.referrer.length-
5);r=P.stringify(k);for(g=0;w.compress(r).length>e.maxCookieLength&&g<5;){if(k.referrer.length>=3)k.referrer.splice(2,1);else if(k.referrer.length===2)k.referrer=[k.referrer[0]];else if(k.referrer.length===1)k.referrer=[];r=P.stringify(k);g+=1}l.referrer=k.referrer;if(y)a.rm(c);var B=w.compress(r);a.rm(t);if(e.maxCookieLength>0)a.set(t,B,365,e.cookieDomain,true);l.setVariable=function(p,u,x){var d=!!x?x:0;k.__v[p]=[u,d];var b=w.compress(P.stringify(k));if(e.maxCookieLength>0)a.set(t,b,365,e.cookieDomain,
true);else a.rm(t)};l.getCookie=function(p,u){var x=a.get(p,true);if(x&&(u||p.indexOf("x_")===0))try{x=w.decompress(x)}catch(d){}else if(x!==null)x=a.decode(x);return x};l.getVariable=function(p){var u;var x;var d;u=k.__v[p];if(u){x=u[1];if(x===0||x>(new Date).getTime())return u[0]}return null};l.on=function(p,u,x){if(u.attachEvent)u.attachEvent("on"+p,x);else if(u.addEventListener)u.addEventListener(p,x,false)};l.getTagCookie=function(){return n.readCompressedCookie(t)};n.lastSession=l;return l};
n.referrerIsSameAsPrevious=function(f,e,l){var g;var k;var r;if(f.length>0){g=n.getReferrer();k=q.getUrl().substring(0,300);r=f[f.length-1];return r.url===g&&r.landing===k&&r.time+l>e}return false};n.isReferrerDifferent=function(){var f;var e;var l;l=n.getReferrer();f=l.indexOf("://");if(f===-1)return true;f+=3;try{if(l.substring(f).indexOf(n.getDomain())!==0)return true;return false}catch(g){return true}};n.getReferrer=function(){if(document.referrer)return document.referrer.substring(0,300);return"direct"};
n.getDomain=function(){return document.location.host}})();(function(){function a(f){n.setIfUnset(f,a.defaultConfig);if(this.singleton){var e=this.PACKAGE_NAME+"."+this.CLASS_NAME;var l=A.opentag.Utils.getObjectUsingPath(e,Q);if(l.__instance)return l.__instance;l.__instance=this}a.SUPER.call(this,f)}function q(f,e){var l=f.toString();l=l.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,"");l=l.substring(0,l.lastIndexOf("}"));l=l.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,
'$1"${$2}"');l=l.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2');l=l.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"');l=l.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2');l=l.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'(\s*)\)/g,"$1${$2}$3");l=l.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"(\s*)\)/g,"$1${$2}$3");l=e.replaceTokensWithValues(l);n.geval(l)}
var n=A.opentag.Utils;var w=A.Define;A.Define.clazz("qubit.opentag.LibraryTag",a,A.opentag.BaseTag);a.defaultConfig={vendor:null,imageUrl:null,description:"",async:false,isPrivate:false,upgradeable:true,html:"",parameters:[],prePostWindowScope:false};a.prototype.pre=function(){};a.prototype.post=function(){};a.prototype.before=function(){a.SUPER.prototype.before.call(this);try{var f=this.config;if(f&&f.pre)if(typeof f.pre==="function")this.pre=f.pre;else{var e=this.replaceTokensWithValues(String(f.pre));
this.pre=n.expressionToFunction(e).bind(this)}if(this.config.prePostWindowScope&&this.pre!==a.prototype.pre&&this.pre.toString)q(this.pre,this);else this.pre()}catch(l){return true}return false};a.prototype.after=function(f){a.SUPER.prototype.after.call(this,f);try{var e=this.config;if(e&&e.post)if(typeof e.post==="function")this.post=e.post;else{var l=this.replaceTokensWithValues(String(e.post));this.post=n.expressionToFunction(l).bind(this)}if(this.config.prePostWindowScope&&this.post!==a.prototype.post&&
this.post.toString)q(this.post,this);else this.post(f)}catch(g){}};a.define=function(f,e){f=f.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");f=A.Define.vendorsSpaceClasspath(f);var l={};if(e.getDefaultConfig)l=e.getDefaultConfig();var g=e.CONSTRUCTOR;var k={};for(var r in e)if(r!=="config")k[r]=e[r];var c=function(y){y=y||{};y=n.overrideFromLeftToRight(l,y);var B=A.opentag.LibraryTag.call(this,y);if(g)g.call(this,y);if(B)return B};var v=A.opentag.Utils.defineWrappedClass(f,a,k,O,
c);var t=w.STANDARD_VS_NS+".";if(f.indexOf(t)!==0)n.namespace(t+f,v);return v};a.getLibraryByClasspath=function(f){return n.getObjectUsingPath(f,A.Define.getVendorSpace())}})();(function(){function a(){}var q=A.opentag.LibraryTag;var n=A.Define;a.library=function(){return q.define.apply(q,arguments)};a.libraryRef=function(){return q.getLibraryByClasspath.apply(q.getLibraryByClasspath,arguments)};n.namespace("qubit.Quick",a)})();(function(){function a(p){this.runQueue=[];this.tags={};this.config={cookieDomain:"",
maxCookieLength:1E3,gzip:true,delayDocWrite:false,clientId:"",name:"",tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:false,containerId:"",scanTags:false,noPings:false};this.ignoreTagsState=false;if(p){this.setConfig(p);if(!p.name)this.config.name="Cont-"+c++;a.register(this);if(a.NO_PINGS)this.config.noPings=true;this.ping=new A.opentag.Ping(this.config);this._sendPingsTrigger=this.sendPings.bind(this);if(p.init)try{p.init.call(this,p)}catch(x){}var u=this;this._tagLoadedHandler=
function(x){if(u._containerAlreadySentPings){u.sendPingsNotTooOften();if(x.success);}}}return this}function q(p,u,x){if(p[x]){t[x]=t[x]||1;x+="("+t[x]+")";t[x]++}p[x]=u}var n=A.opentag.Utils;var w=A.opentag.filter.BaseFilter;var f=A.opentag.filter.Filter;var e=A.opentag.BaseTag;var l=A.opentag.Timed;var g=A.opentag.Tags;var k=A.opentag.Session;var r=A.Cookie;var c=1;try{window.opentag_consentGiven=function(){a.consentIsGiven=true;var p=a.getContainers();for(var u=0;u<p.length;u++)try{p[u].run()}catch(x){}}.bind(this)}catch(p){}A.Define.clazz("qubit.opentag.Container",
a);var v=[];a.register=function(p){n.addToArrayIfNotExist(v,p)};a.prototype.isTellingLoadTimes=function(){var p=this.config.tellLoadTimesProbability;if(p===null)p=0;return p>Math.random()};a.prototype.destroy=function(p){this.destroyed=true;this.unregister();if(p)for(var u in this.tags){var x=this.tags[u];if(x instanceof e){x.destroy();this.tags[u]=null;delete this.tags[u]}}var d=this.PACKAGE_NAME.split(".");d=d[d.length-1];var b=n.getParentObject(this.PACKAGE_NAME);b[d]=null;delete b[d]};a.findContainersByName=
function(p){var u=this.getContainers();var x=[];for(var d=0;d<u.length;d++)if(u[d].config.name===p)x.push(u[d]);return x};a.getById=function(p){var u=this.getContainers();for(var x=0;x<u.length;x++)if(u[x].getContainerId()===p)return u[x];return null};a.prototype.unregister=function(p){a.unregister(this,p)};a.unregister=function(p,u){n.addToArrayIfNotExist(v,p);var x=n.removeFromArray(v,p);if(u)for(var d in this.tags){var b=this.tags[d];if(b instanceof e){b.unregister();this.tags[d]=null;delete this.tags[d]}}if(!x||
x.length===0);};a.prototype.hasConsent=function(){return r.get("qubitconsent")==="Accepted"};a.prototype.register=function(p){a.register(p||this)};a.getContainers=function(){return v};a.prototype.getContainers=function(){return a.getContainers()};a.prototype.onTagRegistered=function(p){};a.prototype.registerTag=function(p){var u=p.config.name;if(this.tags[u]);else{this.tags[u]=p;p.onAfter(this._tagLoadedHandler);try{this.onTagRegistered(p)}catch(x){}}};a.prototype.registerTags=function(p){for(var u=
0;u<p.length;u++)this.registerTag(p[u])};a.prototype.setConfig=function(p){for(var u in p)this.config[u]=p[u]};a.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};a.prototype.runWithoutFilters=function(){this.runTags({command:"run"})};a.prototype.getTagByname=function(p){return this.tags[p]};a.prototype.containerScriptLoadedSynchronously=function(){var p;var u;var x;var d;var b;d=document.getElementsByTagName("script");for(p=0,u=d.length;p<u;p+=1){x=d[p];b=x.getAttribute("src");
if(!!b&&b.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js")>0)return x.getAttribute("async")===null&&(x.getAttribute("defer")===false||x.getAttribute("defer")===""||x.getAttribute("defer")===null)}return true};a.prototype.prepareSessionIfNeeded=function(){var p=this.config.trackSession;if(p!==true&&p!==false){var u=this.tags;for(var x in u)if(u.hasOwnProperty(x)){var d=u[x];d.resolveAllDynamicData();var b=d.getFilters();for(var h=0;h<b.length;h++){var m=b[h];if(m instanceof f&&m.isSession()){this.trackSession=
true;break}}if(this.trackSession)break}}else this.trackSession=p;if(a.TRACK_SESSION)this.trackSession=true;if(this.trackSession)this.session=k.setupSession(this);if(this.session);};a.prototype.runTags=function(p,u){if(this.destroyed)throw"Container has been destroyed.";if(!u)if(a.LOCKED||n.global().QUBIT_CONTAINERS_LOCKED)return;if(this.onBeforeRun)try{this.onBeforeRun()}catch(J){}var x=!this.containerScriptLoadedSynchronously();var d="runIfFiltersPass";if(p&&p.command)d=p.command;this.runningStarted=
(new Date).valueOf();var b={};if(this.config.scanTags)if(!this._scanned){this.scanForTags();this._scanned=(new Date).valueOf()}this.prepareSessionIfNeeded();var h=this.getTagsInOrder();for(var m=0;m<h.length;m++)try{var z=h[m];var C=z.config.name;if(this.includedToRun(z)){var D=z.resolveDependencies();if(D.length>0)for(var E=0;E<D.length;E++){var F=D[E];var I=F.config.name;if(!b[I]&&this.tags[I]){b[I]=F;this._tagRunner(F,d,x)}}if(!b[C]){b[C]=z;this._tagRunner(z,d,x)}}}catch(J){}l.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),
3100);this.waitForAllTagsToFinish()};a.prototype.getTagsInOrder=function(){var p=[];for(var u in this.tags){var x=this.tags[u];var d=x.config.priority;if(+d>0){var b=0;for(var h=0;h<p.length;h++){var m=p[h];if(m){var z=+m.config.priority;if(z>0&&z>d)b++;else break}}p.splice(b,0,x)}else p.push(x)}return p};a.prototype._tagRunner=function(p,u,x){try{if(this.includedToRun(p)){if(x)p.forceAsynchronous=true;if(this.config.delayDocWrite)p.delayDocWrite=true;p.session=p.session||this.session;p[u]()}}catch(d){}};
a.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;else{if(this._pkgName)return this._pkgName;var p=this.PACKAGE_NAME.split(".");p=p[p.length-1];this._pkgName=p;return p}};a.prototype.includedToRun=function(p){if(!p)return false;var u=p.config;if(u.inactive)return false;if(u.disabled)if(!p.cookieSaysToRunEvenIfDisabled())return false;if(p.disabledByCookie())return false;var x=a.consentIsGiven||!u.needsConsent||this.hasConsent();var d=p.state===e.prototype.STATE.INITIAL;
return this.ignoreTagsState||x&&d};a.prototype.scanForTags=function(p,u){if(p)this.tags={};var x;if(u&&typeof u==="object")x=this.findAllTags(u);else x=this.findAllTagsByClassPath();this.registerTags(x);return x};a.prototype.findAllTags=function(p,u){p=p||this.tagsPackageName||this.PACKAGE_NAME;return g.findAllTags(p,u)};a.prototype.findAllTagsByClassPath=function(p){p=p||this.PACKAGE_NAME;return g.findAllTagsByClassPath(p)};a.prototype.findAllFilters=function(p,u){p=p||this.tagsPackageName||this.PACKAGE_NAME;
return g.findAllFilters(p,u)};a.prototype.waitForAllTagsToFinish=function(){if(this._waitForAllTagsToFinishWaiting)return;if(!this._lastWaited)this._lastWaited=(new Date).valueOf();var p=(new Date).valueOf()-this._lastWaited>15*1E3;var u=this.allTagsFinished()||p;if(!this._showFinishedOnce&&u){this._lastWaited=null;if(p);this._showFinishedOnce=true;this.runningFinished=(new Date).valueOf();this._containerAlreadySentPings=(new Date).valueOf();this.sendPingsNotTooOften();if(this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else if(!u){this._waitForAllTagsToFinishWaiting=
true;this._showFinishedOnce=false;l.setTimeout(function(){this._waitForAllTagsToFinishWaiting=false;this.waitForAllTagsToFinish()}.bind(this),100)}else;};a.prototype.onTagsInitiallyRun=M;a.prototype.resetAllTags=function(p){for(var u in this.tags)if(this.tags.hasOwnProperty(u)){var x=this.tags[u];x.reset();if(!p)x.resetFilters()}};a.prototype.reset=function(p){this.runningFinished=undefined;this._waitForAllTagsToFinishWaiting=undefined;this.runningStarted=undefined;this._showFinishedOnce=undefined;
this.resetAllTags(p)};a.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};l.runIfNotScheduled(this._sendPingsTrigger,2E3,this._sndLck)};a.prototype.sendPings=function(){if(this.config.noPings)return;var p;if(this.isTellingLoadTimes()){var u=this.getAllTagsByState();var x=this;var d=[];if(u.run)d=g.getLoadTimes(u.run);this.lastPingsSentTime=(new Date).valueOf();this.ping.send(this,d);d=g.getLoadTimes();var b=[];for(p=0;p<d.length;p++){var h=d[p].tag;if(h.config.dedupe&&h.sendDedupePing)b.push(h)}if(b.length>
0){this.lastDedupePingsSentTime=(new Date).valueOf();this.ping.sendDedupe(this,b)}if(u.other){d=g.getLoadTimes(u.other);var m=[];for(p=0;p<d.length;p++)m.push(d[p]);if(m.length>0)this.ping.send(this,m)}if(u.awaiting){d=g.getLoadTimes(u.awaiting);var z=[];for(p=0;p<d.length;p++)z.push(d[p]);if(z.length>0)this.ping.send(this,z)}}};a.prototype.getAllTagsByState=function(){return a.getAllTagsByState(this.tags)};a.getAllTagsByState=function(p){var u=null;var x=null;var d=null;var b=null;var h=null;var m=
null;var z=e.prototype.STATE.EXECUTED_WITH_ERRORS;for(var C in p){var D=p[C];if(D instanceof e){var E=D.config.name;if(D.scriptExecuted>0){u=u||{};q(u,D,E)}else if(D.locked){m=m||{};q(m,D,E)}else if(D.scriptExecuted<0||D.state>=z){b=b||{};q(b,D,E)}else if(D.filtersState()===w.state.SESSION||D.filtersState()>0){d=d||{};q(d,D,E)}else if(D.config.needsConsent){h=h||{};q(h,D,E)}else{x=x||{};q(x,D,E)}}}return{run:u,failed:b,awaiting:d,consent:h,locked:m,other:x}};var t={};a.prototype.allTagsFinished=function(){for(var p in this.tags)if(this.tags.hasOwnProperty(p)){var u=
this.tags[p];if(u instanceof A.opentag.BaseTag){var x=u.filtersState();if(!u.config.disabled){var d=u.filtersState()<0&&!u.locked;var b=!(u.finished()||u.config.runner&&!u.isRunning);if(d&&b){var h=x!==w.state.SESSION;var m=+u.awaitingDependencies>0;if(h&&!m)return false}}}}return true};a.prototype.getPageVariables=function(){var p=[];for(var u in this.tags)if(this.tags.hasOwnProperty(u)){var x=this.tags[u].getPageVariables();for(var d=0;d<x.length;d++)n.addToArrayIfNotExist(p,x[d])}return p};a.getPageVariableByName=
function(p){var u=this.getAllPageVariables();var x=[];for(var d=0;d<u.length;d++)if(u[d].config.name===p)x.push(u[d]);return x};var y="qubit.opentag.disableContainerRunning_";var B="qubit.opentag.forceContainerRunning";a.prototype._getCookieNameForDisabling=function(){return y+this.getContainerId()+this.config.name};a.prototype.disabledByCookie=function(){return!!r.get(this._getCookieNameForDisabling())};a.prototype.setCookieToDisable=function(){r.set(this._getCookieNameForDisabling(),"true")};a.prototype.rmCookieToDisable=
function(){r.rm(this._getCookieNameForDisabling())};a.rmAllDisablingCookies=function(){n.rmCookiesMatching(y)};a.setCookieForDisabledContainersToRun=function(){r.set(B,"true")};a.rmCookieForDisabledContainersToRun=function(){r.rm(B)}})();(function(){function a(n){var w={url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:true};q.setIfUnset(n,w);a.SUPER.call(this,n)}var q=A.opentag.Utils;A.Define.clazz("qubit.opentag.CustomTag",a,A.opentag.LibraryTag)})();(function(){function a(g){return g.replace(/^\s+/,
"").replace(/\s+$/,"")}var q={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null};var n;var w="universal_variable";var f=0;var e=500;var l;q._isArray=function(g){return Object.prototype.toString.call(g)==="[object Array]"};q._targetChanged=function(g,k,r){var c;var v;var t;if(r===null)if(k==="null")return false;else return true;else if(r===undefined)if(k===r)return false;else return true;else{c=P.parse(k);v=q._getNested(c,g);t=q._getNested(r,g);return!q._jsonIsEqual(v,t)}};q._processCallbacks=
function(){var g;if(q.early_callbacks&&q.early_callbacks.length>0){for(g=0;g<q.early_callbacks.length;g+=1)q.push(q.early_callbacks[g]);q.early_callbacks=null}};q._keyStringToArr=function(g){g=a(g);if(g==="")return[];else{g=g.replace(/\[(\w+)\]/g,".$1");g=g.replace(/^\./,"");return g.split(".")}};q._getNested=function(g,k){var r=q._keyStringToArr(k);for(var c;r.length>0;){c=r.shift();if(g.hasOwnProperty(c))g=g[c];else return}return g};q._jsonIsEqual=function(g,k){if(typeof g!=="string")g=P.stringify(g,
q._stripEvents);if(typeof k!=="string")k=P.stringify(k,q._stripEvents);return g===k};q._stripEvents=function(g,k){if(g!=="events")return k;else return undefined};q._on=function(g,k){var r;var c;r=g.split(":");g=r[0];c=r[1];q.callbacks[g]=q.callbacks[g]||[];if(c)q.callbacks[g].push({keyString:c,func:k});else q.callbacks[g].push({func:k})};q._trigger=function(g,k){var r;var c;if(q.callbacks[g])for(r=0;r<q.callbacks[g].length;r+=1)if(typeof q.callbacks[g][r].func==="function"){c=q.callbacks[g][r].keyString;
if(c){if(g==="change"&&q._targetChanged(c,q.currentUV,n))q.callbacks[g][r].func(k)}else q.callbacks[g][r].func(k)}};q._eventsPush=function(g){var k;var r;n.events[n.events.length]=g;g.time=g.time||(new Date).getTime();if(q.callbacks.event){k=0;r=q.callbacks.event.length;for(k;k<r;k+=1)q.callbacks.event[k].func(g)}g.has_fired=true};q._getUnfiredEvents=function(){var g=0;for(g=0;g<n.events.length;g+=1)if(!n.events[g].has_fired){q.unfired_events.push(n.events.splice(g,1)[0]);g-=1}};q._fireEvents=function(){for(;q.unfired_events.length>
0;)n.events.push(q.unfired_events.shift())};q._resetEventsPush=function(){n.events=n.events||[];if(n.events.push.toString().indexOf("[native code]")!==-1){n.events.push=q._eventsPush;q._getUnfiredEvents();q._fireEvents()}};q._checkForChanges=function(){if(q.callbacks.change&&q.callbacks.change.length>0)if(!q._jsonIsEqual(q.currentUV,n)){q._trigger("change",n);q.currentUV=P.stringify(n,q._stripEvents)}};q._setUVLocation=function(g){w=g;q._initUV()};q._initUV=function(){window[w]=window[w]||{events:[]};
n=window[w];if(!n.events)n.events=[]};q.push=function(g){if(!q._isArray(g))return;if(g[0]==="on")q._on(g[1],g[2]);else if(g[0]==="trigger"&&g[1])q._trigger(g[1])};q.init=function(g,k){if(k)w=k;q._initUV();if(!window.uv_listener||q._isArray(window.uv_listener)){q.early_callbacks=window.uv_listener||null;window.uv_listener=q;if(!g)q.start()}else if(k)window.uv_listener._setUVLocation(w)};q.start=function(){q.currentUV=P.stringify(n,q._stripEvents);l=setInterval(function(){q._initUV();q._resetEventsPush();
q._checkForChanges()},e);q._processCallbacks()};G.html.UVListener=q})();(function(){function a(){}function q(){var k=false;if(l.get("opentag_debug")||document.location.href.indexOf("opentag_debug")>=0)k=true;return k}function n(){var k=false;if(l.get("opentag_debug_tool")||document.location.href.indexOf("opentag_debug_tool")>=0)k=true;return k}function w(){try{var k=O.TAGSDK_MAIN_DISABLED_FUNCTION;if(k&&k())return true}catch(r){}if(document.location.href.indexOf("opentag_disabled\x3dtrue")>=0)return true;
return false}function f(k,r,c){if(c&&(k[r]===undefined||k[r]===""||k[r]===null))k[r]=c}function e(k){var r=A.opentag.Utils.getParentObject(k.PACKAGE_NAME);var c=r.ClientConfig;if(c&&c.clientId)return c.clientId;else{var v=k.PACKAGE_NAME.split(".");return v[v.length-2].substring(1)}}var l=A.Cookie;var g=A.opentag.Utils;A.opentag.Log.setLevelFromCookie();a.run=function(){var k=false;if(w())return;var r=false;var c=n();var v=c||q();if(!r&&v){if(!A.DEBUG_MODE)O.TAGSDK_NS_OVERRIDE=true;else O.TAGSDK_NS_OVERRIDE=
false;k=true}if(A.DEBUG_MODE)O.TAGSDK_NS_OVERRIDE=false;try{G.html.UVListener.init()}catch(t){}a.runAllContainers(k)};a.runAllContainers=function(k){try{var r=A.opentag.Container.getContainers();for(var c=0;c<r.length;c++){var v=r[c];var t=v.config;if(!v.runningStarted&&!v.configuredInMain){t.scanTags=true;var y=g.getParentObject(v.PACKAGE_NAME).ClientConfig;if(y)f(v.config,"clientId",y.id);var B=g.getParentObject(v.PACKAGE_NAME).SystemDefaults;if(B){f(t,"pingServerUrl",B.pingServerUrl);f(t,"tellLoadTimesProbability",
B.tellLoadTimesProbability)}v.configuredInMain=true;if(k){v.destroy(true);a.loadDebugVersion(v)}else if(!O.QUBIT_OPENTAG_STOP_MAIN_EXECUTION)v.run();else(function(){var p=A.opentag.RUN_STOPPED_EXECUTON;A.opentag.RUN_STOPPED_EXECUTON=function(){try{if(p)p()}finally{v.run()}}})(v)}}}catch(p){}};a.loadDebugVersion=function(k){var r=document.createElement("script");var c;var v=k.config.scriptURL;var t=e(k);var y=k.getContainerId();if(v){c=v;var B="-debug.js".length;if(c.lastIndexOf("-debug.js")!==c.length-
B){c=c.substring(0,c.length-".js".length);c+="-debug.js"}}var p="//d3c3cq33003psk.cloudfront.net/opentag-"+t+"-"+y+"-debug.js";if(c&&p!==c)r.src=c;else r.src="//s3-eu-west-1.amazonaws.com/opentag/opentag-"+t+"-"+y+"-debug.js";document.getElementsByTagName("head")[0].appendChild(r)};A.Define.namespace("qubit.opentag.Main",a)})();var ga=false;try{if(typeof module==="object"&&module.exports){module.exports=L;ga=true}}catch(a){}if(!ga&&window)window.uv=L();var Y={};var X=[];var da=false;var Z=false;var ia=
A.Define.global();var ha={allEventsByType:Y,subscribe:function(a,q){if(Z){var n=H();n.on(a,q)}else X.push({on:[a,q]})},getEventHistory:function(a){return this.allEventsByType[a]},publish:function(a,q){if(Z){var n=H();n.emit(a,q)}else X.push({emit:[a,q]})},connect:function(){N()}};ha.connect();A.Define.namespace("qubit.qprotocol.PubSub",ha);(function(){function a(f){a.SUPER.apply(this,arguments)}var q=A.qprotocol.PubSub;var n=A.opentag.Utils;var w=":";A.Define.clazz("qubit.opentag.pagevariable.QProtocolVariable",
a,A.opentag.pagevariable.BaseVariable);a.prototype.init=function(){if(this.initialized)return false;else this.initialized=(new Date).valueOf();this.callHandlersOnRead=true;if(!this.handlerAttached){var f=this;var e=this.getValueAndPath(this.value);this.eventName=e[0];this.objectPath=e[1];this.updateValue();q.subscribe(this.eventName,function(l){f.updateValue(l)});this.handlerAttached=(new Date).valueOf()}};a.prototype.getValueAndPath=function(f){var e=f;var l;if(e){var g=f.indexOf(w);if(g!==-1){e=
f.substring(0,g);l=f.substring(g+1)}}return[e,l]};a.prototype.getValue=function(){this.init();return this.currentValue};a.prototype.getEventsHistory=function(){return q.getEventHistory(this.eventName)};a.prototype.updateValue=function(f){if(!f){var e=this.getEventsHistory();if(e)f=e.current}var l;var g=this.objectPath;if(f&&g)l=n.getObjectUsingPath(g,f);else l=f;this._updateCurrentValue(l);return l};a.prototype.startObservingForChanges=function(){};a.prototype.stopObservingForChanges=function(){}})();
(function(){function a(q){a.SUPER.apply(this,arguments)}A.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",a,A.opentag.pagevariable.Expression)})()})()})();(function(){})();(function(){var L=qubit.opentag.Container;var H=new L({"maxCookieLength":1E3,"cookieDomain":"","pingServerUrl":"","delayDocWrite":false,"name":"gucci_it","gzip":true,"disabled":false,"tellLoadTimesProbability":1,"containerId":2176395});var N="gucci_it.Container";qubit.Define.clientNamespace(N,H)})();
(function(){var L=qubit.opentag.filter.Filter;var H=new L({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var N="gucci_it.filters.DefaultFilterMatchAll";qubit.Define.clientNamespace(N,H);H.customStarter=null;H.customScript=null;H.lexicalPattern=""})();
(function(){var L=qubit.opentag.CustomTag;var H=new L({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"dtxtngytz5im1.cloudfront.net/qtracker-5.0.0.min.js","timeout":-1,"async":true,"usesDocumentWrite":false,"prePostWindowScope":true,"name":"QuBit QTracker","disabled":false,"id":56995730,"locked":false,"locationObject":"HEAD"});var N="gucci_it.tags.qubitqtracker.Tag";qubit.Define.clientNamespace(N,H);H.htmlContent="";H.addClientFiltersList([]);H.addClientVariablesMap({});
H.addParameters([]);H.genericDependencies=[];H.addClientDependenciesList([]);H.pre=function(){window._qtd=window._qtd||[];window._qtd.push({options:{domain:".gucci.com",serverUrl:"pong.qubitproducts.com/t2",clientId:"gucci_italy"}})};H.script=function(){};H.post=function(){}})();
(function(){var L=qubit.opentag.CustomTag;var H=new L({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"dd6zx4ibq538k.cloudfront.net/smartserve-4344.js","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Qubit Deliver","disabled":false,"id":56995749,"locked":false,"locationObject":"HEAD"});var N="gucci_it.tags.qubitdeliver.Tag";qubit.Define.clientNamespace(N,H);H.htmlContent="";H.addClientFiltersList(["gucci_it.filters.DefaultFilterMatchAll"]);H.addClientVariablesMap({});
H.addParameters([]);H.genericDependencies=[];H.addClientDependenciesList([]);H.pre=function(){};H.script=function(){};H.post=function(){}})();(function(){try{qubit.opentag.Main.run()}catch(L){try{console.error("Errors during opentag main runtime.",L)}catch(H){}}})();
